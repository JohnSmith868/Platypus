(function(){var a={};PBS=this.PBS||{};PBS.KIDS=this.PBS.KIDS||{};PBS.KIDS.platformer=a;a.settings={global:{initialScene:"menu",fps:60,rootElement:"root",aspectRatio:1.333,resizeFont:true},aspects:[{ogg:["firefox","opera","chrome"],m4a:[],m4aCombined:["android","silk","ipod","ipad","iphone"],mp3:["msie","safari"]}],assets:{powerup:{id:"powerup",src:{ogg:"a/powerup.ogg",mp3:"a/powerup.mp3",m4a:"a/powerup.m4a",m4aCombined:{assetId:"combined",src:"a/combined.m4a",data:{offset:5000,length:370}}}},walk:{id:"walk",src:{ogg:"a/walk.ogg",mp3:"a/walk.mp3",m4a:"a/walk.m4a",m4aCombined:{assetId:"combined",src:"a/combined.m4a",data:{offset:3200,length:330}}}},jump:{id:"jump",src:{ogg:"a/jump.ogg",mp3:"a/jump.mp3",m4a:"a/jump.m4a",m4aCombined:{assetId:"combined",src:"a/combined.m4a",data:{offset:1500,length:250}}}},buttons:{id:"buttons",src:"i/buttons.png"},"mookie-walk":{id:"mookie-walk",src:"i/mookie.png"},tilemap:{id:"tilemap",src:"i/tile-map.png"},sprites:{id:"sprites",src:"i/game-sprites.png"},test:{id:"test",src:"i/test.png"},"test-animation":{id:"test-animation",src:"i/test-animation.png"},tiles:{id:"tiles",src:"i/tiles.png"},"title-screen":{id:"title-screen",src:"i/title-screen.png"},objects:{id:"objects",src:"i/objects.png"}},classes:{Game:{id:"Game",src:"../src/js/game.js"},Entity:{id:"Entity",src:"../src/js/entity.js"},Layer:{id:"Layer",src:"../src/js/layer.js"},Scene:{id:"Scene",src:"../src/js/scene.js"},"Collision-Shape":{id:"Collision-Shape",src:"../src/js/collision-shape.js"},AABB:{id:"AABB",src:"../src/js/aabb.js"}},components:{"enable-ios-audio":{id:"enable-ios-audio",src:"../src/js/layer/enable-ios-audio.js"},"layer-controller":{id:"layer-controller",src:"../src/js/layer/layer-controller.js"},"tiled-loader":{id:"tiled-loader",src:"../src/js/layer/tiled-loader.js"},"render-createjs":{id:"render-createjs",src:"../src/js/layer/render-createjs.js"},"render-dom":{id:"render-dom",src:"../src/js/layer/render-dom.js"},"lc-logic":{id:"lc-logic",src:"../src/js/layer/lc-logic.js"},"lc-camera":{id:"lc-camera",src:"../src/js/layer/lc-camera.js"},"lc-basic-collision":{id:"lc-basic-collision",src:"../src/js/layer/lc-basic-collision.js"},audio:{id:"audio",src:"../src/js/entity/audio.js"},"broadcast-events":{id:"broadcast-events",src:"../src/js/entity/broadcast-events.js"},"change-scene":{id:"change-scene",src:"../src/js/entity/change-scene.js"},"dom-element":{id:"dom-element",src:"../src/js/entity/dom-element.js"},"entity-container":{id:"entity-container",src:"../src/js/entity/entity-container.js"},"entity-controller":{id:"entity-controller",src:"../src/js/entity/entity-controller.js"},"render-debug":{id:"render-debug",src:"../src/js/entity/render-debug.js"},"render-tiles":{id:"render-tiles",src:"../src/js/entity/render-tiles.js"},"render-animation":{id:"render-animation",src:"../src/js/entity/render-animation.js"},"render-image":{id:"render-image",src:"../src/js/entity/render-image.js"},"logic-button":{id:"logic-button",src:"../src/js/entity/logic-button.js"},"logic-directional-movement":{id:"logic-directional-movement",src:"../src/js/entity/logic-directional-movement.js"},"logic-gravity":{id:"logic-gravity",src:"../src/js/entity/logic-gravity.js"},"logic-hero":{id:"logic-hero",src:"../src/js/entity/logic-hero.js"},"collision-hero":{id:"collision-hero",src:"../src/js/entity/collision-hero.js"},"collision-tiles":{id:"collision-tiles",src:"../src/js/entity/collision-tiles.js"}},entities:{"tile-layer":{id:"tile-layer",components:[{type:"render-tiles",spritesheet:"import",imageMap:"import"},{type:"collision-tiles",collisionMap:"import"}]},"render-layer":{id:"render-layer",components:[{type:"render-tiles",spritesheet:"import",imageMap:"import"}]},"collision-layer":{id:"collision-layer",components:[{type:"collision-tiles",collisionMap:"import"}]},"button-jump":{id:"button-jump",components:[{type:"logic-button"},{type:"broadcast-events",events:{mousedown:"button-jump:down",mouseup:"button-jump:up"}},{type:"render-animation",spriteSheet:{images:["buttons"],frames:{width:138,height:138},animations:{released:1,pressed:7}},scaleX:2.9,scaleY:2.9,state:"released",acceptInput:{click:true,touch:true}}],properties:{x:10,y:1090,width:400,height:400}},"button-jump-left":{id:"button-jump-left",components:[{type:"logic-button"},{type:"broadcast-events",events:{mousedown:["button-jump:down","button-left:down"],mouseup:["button-jump:up","button-left:up"]}},{type:"render-animation",spriteSheet:{images:["buttons"],frames:{width:138,height:138},animations:{released:4,pressed:10}},scaleX:2.9,scaleY:2.9,state:"released",acceptInput:{click:true,touch:true}}],properties:{x:10,y:1090,width:400,height:400}},"button-jump-right":{id:"button-jump-right",components:[{type:"logic-button"},{type:"broadcast-events",events:{mousedown:["button-jump:down","button-right:down"],mouseup:["button-jump:up","button-right:up"]}},{type:"render-animation",spriteSheet:{images:["buttons"],frames:{width:138,height:138},animations:{released:5,pressed:11}},scaleX:2.9,scaleY:2.9,state:"released",acceptInput:{click:true,touch:true}}],properties:{x:610,y:1090,width:400,height:400}},"button-left":{id:"button-left",components:[{type:"logic-button"},{type:"broadcast-events",events:{mousedown:"button-left:down",mouseup:"button-left:up"}},{type:"render-animation",spriteSheet:{images:["buttons"],frames:{width:138,height:138},animations:{released:0,pressed:6}},scaleX:2.9,scaleY:2.9,state:"released",acceptInput:{click:true,touch:true}}],properties:{x:1180,y:1090,width:400,height:400}},"button-play-game":{id:"button-play-game",components:[{type:"dom-element",element:"div",innerHTML:"Play Game",className:"menu-button",onmouseup:"new-scene",ontouchend:"new-scene"},{type:"change-scene",scene:"scene-1",transition:"fade-to-black"}]},"button-right":{id:"button-right",components:[{type:"logic-button"},{type:"broadcast-events",events:{mousedown:"button-right:down",mouseup:"button-right:up"}},{type:"render-animation",spriteSheet:{images:["buttons"],frames:{width:138,height:138},animations:{released:2,pressed:8}},scaleX:2.9,scaleY:2.9,state:"released",acceptInput:{click:true,touch:true}}],properties:{x:1590,y:1090,width:400,height:400}},"button-mute":{id:"button-mute",components:[{type:"logic-button",toggle:true,state:"pressed"},{type:"render-animation",spriteSheet:{images:["buttons"],frames:{width:138,height:138},animations:{released:3,pressed:9}},scaleX:2.9,scaleY:2.9,state:"pressed",acceptInput:{click:true,touch:true}},{type:"broadcast-events",renameEvents:{mouseup:"audio-mute-toggle"}},{type:"audio"}],properties:{x:10,y:10,width:400,height:400}},hero:{id:"hero",components:[{type:"entity-controller",controlMap:{"button-jump":"key-jump","key:z":"key-jump","key:left-arrow":"key-left","button-left":"key-left","key:right-arrow":"key-right","button-right":"key-right","key:up-arrow":"key-up","key:down-arrow":"key-down"}},{type:"logic-hero"},{type:"collision-hero",shape:{offset:[0,-120],type:"rectangle",points:[[-80,-120],[80,120]]},collisionType:"hero",collidesWith:["solid"]},{type:"render-animation",spriteSheet:{images:["mookie-walk"],frames:{width:130,height:135,regY:130,regX:65},animations:{"standing-right":[2],"standing-left":[5],"walking-right":{frames:[3,0,1,2],frequency:4},"walking-left":{frames:[4,7,6,5],frequency:4},"jumping-right":[0],"jumping-left":[6]}},scaleX:2,scaleY:2},{type:"audio",audioMap:{walking:{sound:"walk",interrupt:"none"},jumping:"jump"}},{type:"render-debug",regY:240,regX:130}],properties:{x:10,y:10,width:160,height:240,state:"ground",heading:"right",camera:"bounding"}},block:{id:"block",components:[{type:"collision-hero",shape:{offset:[0,-120],type:"rectangle",points:[[-120,-120],[120,120]]},collisionType:"solid",collidesWith:["solid"]},{type:"render-image",image:"sprites",source:{width:120,height:120,y:720,x:240},regX:60,regY:120,scaleX:2,scaleY:2}],properties:{x:50,y:50,width:240,height:240}},dirt:{id:"dirt",components:[{type:"collision-hero",shape:{offset:[0,-120],type:"rectangle",points:[[-120,-120],[120,120]]},collisionType:"solid"},{type:"render-animation",spriteSheet:{images:["objects"],frames:{width:24,height:24,regX:12,regY:24},animations:{tile:2}},state:"tile"}],properties:{x:50,y:50,width:240,height:240}},"title-screen":{id:"title-screen",components:[{type:"dom-element",element:"img",className:"title-screen",src:"i/title-screen.png"}]}},includes:{EaselJS:{id:"EaselJS",src:"http://code.createjs.com/easeljs-0.5.0.min.js"},TweenJS:{id:"TweenJS",src:"http://code.createjs.com/tweenjs-0.3.0.min.js"},SoundJS:{id:"SoundJS",src:"http://code.createjs.com/soundjs-0.3.0.min.js"},PreloadJS:{id:"PreloadJS",src:"http://code.createjs.com/preloadjs-0.2.0.min.js"},Browser:{id:"Browser",src:"../src/js/browser.js"},iOSAudio:{id:"iOSAudio",src:"../src/js/HTMLiOSAudioPlugin.js"},SoundJSm4a:{id:"SoundJSm4a",src:"../src/js/SoundJSm4aOverride.js"},Main:{id:"Main",src:"../src/js/main.js"},ButtonCSS:{id:"ButtonCSS",src:"../src/css/button.css"},MainCSS:{id:"MainCSS",src:"../src/css/main.css"},GameCSS:{id:"GameCSS",src:"../src/css/game.css"}},scenes:{menu:{layers:[{id:"menu",components:[{type:"lc-logic"},{type:"render-dom"},{type:"layer-controller"},{type:"entity-container",entities:[{type:"title-screen"},{type:"button-play-game"}]}]},{id:"enable-ios-audio",filter:{includes:["iOS"]},components:[{type:"enable-ios-audio",audioId:"combined"}]}],id:"menu"},"scene-1":{layers:[{id:"action",components:[{type:"lc-logic"},{type:"lc-basic-collision"},{type:"lc-camera",width:3200},{type:"render-createjs"},{type:"layer-controller"},{type:"entity-container"},{type:"tiled-loader",level:"level-1",unitsPerPixel:10,images:["sprites"],imagesScale:2}]},{id:"multitouch-interface",filter:{includes:["multitouch"]},components:[{type:"lc-camera",width:2000},{type:"lc-logic"},{type:"render-createjs"},{type:"entity-container",entities:[{type:"button-jump"},{type:"button-left"},{type:"button-right"},{type:"button-mute"}]}]},{id:"touch-interface",filter:{includes:["touch"],excludes:["multitouch"]},components:[{type:"lc-camera",width:2000},{type:"lc-logic"},{type:"render-createjs"},{type:"entity-container",entities:[{type:"button-jump-left"},{type:"button-jump-right"},{type:"button-jump",properties:{x:310}},{type:"button-left"},{type:"button-right"},{type:"button-mute"}]}]},{id:"desktop-interface",filter:{excludes:["touch"]},components:[{type:"lc-camera",width:4000},{type:"lc-logic"},{type:"render-createjs"},{type:"entity-container",entities:[{type:"button-mute"},{type:"button-play"}]}]}],id:"scene-1"},"scene-2":{layers:[{id:"action",components:[{type:"lc-camera",width:3200},{type:"lc-logic"},{type:"lc-basic-collision"},{type:"render-createjs"},{type:"layer-controller"},{type:"entity-container"},{type:"tiled-loader",level:"level-2",unitsPerPixel:10}]},{id:"touch-interface",filter:{includes:["touch"]},components:[{type:"lc-camera",width:960},{type:"lc-logic"},{type:"render-createjs"},{type:"entity-container",entities:[{type:"button-left"},{type:"button-right"},{type:"button-mute"}]}]},{id:"desktop-interface",filter:{excludes:["touch"]},components:[{type:"lc-camera",width:1440},{type:"lc-logic"},{type:"render-createjs"},{type:"entity-container",entities:[{type:"button-mute"}]}]}],id:"scene-2"}},levels:{"level-1":{height:18,layers:[{data:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,37,37,37,37,37,37,37,37,37,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,37,37,37,37,37,37,37,37,37,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,37,37,37,37,37,37,37,37,37,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,37,37,37,37,37,37,37,37,37,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,37,37,37,37,37,37,37,37,37,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,37,37,37,37,37,37,37,37,37,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,37,37,37,37,37,37,37,37,37,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,37,37,37,37,37,37,37,37,37,37,10,10,10,10,10,10,10,1,1,1,1,1,10,10,1,1,1,1,1,1,1,1,1,10,10,10,10,1,1,1,1,1,1,37,37,37,37,37,37,37,37,37,37,37,19,19,19,19,19,19,19,19,1,1,1,19,19,19,1,1,1,1,1,1,1,1,19,19,19,19,19,19,1,1,1,1,1,37,37,37,37,37,37,37,37,37,37,37,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,1,1,1,28,28,28,28,28,28,28,1,1,1,1,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,1,1,1,1,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,29,30,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,38,39,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37],height:18,name:"background",opacity:1,type:"tilelayer",visible:true,width:44,x:0,y:0},{data:[6,21,21,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,11,13,0,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,13,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,3,0,0,0,0,0,0,0,0,13,0,0,0,0,0,0,0,11,13,0,0,0,0,0,0,5,0,0,0,0,3,0,0,0,0,0,0,0,3,0,0,12,0,0,12,3,3,0,0,0,0,0,0,13,0,3,0,0,0,0,0,11,15,3,3,3,0,3,3,18,0,0,0,0,0,0,3,0,0,0,0,0,12,0,0,12,0,0,12,12,12,3,0,0,0,0,0,12,0,12,3,3,0,3,3,3,13,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,12,0,3,0,0,0,12,0,0,0,0,0,3,3,0,0,0,12,0,0,0,0,0,12,12,0,0,0,0,0,0,0,11,0,3,3,3,0,3,3,0,0,0,3,0,0,12,0,0,0,12,0,0,0,3,3,0,0,0,11,0,0,0,0,0,0,0,12,12,0,0,0,0,0,0,0,0,3,0,0,0,3,12,0,0,0,0,0,0,0,12,0,3,3,0,0,0,0,0,0,0,0,3,16,0,12,0,0,0,0,0,12,13,0,0,32,3,32,3,32,0,0,0,12,0,12,12,0,0,0,0,0,0,0,11,0,12,0,0,5,0,0,0,0,0,3,0,12,0,12,0,0,0,0,0,12,12,0,0,33,35,36,35,34,3,3,3,12,0,12,12,0,0,0,0,0,0,3,16,0,12,0,0,12,0,0,0,0,0,12,0,12,0,12,0,0,0,0,0,12,12,0,0,0,0,0,0,20,12,12,12,12,0,0,0,3,3,3,0,0,0,0,12,0,12,0,0,12,0,0,0,0,3,0,0,12,0,12,0,0,0,0,0,12,12,0,0,0,0,0,0,0,0,0,0,0,12,12,12,12,12,12,3,12,0,0,12,0,12,0,0,12,0,0,0,0,12,0,0,12,0,11,0,0,0,0,0,12,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,12,0,0,3,0,0,12,24,26,25,0,0,0,0,0,12,0,0,0,0,0,12,12,0,0,2,3,3,0,3,3,4,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,3,0,0,23,21,23,0,0,0,0,0,12,0,0,0,0,0,12,12,0,5,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,3,0,0,0,0,0,0,0,0,0,12,3,3,3,4,0,2,12,0,11,0,0,0,0,0,0,0,13,0,0,0,0,3,0,3,3,0,3,3,3,0,0,3,0,12,32,3,32,3,32,4,0,2,3,18,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,13,0,0,0,0,12,0,0,0,0,0,0,0,3,0,0,0,12,33,35,36,35,34,13,0,11,12,13,0,0,0,0,0,0,3,3,3,3,3,0,0,0,0,3,3,0,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],height:18,name:"action",opacity:1,properties:{entity:"tile-layer"},type:"tilelayer",visible:true,width:44,x:0,y:0},{height:18,name:"entities",objects:[{gid:55,height:0,name:"",properties:{},type:"",width:0,x:480,y:72},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:864,y:48},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:936,y:168},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:1008,y:216},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:912,y:264},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:816,y:216},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:504,y:264},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:24,y:144},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:312,y:312},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:216,y:408},{gid:47,height:0,name:"",properties:{},type:"",width:0,x:288,y:72},{gid:47,height:0,name:"",properties:{},type:"",width:0,x:264,y:192},{gid:47,height:0,name:"",properties:{},type:"",width:0,x:24,y:408},{gid:47,height:0,name:"",properties:{},type:"",width:0,x:240,y:336},{gid:47,height:0,name:"",properties:{},type:"",width:0,x:408,y:360},{gid:47,height:0,name:"",properties:{},type:"",width:0,x:672,y:72},{gid:47,height:0,name:"",properties:{},type:"",width:0,x:864,y:360},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:720,y:288},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:288,y:408},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:288,y:384},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:144,y:96},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:144,y:72},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:144,y:48},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:264,y:144},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:264,y:120},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:264,y:96},{gid:62,height:0,name:"",properties:{},type:"",width:0,x:72,y:192},{gid:62,height:0,name:"",properties:{},type:"",width:0,x:120,y:192},{gid:62,height:0,name:"",properties:{},type:"",width:0,x:168,y:192},{gid:62,height:0,name:"",properties:{},type:"",width:0,x:672,y:360},{gid:62,height:0,name:"",properties:{},type:"",width:0,x:696,y:360},{gid:62,height:0,name:"",properties:{},type:"",width:0,x:720,y:360},{gid:62,height:0,name:"",properties:{},type:"",width:0,x:744,y:360},{gid:62,height:0,name:"",properties:{},type:"",width:0,x:768,y:360},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:96,y:288},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:192,y:192},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:192,y:216},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:216,y:216},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:240,y:216},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:288,y:216},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:288,y:240},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:288,y:264},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:312,y:264},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:216,y:168},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:312,y:168},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:96,y:120},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:504,y:120},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:504,y:336},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:528,y:336},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:528,y:360},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:504,y:360},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:552,y:360},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:600,y:240},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:624,y:240},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:624,y:264},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:600,y:264},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:816,y:360},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:1008,y:336},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:744,y:96},{gid:56,height:48,name:"",properties:{},type:"",width:24,x:744,y:72},{gid:56,height:0,name:"",properties:{},type:"",width:0,x:504,y:96},{gid:56,height:72,name:"",properties:{},type:"",width:24,x:816,y:336},{gid:56,height:48,name:"",properties:{},type:"",width:48,x:984,y:96},{gid:56,height:48,name:"",properties:{},type:"",width:24,x:456,y:360},{gid:56,height:0,name:"",properties:{},type:"",width:0,x:96,y:264},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:120,y:432},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:144,y:432},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:168,y:432},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:192,y:432},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:264,y:432},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:288,y:432},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:312,y:432},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:336,y:432},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:432,y:168},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:408,y:168},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:384,y:168},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:480,y:264},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:456,y:264},{gid:64,height:0,name:"",properties:{},type:"",width:0,x:840,y:48},{gid:64,height:0,name:"",properties:{},type:"",width:0,x:840,y:144},{gid:65,height:0,name:"",properties:{},type:"",width:0,x:888,y:168},{gid:70,height:0,name:"",properties:{},type:"",width:0,x:384,y:288},{gid:70,height:0,name:"",properties:{},type:"",width:0,x:360,y:168},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:360,y:192},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:360,y:216},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:576,y:24},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:576,y:48},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:576,y:48},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:576,y:72},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:576,y:96},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:576,y:120},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:384,y:312},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:384,y:336},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:384,y:360},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:768,y:24},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:768,y:48},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:768,y:72},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:768,y:96},{gid:75,height:0,name:"",properties:{},type:"",width:0,x:768,y:120},{gid:66,height:0,name:"",properties:{},type:"",width:0,x:744,y:120},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:744,y:144},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:720,y:144},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:600,y:144},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:576,y:144},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:360,y:240},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:384,y:240},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:384,y:384},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:696,y:144},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:672,y:144},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:528,y:408},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:504,y:408},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:480,y:408},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:456,y:384},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:456,y:408},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:432,y:408},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:408,y:408},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:384,y:408},{gid:65,height:0,name:"",properties:{},type:"",width:0,x:528,y:408},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:504,y:408},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:456,y:384},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:456,y:408},{gid:56,height:0,name:"",properties:{},type:"",width:0,x:408,y:240},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:552,y:384},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:576,y:384},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:576,y:408},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:600,y:408},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:624,y:408},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:624,y:384},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:624,y:360},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:600,y:360},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:600,y:336},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:576,y:336},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:576,y:312},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:552,y:312},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:552,y:288},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:552,y:264},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:552,y:240},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:552,y:216},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:552,y:192},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:552,y:168},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:552,y:144},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:576,y:168},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:600,y:168},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:552,y:384},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:576,y:384},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:576,y:408},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:600,y:408},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:624,y:408},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:624,y:384},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:624,y:360},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:600,y:360},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:600,y:336},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:576,y:336},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:576,y:312},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:648,y:144},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:696,y:168},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:672,y:168},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:648,y:168},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:648,y:168},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:672,y:168},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:696,y:168},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:336,y:264},{gid:46,height:0,name:"",properties:{},type:"hero",width:0,x:24,y:96},{gid:56,height:0,name:"",properties:{},type:"",width:0,x:-120,y:456}],opacity:1,type:"objectgroup",visible:true,width:44,x:0,y:0}],orientation:"orthogonal",properties:{},tileheight:24,tilesets:[{firstgid:1,image:"../src/images/tiles.png",imageheight:120,imagewidth:216,margin:0,name:"tiles",properties:{},spacing:0,tileheight:24,tilewidth:24},{firstgid:46,image:"../src/images/objects.png",imageheight:96,imagewidth:192,margin:0,name:"objects",properties:{},spacing:0,tileheight:24,tileproperties:{"0":{entity:"hero"},"10":{entity:"block"},"2":{entity:"dirt"}},tilewidth:24}],tilewidth:24,version:1,width:44,id:"level-1"},"level-2":{height:18,layers:[{data:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,37,37,37,37,37,37,37,37,37,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,37,37,37,37,37,37,37,37,37,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,37,37,37,37,37,37,37,37,37,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,37,37,37,37,37,37,37,37,37,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,37,37,37,37,37,37,37,37,37,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,37,37,37,37,37,37,37,37,37,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,37,37,37,37,37,37,37,37,37,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,37,37,37,37,37,37,37,37,37,37,10,10,10,10,10,10,10,1,1,1,1,1,10,10,1,1,1,1,1,1,1,1,1,10,10,10,10,1,1,1,1,1,1,37,37,37,37,37,37,37,37,37,37,37,19,19,19,19,19,19,19,19,1,1,1,19,19,19,1,1,1,1,1,1,1,1,19,19,19,19,19,19,1,1,1,1,1,37,37,37,37,37,37,37,37,37,37,37,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,1,1,1,28,28,28,28,28,28,28,1,1,1,1,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,1,1,1,1,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,29,30,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,38,39,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37],height:18,name:"background",opacity:1,type:"tilelayer",visible:true,width:44,x:0,y:0},{data:[6,21,21,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,11,13,0,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,13,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,3,0,0,0,0,0,0,0,0,13,0,0,0,0,0,0,0,11,13,0,0,0,0,0,0,5,0,0,0,0,3,0,0,0,0,0,0,0,3,0,0,12,0,0,12,3,3,0,0,0,0,0,0,13,0,3,0,0,0,0,0,11,15,3,3,3,0,3,3,18,0,0,0,0,0,0,3,0,0,0,0,0,12,0,0,12,0,0,12,12,12,3,0,0,0,0,0,12,0,12,3,3,0,3,3,3,13,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,12,0,3,0,0,0,12,0,0,0,0,0,3,3,0,0,0,12,0,0,0,0,0,12,12,0,0,0,0,0,0,0,11,0,3,3,3,0,3,3,0,0,0,3,0,0,12,0,0,0,12,0,0,0,3,3,0,0,0,11,0,0,0,0,0,0,0,12,12,0,0,0,0,0,0,0,0,3,0,0,0,3,12,0,0,0,0,0,0,0,12,0,3,3,0,0,0,0,0,0,0,0,3,16,0,12,0,0,0,0,0,12,13,0,0,32,3,32,3,32,0,0,0,12,0,12,12,0,0,0,0,0,0,0,11,0,12,0,0,5,0,0,0,0,0,3,0,12,0,12,0,0,0,0,0,12,12,0,0,33,35,36,35,34,3,3,3,12,0,12,12,0,0,0,0,0,0,3,16,0,12,0,0,12,0,0,0,0,0,12,0,12,0,12,0,0,0,0,0,12,12,0,0,0,0,0,0,20,12,12,12,12,0,0,0,3,3,3,0,0,0,0,12,0,12,0,0,12,0,0,0,0,3,0,0,12,0,12,0,0,0,0,0,12,12,0,0,0,0,0,0,0,0,0,0,0,12,12,12,12,12,12,3,12,0,0,12,0,12,0,0,12,0,0,0,0,12,0,0,12,0,11,0,0,0,0,0,12,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,12,0,0,3,0,0,12,24,26,25,0,0,0,0,0,12,0,0,0,0,0,12,12,0,0,2,3,3,0,3,3,4,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,3,0,0,23,21,23,0,0,0,0,0,12,0,0,0,0,0,12,12,0,5,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,3,0,0,0,0,0,0,0,0,0,12,3,3,3,4,0,2,12,0,11,0,0,0,0,0,0,0,13,0,0,0,0,3,0,3,3,0,3,3,3,0,0,3,0,12,32,3,32,3,32,4,0,2,3,18,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,13,0,0,0,0,12,0,0,0,0,0,0,0,3,0,0,0,12,33,35,36,35,34,13,0,11,12,13,0,0,0,0,0,0,3,3,3,3,3,0,0,0,0,3,3,0,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],height:18,name:"action",opacity:1,properties:{entity:"tile-layer"},type:"tilelayer",visible:true,width:44,x:0,y:0},{height:18,name:"entities",objects:[{gid:55,height:0,name:"",properties:{},type:"",width:0,x:480,y:72},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:864,y:48},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:936,y:168},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:1008,y:216},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:912,y:264},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:816,y:216},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:504,y:264},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:24,y:144},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:312,y:312},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:216,y:408},{gid:47,height:0,name:"",properties:{},type:"",width:0,x:288,y:72},{gid:47,height:0,name:"",properties:{},type:"",width:0,x:264,y:192},{gid:47,height:0,name:"",properties:{},type:"",width:0,x:24,y:408},{gid:47,height:0,name:"",properties:{},type:"",width:0,x:240,y:336},{gid:47,height:0,name:"",properties:{},type:"",width:0,x:408,y:360},{gid:47,height:0,name:"",properties:{},type:"",width:0,x:672,y:72},{gid:47,height:0,name:"",properties:{},type:"",width:0,x:864,y:360},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:720,y:288},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:288,y:408},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:288,y:384},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:144,y:96},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:144,y:72},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:144,y:48},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:264,y:144},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:264,y:120},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:264,y:96},{gid:62,height:0,name:"",properties:{},type:"",width:0,x:72,y:192},{gid:62,height:0,name:"",properties:{},type:"",width:0,x:120,y:192},{gid:62,height:0,name:"",properties:{},type:"",width:0,x:168,y:192},{gid:62,height:0,name:"",properties:{},type:"",width:0,x:672,y:360},{gid:62,height:0,name:"",properties:{},type:"",width:0,x:696,y:360},{gid:62,height:0,name:"",properties:{},type:"",width:0,x:720,y:360},{gid:62,height:0,name:"",properties:{},type:"",width:0,x:744,y:360},{gid:62,height:0,name:"",properties:{},type:"",width:0,x:768,y:360},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:96,y:288},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:192,y:192},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:192,y:216},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:216,y:216},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:240,y:216},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:288,y:216},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:288,y:240},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:288,y:264},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:312,y:264},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:216,y:168},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:312,y:168},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:72,y:72},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:72,y:96},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:96,y:120},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:504,y:120},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:504,y:336},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:528,y:336},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:528,y:360},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:504,y:360},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:552,y:360},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:600,y:240},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:624,y:240},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:624,y:264},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:600,y:264},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:816,y:360},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:1008,y:336},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:744,y:96},{gid:56,height:48,name:"",properties:{},type:"",width:24,x:744,y:72},{gid:56,height:0,name:"",properties:{},type:"",width:0,x:504,y:96},{gid:56,height:72,name:"",properties:{},type:"",width:24,x:816,y:336},{gid:56,height:48,name:"",properties:{},type:"",width:48,x:984,y:96},{gid:56,height:48,name:"",properties:{},type:"",width:24,x:456,y:360},{gid:56,height:0,name:"",properties:{},type:"",width:0,x:96,y:264},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:120,y:432},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:144,y:432},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:168,y:432},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:192,y:432},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:264,y:432},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:288,y:432},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:312,y:432},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:336,y:432},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:432,y:168},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:408,y:168},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:384,y:168},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:480,y:264},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:456,y:264},{gid:64,height:0,name:"",properties:{},type:"",width:0,x:840,y:48},{gid:64,height:0,name:"",properties:{},type:"",width:0,x:840,y:144},{gid:65,height:0,name:"",properties:{},type:"",width:0,x:888,y:168},{gid:70,height:0,name:"",properties:{},type:"",width:0,x:384,y:288},{gid:70,height:0,name:"",properties:{},type:"",width:0,x:360,y:168},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:360,y:192},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:360,y:216},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:576,y:24},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:576,y:48},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:576,y:48},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:576,y:72},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:576,y:96},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:576,y:120},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:384,y:312},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:384,y:336},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:384,y:360},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:768,y:24},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:768,y:48},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:768,y:72},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:768,y:96},{gid:75,height:0,name:"",properties:{},type:"",width:0,x:768,y:120},{gid:66,height:0,name:"",properties:{},type:"",width:0,x:744,y:120},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:744,y:144},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:720,y:144},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:600,y:144},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:576,y:144},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:360,y:240},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:384,y:240},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:384,y:384},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:696,y:144},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:672,y:144},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:528,y:408},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:504,y:408},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:480,y:408},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:456,y:384},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:456,y:408},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:432,y:408},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:408,y:408},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:384,y:408},{gid:65,height:0,name:"",properties:{},type:"",width:0,x:528,y:408},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:504,y:408},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:456,y:384},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:456,y:408},{gid:56,height:0,name:"",properties:{},type:"",width:0,x:408,y:240},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:552,y:384},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:576,y:384},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:576,y:408},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:600,y:408},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:624,y:408},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:624,y:384},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:624,y:360},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:600,y:360},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:600,y:336},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:576,y:336},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:576,y:312},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:552,y:312},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:552,y:288},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:552,y:264},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:552,y:240},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:552,y:216},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:552,y:192},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:552,y:168},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:552,y:144},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:576,y:168},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:600,y:168},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:552,y:384},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:576,y:384},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:576,y:408},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:600,y:408},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:624,y:408},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:624,y:384},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:624,y:360},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:600,y:360},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:600,y:336},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:576,y:336},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:576,y:312},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:648,y:144},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:696,y:168},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:672,y:168},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:648,y:168},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:648,y:168},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:672,y:168},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:696,y:168},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:336,y:264},{gid:46,height:0,name:"",properties:{},type:"hero",width:0,x:24,y:96},{gid:56,height:0,name:"",properties:{},type:"",width:0,x:-120,y:456}],opacity:1,type:"objectgroup",visible:true,width:44,x:0,y:0}],orientation:"orthogonal",properties:{},tileheight:24,tilesets:[{firstgid:1,image:"../src/images/tiles.png",imageheight:120,imagewidth:216,margin:0,name:"tiles",properties:{},spacing:0,tileheight:24,tilewidth:24},{firstgid:46,image:"../src/images/objects.png",imageheight:96,imagewidth:192,margin:0,name:"objects",properties:{},spacing:0,tileheight:24,tileproperties:{"0":{entity:"hero"},"10":{entity:"block"},"2":{entity:"dirt"}},tilewidth:24}],tilewidth:24,version:1,width:44,id:"level-2"}}};a.classes={};a.classes.game=(function(){var d=function(e,f){return function(g){f(e,g)}},b=function(f){this.currentScene=undefined;this.settings=f;this.rootElement=document.createElement("div");this.rootElement.id=f.global.rootElement;document.getElementsByTagName("body")[0].appendChild(this.rootElement);this.loadScene(f.global.initialScene);var e=this,g=function(h,j){e.currentScene.trigger(h,j)};this.bindings=[];this.addEventListener(window,"keydown",g);this.addEventListener(window,"keyup",g);if(f.global.aspectRatio){g=function(m,n){var k=e.rootElement;var l=f.global.aspectRatio;var o=window.innerWidth;var j=window.innerHeight;var h=o/j;if(h>l){k.style.height=j+"px";o=j*l;k.style.width=o+"px"}else{k.style.width=o+"px";j=o/l;k.style.height=j+"px"}if(f.global.resizeFont){k.style.fontSize=Math.round(o/100)+"px"}k.style.marginTop="-"+Math.round(j/2)+"px";k.style.marginLeft="-"+Math.round(o/2)+"px";e.currentScene.trigger(m,n)};g("resize")}else{if(f.global.resizeFont){g=function(h,j){e.rootElement.style.fontSize=parseInt(window.innerWidth/100)+"px";e.currentScene.trigger(h,j)};g("resize")}}this.addEventListener(window,"orientationchange",g);this.addEventListener(window,"resize",g)},c=b.prototype;c.tick=function(e){if(this.currentScene){this.currentScene.tick(e)}};c.loadScene=function(e,h){var f=this;this.inTransition=true;this.leavingScene=this.currentScene;switch(h){case"fade-to-black":var g=document.createElement("div");this.rootElement.appendChild(g);g.style.width="100%";g.style.height="100%";g.style.position="absolute";g.style.zIndex="12";g.style.opacity="0";g.style.background="#000";new createjs.Tween(g.style).to({opacity:0},500).to({opacity:1},500).call(function(j){f.loadNextScene(e)}).wait(500).to({opacity:0},500).call(function(j){f.rootElement.removeChild(g);g=undefined;f.completeSceneTransition()});break;case"instant":default:this.loadNextScene(e);this.completeSceneTransition()}};c.loadNextScene=function(e){this.currentScene=new a.classes.scene(this.settings.scenes[e],this.rootElement)};c.completeSceneTransition=function(){this.inTransition=false;if(this.leavingScene){this.leavingScene.destroy();this.leavingScene=false}};c.addEventListener=function(e,f,g){this.bindings[f]={element:e,callback:d(f,g)};e.addEventListener(f,this.bindings[f].callback,true)};c.destroy=function(){for(var e in this.bindings){element.removeEventListener(this.bindings[e].element,this.bindings[e].callback,true)}this.bindings.length=0};return b})();a.classes.entity=(function(){var b=function(g,e){var n=this,k=undefined,j=undefined,f=g||{},d=f.components||[],m=f.properties||{},l=e||{},h=l.properties||{};n.components=[];n.messages=[];n.type=f.id;for(k in m){n[k]=m[k]}for(k in h){n[k]=h[k]}for(k in d){j=d[k];if(a.components[j.type]){n.addComponent(new a.components[j.type](n,j))}else{console.warn("Component '"+j.type+"' is not defined.",j)}}n.trigger("load")};var c=b.prototype;c.addComponent=function(d){this.components.push(d);return d};c.removeComponent=function(e){for(var d in this.components){if(this.components[d]===e){this.components.splice(d,1);e.destroy();return e}}return false};c.bind=function(d,e){if(!this.messages[d]){this.messages[d]=[]}this.messages[d].push(e)};c.unbind=function(e,f){if(!this.messages[e]){this.messages[e]=[]}for(var d in this.messages[e]){if(this.messages[e][d]===f){this.messages[e].splice(d,1);break}}};c.trigger=function(d,f){var e=0;if(this.debug||(f&&f.debug)){if(this.messages[d]&&this.messages[d].length){console.log('Entity "'+this.type+'": Event "'+d+'" has '+this.messages[d].length+" subscriber"+((this.messages[d].length>1)?"s":"")+".",f)}else{console.warn('Entity "'+this.type+'": Event "'+d+'" has no subscribers.',f)}}if(this.messages[d]){for(e=0;e<this.messages[d].length;e++){this.messages[d][e](f)}}};c.getMessageIds=function(){var e=[];for(var d in this.messages){e.push(d)}return e};c.destroy=function(){for(var d in this.components){this.components[d].destroy()}this.components.length=0};return b})();a.classes.layer=(function(){var b=function(f,d){var h=f.components,g=undefined;this.type=f.id||"layer";this.debug=f.debug||false;this.rootElement=d;this.components=[];this.tickMessages=[];this.messages=[];for(var e in h){g=h[e];this.addComponent(new a.components[g.type||g.id](this,g))}this.trigger("load")},c=b.prototype;c.tick=function(d){for(var e in this.tickMessages){this.trigger(this.tickMessages[e],d)}};c.addComponent=function(e){var g=false,f=0,d=0;this.components.push(e);if(e.tickMessages){for(f in e.tickMessages){g=false;for(d in this.tickMessages){if(e.tickMessages[f]===this.tickMessages[d]){g=true}}if(!g){this.tickMessages.push(e.tickMessages[f])}}}return e};c.removeComponent=function(e){for(var d in this.components){if(this.components[d]===e){this.components.splice(d,1);e.destroy();return e}}return false};c.bind=function(e,d){if(!this.messages[e]){this.messages[e]=[]}this.messages[e].push(d)};c.unbind=function(e,d){if(!this.messages[e]){this.messages[e]=[]}for(var f in this.messages[e]){if(this.messages[e][f]===d){this.messages[e].splice(f,1);break}}};c.trigger=function(d,f){var e=0;if(this.debug||(f&&f.debug)){if(this.messages[d]&&this.messages[d].length){console.log('Layer "'+this.type+'": Event "'+d+'" has '+this.messages[d].length+" subscriber"+((this.messages[d].length>1)?"s":"")+".",f)}else{console.warn('Layer "'+this.type+'": Event "'+d+'" has no subscribers.',f)}}if(this.messages[d]){for(e=0;e<this.messages[d].length;e++){this.messages[d][e](f)}}};c.destroy=function(){for(var d in this.components){this.components[d].destroy()}this.components.length=0};return b})();a.classes.scene=(function(){var c=function(f,d){var j=f.layers,h=true;this.rootElement=d;this.layers=[];for(var e in j){h=true;if(j[e].filter){if(j[e].filter.includes){h=false;for(var g in j[e].filter.includes){if(a.settings.supports[j[e].filter.includes[g]]){h=true}}}if(j[e].filter.excludes){for(var g in j[e].filter.excludes){if(a.settings.supports[j[e].filter.excludes[g]]){h=false}}}}if(h){this.layers.push(new a.classes.layer(j[e],this.rootElement))}}};var b=c.prototype;b.tick=function(e){for(var d in this.layers){this.layers[d].tick(e)}};b.destroy=function(e){for(var d in this.layers){this.layers[d].destroy()}this.layers.length=0};b.trigger=function(e,f){for(var d in this.layers){this.layers[d].trigger(e,f)}};return c})();a.classes.collisionShape=(function(){var b=function(e,h,g,j){this.offset=j||[0,0];this.x=e[0]+this.offset[0];this.y=e[1]+this.offset[1];this.prevX=this.x;this.prevY=this.y;this.type=h||"rectangle";this.subType="";this.points=g;this.aABB=undefined;var f=0;var d=0;switch(this.type){case"rectangle":case"circle":f=this.points[1][0]-this.points[0][0];d=this.points[1][1]-this.points[0][1];break;case"triangle":if(this.points[0][1]==this.points[1][1]&&this.points[0][0]==this.points[2][0]){if(this.points[0][0]<this.points[1][0]){this.subType="tl";f=this.points[1][0]-this.points[0][0];d=this.points[2][1]-this.points[0][1]}else{this.subType="br";f=this.points[0][0]-this.points[1][0];d=this.points[0][1]-this.points[2][1]}}else{if(this.points[0][1]==this.points[2][1]&&this.points[0][0]==this.points[1][0]){if(this.points[0][1]<this.points[1][1]){this.subType="tr";f=this.points[0][0]-this.points[2][0];d=this.points[1][1]-this.points[0][1]}else{this.subType="bl";f=this.points[2][0]-this.points[0][0];d=this.points[0][1]-this.points[1][1]}}}}this.aABB=new a.classes.aABB(this.x,this.y,f,d)};var c=b.prototype;c.update=function(d,e){this.prevX=this.x;this.prevY=this.y;this.x=d+this.offset[0];this.y=e+this.offset[1];this.aABB.move(this.x,this.y)};c.setXY=function(d,e){this.x=d;this.y=e};c.getXY=function(){return[this.x,this.y]};c.getX=function(){return this.x};c.getY=function(){return this.y};c.getPrevX=function(){return this.prevX};c.getPrevY=function(){return this.prevY};c.getPrevLocation=function(){return[this.prevX,this.prevY]};c.getAABB=function(){return this.aABB};c.getXOffset=function(){return this.offset[0]};c.getYOffset=function(){return this.offset[1]};return b})();a.classes.aABB=(function(){var c=function(e,g,f,d){this.x=e||0;this.y=g||0;this.width=f;this.height=d;this.halfWidth=this.width/2;this.halfHeight=this.height/2;this.left=-this.halfWidth+this.x;this.right=this.halfWidth+this.x;this.top=-this.halfHeight+this.y;this.bottom=this.halfHeight+this.y};var b=c.prototype;b.move=function(d,e){this.x=d;this.y=e;this.left=-this.halfWidth+this.x;this.right=this.halfWidth+this.x;this.top=-this.halfHeight+this.y;this.bottom=this.halfHeight+this.y;return this};b.getCopy=function(){return new a.classes.aABB(this.x,this.y,this.width,this.height)};return c})();a.components={};a.components["enable-ios-audio"]=(function(){var e=false,c=function(f,h){var g=this;this.owner=f;if(!e){this.touchOverlay=document.createElement("div");this.touchOverlay.style.width="100%";this.touchOverlay.style.height="100%";this.touchOverlay.style.position="absolute";this.touchOverlay.style.zIndex="20";this.owner.rootElement.appendChild(this.touchOverlay);b(this.touchOverlay,h.audioId,function(){g.removeComponent()})}else{this.removeComponent()}},b=function(g,f,j){var k=false,h=false;e=true;h=function(p){var o=createjs.SoundJS.play(f),n=o.tag,m=function(){n.removeEventListener("play",m,false);n.pause()},l=function(){n.removeEventListener("canplaythrough",l,false);if(k){k()}};if(o.playState==="playSucceeded"){o.stop()}else{n.addEventListener("play",m,false);n.addEventListener("canplaythrough",l,false);try{n.play()}catch(p){k=function(){k=false;n.play()}}}g.removeEventListener("touchstart",h,false);if(j){j()}};g.addEventListener("touchstart",h,false)},d=c.prototype;d.removeComponent=function(){this.owner.removeComponent(this)};d.destroy=function(){this.owner.rootElement.removeChild(this.touchOverlay);this.touchOverlay=undefined};return c})();a.components["layer-controller"]=(function(){var b=function(h,g){return function(k){if(k.released){h+=":up"}else{if(k.pressed){h+=":down"}}for(var j=0;j<g.entities.length;j++){g.entities[j].trigger(h,k)}}},f=function(h,g){return function(k){for(var j=0;j<g.entities.length;j++){g.entities[j].trigger(h,k)}}},e={kc0:"unknown",kc8:"backspace",kc9:"tab",kc12:"numpad-5-shift",kc13:"enter",kc16:"shift",kc17:"ctrl",kc18:"alt",kc19:"pause",kc20:"caps-lock",kc27:"esc",kc32:"space",kc33:"page-up",kc34:"page-down",kc35:"end",kc36:"home",kc37:"left-arrow",kc38:"up-arrow",kc39:"right-arrow",kc40:"down-arrow",kc42:"numpad-multiply",kc43:"numpad-add",kc44:"print-screen",kc45:"insert",kc46:"delete",kc47:"numpad-division",kc48:"0",kc49:"1",kc50:"2",kc51:"3",kc52:"4",kc53:"5",kc54:"6",kc55:"7",kc56:"8",kc57:"9",kc59:"semicolon",kc61:"equals",kc65:"a",kc66:"b",kc67:"c",kc68:"d",kc69:"e",kc70:"f",kc71:"g",kc72:"h",kc73:"i",kc74:"j",kc75:"k",kc76:"l",kc77:"m",kc78:"n",kc79:"o",kc80:"p",kc81:"q",kc82:"r",kc83:"s",kc84:"t",kc85:"u",kc86:"v",kc87:"w",kc88:"x",kc89:"y",kc90:"z",kc91:"left-windows-start",kc92:"right-windows-start",kc93:"windows-menu",kc96:"back-quote",kc106:"numpad-multiply",kc107:"numpad-add",kc109:"numpad-minus",kc110:"numpad-period",kc111:"numpad-division",kc112:"f1",kc113:"f2",kc114:"f3",kc115:"f4",kc116:"f5",kc117:"f6",kc118:"f7",kc119:"f8",kc120:"f9",kc121:"f10",kc122:"f11",kc123:"f12",kc144:"num-lock",kc145:"scroll-lock",kc186:"semicolon",kc187:"equals",kc188:"comma",kc189:"hyphen",kc190:"period",kc191:"forward-slash",kc192:"back-quote",kc219:"open-bracket",kc220:"back-slash",kc221:"close-bracket",kc222:"quote"},c=function(g,h){this.owner=g;this.entities=[];this.listeners=[];this.tickMessages=["check-inputs"];this.addListeners(["entity-added","check-inputs","keydown","keyup","mousedown","mousemove","mouseup","touchstart","touchmove","touchend","touchcancel"])},d=c.prototype;d.keydown=function(h){for(var g=0;g<this.entities.length;g++){this.entities[g].trigger("key:"+(e["kc"+h.keyCode]||("key-code-"+h.keyCode))+":down",h)}};d.keyup=function(h){for(var g=0;g<this.entities.length;g++){this.entities[g].trigger("key:"+(e["kc"+h.keyCode]||("key-code-"+h.keyCode))+":up",h)}};d["check-inputs"]=function(h){for(var g=0;g<this.entities.length;g++){this.entities[g].trigger("controller:tick")}};d["entity-added"]=function(h){var j=h.getMessageIds();for(var g=0;g<j.length;g++){if(j[g]=="controller"){if(h.controlMap){for(var k in h.controlMap){if((k.indexOf("key:")<0)||(k.indexOf("mouse:")<0)){if(!this[k]){this.addListeners([k,k+":up",k+":down"]);this[k]=b(k,this);this[k+":up"]=f(k+":up",this);this[k+":down"]=f(k+":down",this)}}}}this.entities.push(h);h.trigger("controller:load");break}}};d.destroy=function(){this.removeListeners(this.listeners);this.entities.length=0};d.addListeners=function(h){for(var g in h){this.addListener(h[g])}};d.removeListeners=function(h){for(var g in h){this.removeListener(g,h[g])}};d.addListener=function(h,k){var g=this,j=k||function(l){g[h](l)};this.owner.bind(h,j);this.listeners[h]=j};d.removeListener=function(g,h){this.owner.unbind(g,h)};return c})();a.components["tiled-loader"]=(function(){var b=function(d,e){this.owner=d;this.entities=[];this.listeners=[];this.addListeners(["load"]);this.level=a.settings.levels[e.level];this.tileEntityId=e.tileEntityId||"tile";this.unitsPerPixel=e.unitsPerPixel||1;this.images=e.images||false;this.imagesScale=e.imagesScale||this.unitsPerPixel},c=b.prototype;c.load=function(){var d=0;for(;d<this.level.layers.length;d++){this.setupLayer(this.level.layers[d],this.level)}this.owner.removeComponent(this)};c.setupLayer=function(z,e){var u=z.width,t=z.height,n=this.images||[],w=e.tilesets,d=e.tilewidth,k=e.tileheight,m=0,l=0,p=0,o=undefined,v="",s=undefined,h=undefined,q=undefined,r=undefined,j=undefined,A=undefined,f=undefined,g=true;if(n.length==0){for(m=0;m<w.length;m++){if(a.assets[w[m].name]){n.push(a.assets[w[m].name])}else{n.push(w[m].image)}}}else{n=n.slice();for(m=0;m<n.length;m++){if(a.assets[n[m]]){n[m]=a.assets[n[m]]}}}if(z.type=="tilelayer"){o="tile-layer";if(z.properties&&z.properties.entity){o=z.properties.entity}else{switch(z.name){case"background":case"foreground":o="render-layer";break;case"collision":o="collision-layer";break;case"action":for(m=0;m<e.layers.length;m++){if(e.layers[m].name==="collision"){g=false}}if(!g){o="render-layer"}}}q=JSON.parse(JSON.stringify(a.settings.entities[o]));r={};j=[];A=[];q.properties=q.properties||{};q.properties.width=d*u*this.unitsPerPixel;q.properties.height=k*t*this.unitsPerPixel;q.properties.columns=u;q.properties.rows=t;q.properties.tileWidth=d*this.unitsPerPixel;q.properties.tileHeight=k*this.unitsPerPixel;q.properties.scaleX=this.imagesScale;q.properties.scaleY=this.imagesScale;for(m=0;m<u;m++){j[m]=[];A[m]=[];for(l=0;l<t;l++){if(typeof r["tile"+(+z.data[m+l*u]-1)]=="undefined"){r["tile"+(+z.data[m+l*u]-1)]=+z.data[m+l*u]-1}j[m][l]=+z.data[m+l*u]-1;A[m][l]="tile"+(+z.data[m+l*u]-1)}}for(m=0;m<q.components.length;m++){if(q.components[m].spritesheet=="import"){q.components[m].spritesheet={images:n,frames:{width:d*this.unitsPerPixel/this.imagesScale,height:k*this.unitsPerPixel/this.imagesScale},animations:r}}if(q.components[m].collisionMap=="import"){q.components[m].collisionMap=j}if(q.components[m].imageMap=="import"){q.components[m].imageMap=A}}this.owner.addEntity(new a.classes.entity(q,{properties:{}}))}else{if(z.type=="objectgroup"){for(p=0;p<z.objects.length;p++){o=z.objects[p];for(m=0;m<w.length;m++){if(w[m].firstgid>o.gid){break}else{s=w[m]}}v="";if(o.type!==""){v=o.type}else{if(s.tileproperties[o.gid-s.firstgid]){if(s.tileproperties[o.gid-s.firstgid].entity){v=s.tileproperties[o.gid-s.firstgid].entity}else{if(s.tileproperties[o.gid-s.firstgid].type){v=s.tileproperties[o.gid-s.firstgid].type}}}}if(v!==""){h={};for(m in o.properties){h[m]=o.properties[m]}h.width=(o.width||d)*this.unitsPerPixel;h.height=(o.height||k)*this.unitsPerPixel;h.x=o.x*this.unitsPerPixel+(h.width/2);h.y=o.y*this.unitsPerPixel;h.scaleX=this.unitsPerPixel;h.scaleY=this.unitsPerPixel;o=this.owner.addEntity(new a.classes.entity(a.settings.entities[v],{properties:h}));if(o){if(o.camera){f={entity:o,mode:o.camera}}}}}}}this.owner.trigger("world-loaded",{width:u*d*this.unitsPerPixel,height:t*k*this.unitsPerPixel,unitsPerPixel:this.unitsPerPixel,camera:f})};c.destroy=function(){this.removeListeners(this.listeners);this.entities.length=0};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["render-createjs"]=(function(){var b=function(d,e){this.owner=d;this.entities=[];this.listeners=[];this.tickMessages=["render"];this.addListeners(["entity-added","render","camera-update"]);this.canvas=this.owner.canvas=document.createElement("canvas");this.owner.rootElement.appendChild(this.canvas);this.canvas.style.width="100%";this.canvas.style.height="100%";this.canvas.width=320;this.canvas.height=240;this.stage=new createjs.Stage(this.canvas)},c=b.prototype;c["entity-added"]=function(f){var e=this,g=f.getMessageIds();for(var d=0;d<g.length;d++){if(g[d]=="layer:render"){this.entities.push(f);f.trigger("layer:render-load",{stage:e.stage,parentElement:e.owner.rootElement});break}}};c.render=function(e){for(var d=0;d<this.entities.length;d++){this.entities[d].trigger("layer:render",e)}this.stage.update()};c["camera-update"]=function(d){this.canvas.width=this.canvas.offsetWidth;this.canvas.height=this.canvas.offsetHeight;this.stage.setTransform(-d.x,-d.y,d.scaleX,d.scaleY)};c.destroy=function(){this.removeListeners(this.listeners);this.stage=undefined;this.owner.rootElement.removeChild(this.canvas);this.canvas=undefined;this.entities.length=0};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["render-dom"]=(function(){var b=function(d,e){this.owner=d;this.entities=[];this.listeners=[];this.tickMessages=["render"];this.addListeners(["entity-added","render","camera-update"]);this.element=this.owner.element=document.createElement("div");this.owner.rootElement.appendChild(this.element);this.element.style.position="absolute";this.element.style.width="100%";this.element.style.height="100%"},c=b.prototype;c["entity-added"]=function(f){var e=this,g=f.getMessageIds();for(var d=0;d<g.length;d++){if(g[d]=="layer:render"){this.entities.push(f);f.trigger("layer:render-load",{element:e.element});break}}};c.render=function(e){for(var d=0;d<this.entities.length;d++){this.entities[d].trigger("layer:render",e)}};c["camera-update"]=function(d){};c.destroy=function(){this.removeListeners(this.listeners);this.owner.rootElement.removeChild(this.element);this.element=undefined;this.entities.length=0};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["lc-logic"]=(function(){var b=function(d,e){this.owner=d;this.entities=[];this.listeners=[];this.tickMessages=["logic"];this.addListeners(["entity-added","logic"])};var c=b.prototype;c["entity-added"]=function(f){var e=this,g=f.getMessageIds();for(var d=0;d<g.length;d++){if(g[d]=="layer:logic"){this.entities.push(f);break}}};c.logic=function(e){for(var d=0;d<this.entities.length;d++){this.entities[d].trigger("layer:logic",e)}};c.destroy=function(){this.removeListeners(this.listeners)};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["lc-camera"]=(function(){var b=function(d,e){this.owner=d;this.entities=[];this.stretch=e.stretch||false;this.listeners=[];this.tickMessages=["camera"];this.addListeners(["resize","orientationchange","camera","load","world-loaded","entity-added"]);this.window={viewportTop:this.owner.rootElement.innerTop,viewportLeft:this.owner.rootElement.innerLeft,viewportWidth:this.owner.rootElement.offsetWidth,viewportHeight:this.owner.rootElement.offsetHeight};this.world={viewportWidth:e.width||0,viewportHeight:e.height||0,viewportLeft:e.left||0,viewportTop:e.top||0};this.aspectRatio=e.aspectRatio||0;if(this.world.viewportWidth&&this.world.viewportHeight){this.aspectRatio=this.aspectRatio||(this.world.viewportHeight/this.world.viewportWidth)}else{this.aspectRatio=this.aspectRatio||(this.window.viewportHeight/this.window.viewportWidth);if(this.world.viewportWidth||this.world.viewportHeight){this.world.viewportWidth=this.world.viewportWidth||(this.world.viewportHeight/this.aspectRatio);this.world.viewportHeight=this.world.viewportHeight||(this.aspectRatio/this.world.viewportWidth)}else{this.world.viewportWidth=this.window.viewportWidth;this.world.viewportHeight=this.aspectRatio*this.world.viewportWidth}}this.scaleWidth=e.scaleWidth||0;this.resize();this.worldWidth=0;this.worldHeight=0;this.following=undefined;this.state="static";this.bBBorderX=0;this.bBBorderY=0;this.bBInnerWidth=this.world.viewportWidth-(2*this.bBBorderX);this.bBInnerHeight=this.world.viewportHeight-(2*this.bBBorderY);this.direction=true};var c=b.prototype;c.load=function(){};c["entity-added"]=function(e){var f=e.getMessageIds();for(var d=0;d<f.length;d++){if(f[d]=="camera-update"){this.entities.push(e);break}}};c["world-loaded"]=function(d){this.worldWidth=this.owner.worldWidth=d.width;this.worldHeight=this.owner.worldHeight=d.height;if(d.camera){this.follow(d.camera)}};c.camera=function(e){switch(this.state){case"following":this.followingFunction(this.following);break;case"roaming":var f=0.3*e;if(this.direction){this.move(this.world.viewportLeft+f,this.world.viewportTop);if(this.worldWidth&&(this.world.viewportLeft==this.worldWidth-this.world.viewportWidth)){this.direction=!this.direction}}else{this.move(this.world.viewportLeft-f,this.world.viewportTop);if(this.worldWidth&&(this.world.viewportLeft==0)){this.direction=!this.direction}}break;case"static":default:break}this.owner.trigger("camera-update",{x:this.world.viewportLeft*this.windowPerWorldUnitWidth,y:this.world.viewportTop*this.windowPerWorldUnitHeight,scaleX:this.windowPerWorldUnitWidth,scaleY:this.windowPerWorldUnitHeight,});for(var d=0;d<this.entities.length;d++){this.entities[d].trigger("camera-update",this.world)}};c.resize=c.orientationchange=function(){this.window.viewportTop=this.owner.rootElement.innerTop;this.window.viewportLeft=this.owner.rootElement.innerLeft;this.window.viewportWidth=this.owner.rootElement.offsetWidth;this.window.viewportHeight=this.owner.rootElement.offsetHeight;if(this.scaleWidth){this.world.viewportWidth=this.window.viewportWidth/Math.ceil(this.window.viewportWidth/this.scaleWidth)}if(!this.stretch||this.scaleWidth){this.world.viewportHeight=this.window.viewportHeight*this.world.viewportWidth/this.window.viewportWidth}this.worldPerWindowUnitWidth=this.world.viewportWidth/this.window.viewportWidth;this.worldPerWindowUnitHeight=this.world.viewportHeight/this.window.viewportHeight;this.windowPerWorldUnitWidth=this.window.viewportWidth/this.world.viewportWidth;this.windowPerWorldUnitHeight=this.window.viewportHeight/this.world.viewportHeight};c.follow=function(d){switch(d.mode){case"locked":this.state="following";this.following=d.entity;this.followingFunction=this.lockedFollow;break;case"bounding":this.state="following";this.following=d.entity;this.setBoundingArea(d.top,d.left,d.width,d.height);this.followingFunction=this.boundingFollow;break;case"static":default:this.state="static";this.following=undefined;this.followingFunction=undefined;break}};c.move=function(e,d){this.moveLeft(e);this.moveTop(d)};c.moveLeft=function(d){if(this.worldWidth<this.world.viewportWidth){this.world.viewportLeft=(this.worldWidth-this.world.viewportWidth)/2}else{if(this.worldWidth&&(d+this.world.viewportWidth>this.worldWidth)){this.world.viewportLeft=this.worldWidth-this.world.viewportWidth}else{if(this.worldWidth&&(d<0)){this.world.viewportLeft=0}else{this.world.viewportLeft=d}}}};c.moveTop=function(d){if(this.worldHeight<this.world.viewportHeight){this.world.viewportTop=(this.worldHeight-this.world.viewportHeight)/2}else{if(this.worldHeight&&(d+this.world.viewportHeight>this.worldHeight)){this.world.viewportTop=this.worldHeight-this.world.viewportHeight}else{if(this.worldHeight&&(d<0)){this.world.viewportTop=0}else{this.world.viewportTop=d}}}};c.lockedFollow=function(d){this.move(d.x-(this.world.viewportWidth/2),d.y-(this.world.viewportHeight/2))};c.setBoundingArea=function(g,f,e,d){this.bBBorderY=(typeof g!=="undefined")?g:500;this.bBBorderX=(typeof f!=="undefined")?f:500;this.bBInnerWidth=(typeof e!=="undefined")?e:this.world.viewportWidth-(2*this.bBBorderX);this.bBInnerHeight=(typeof d!=="undefined")?d:this.world.viewportHeight-(2*this.bBBorderY)};c.boundingFollow=function(e){var f=undefined;var d=undefined;if(e.x>this.world.viewportLeft+this.bBBorderX+this.bBInnerWidth){f=e.x-(this.bBBorderX+this.bBInnerWidth)}else{if(e.x<this.world.viewportLeft+this.bBBorderX){f=e.x-this.bBBorderX}}if(e.y>this.world.viewportTop+this.bBBorderY+this.bBInnerHeight){d=e.y-(this.bBBorderY+this.bBInnerHeight)}else{if(e.y<this.world.viewportTop+this.bBBorderY){d=e.y-this.bBBorderY}}if(typeof f!=="undefined"){this.moveLeft(f)}if(typeof d!=="undefined"){this.moveTop(d)}};c.windowToWorld=function(d){var e=[];e[0]=Math.round((d[0]-this.window.viewportLeft)*this.worldPerWindowUnitWidth);e[1]=Math.round((d[1]-this.window.viewportTop)*this.worldPerWindowUnitHeight);return e};c.worldToWindow=function(e){var d=[];d[0]=Math.round((e[0]*this.windowPerWorldUnitWidth)+this.window.viewportLeft);d[1]=Math.round((e[1]*this.windowPerWorldUnitHeight)+this.window.viewportTop);return d};c.destroy=function(){this.removeListeners(this.listeners);this.entities.length=0};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["lc-basic-collision"]=(function(){var b=function(d,e){this.owner=d;this.listeners=[];this.tickMessages=["collision"];this.addListeners(["load","entity-added","collision"]);this.entities=[];this.solidEntities=[];this.terrain=undefined;this.collisionMatrix={}};var c=b.prototype;c["entity-added"]=function(f){var e=this;var g=f.getMessageIds();if(f.type=="tile-layer"){this.terrain=f}else{for(var d=0;d<g.length;d++){if(g[d]=="layer:resolve-collision"){if(f.collisionType=="solid"){this.solidEntities.push(f)}else{this.entities.push(f)}if(!this.collisionMatrix[f.type]){this.collisionMatrix[f.type]={};for(var d=0;d<f.collidesWith.length;d++){this.collisionMatrix[f.type][f.collidesWith[d]]=true}}break}}}};c.load=function(){};c.collision=function(e){var d=[];this.prepareCollision();this.checkStupidCollision();d=this.checkCollision();this.resolveCollision(d)};c.prepareCollision=function(){for(var d=0;d<this.entities.length;d++){this.entities[d].trigger("layer:prep-collision")}};c.checkStupidCollision=function(){for(var I=0;I<this.entities.length;I++){var k=this.entities[I];if(this.collisionMatrix[k.type]["solid"]){var m=k.shape.getAABB();var l=k.shape.getPrevLocation();var G=(m.getCopy()).move(l[0],l[1]);var A=Math.min(m.top,G.top);var D=Math.max(m.bottom,G.bottom);var F=D-A;var d=Math.min(m.left,G.left);var j=Math.max(m.right,G.right);var n=j-d;var g=d+(n/2);var f=A+(F/2);var P=new a.classes.aABB(g,f,n,F);var M=[];var e=this.terrain.getTiles(P);for(var H=0;H<this.solidEntities.length;H++){if(this.AABBCollision(P,this.solidEntities[H].shape.getAABB())){M.push(this.solidEntities[H])}}var O=(k.shape.getPrevX()<k.shape.getX())?1:-1;var v=k.shape.getPrevX();var C=k.shape.getX();var o=(k.shape.getPrevY()<k.shape.getY())?1:-1;var S=k.shape.getPrevY();var s=k.shape.getY();var B=undefined;var E=undefined;var V=[];var U=[];var z=undefined;var w=undefined;while(v!=C&&(e.length||M.length)){if(Math.abs(C-v)<=1){v=C}else{v+=O}G.move(v,S);var r=undefined;for(var K=0;K<e.length;K++){r=e[K].shape.getAABB();if(this.AABBCollision(G,r)){if(this.preciseCollision(k.shape,e[K].shape)){var T=undefined;if(O>0){T=r.left-G.halfWidth}else{T=r.right+G.halfWidth}if(typeof tilecollisionX==="undefined"){z={atX:T,aABB:r,shape:e[K].shape}}else{if(O>0){if(T<z.atX){z={atX:T,aABB:r,shape:e[K].shape}}}else{if(T>z.atX){z={atX:T,aABB:r,shape:e[K].shape}}}}}}}var N=undefined;for(var J=0;J<M.length;J++){N=M[J].shape.getAABB();if(this.AABBCollision(G,N)){if(this.preciseCollision(k.shape,M[J].shape)){var T=undefined;if(O>0){T=N.left-G.halfWidth;if(z&&T>z.atX){continue}}else{T=N.right+G.halfWidth;if(z&&T<z.atX){continue}}if(V.length==0){V.push({atX:T,entity:M[J]})}else{if(O>0){var h=0;for(var Q=0;Q<V.length;Q++){if(T<V[Q].atX){h=Q;break}}V.splice(h,0,{atX:T,type:M[J].collisionType,aABB:N,entity:M[J]})}else{var h=0;for(var Q=0;Q<V.length;Q++){if(T>V[Q].atX){h=Q;break}}V.splice(h,0,{atX:T,type:M[J].collisionType,aABB:N,entity:M[J]})}}}}}if(k.routeSolidCollision){var p=false;for(var L=0;L<V.length;L++){p=k.routeSolidCollision("x",O,V[L]);if(p){E=V[L].atX;break}}}if(k.routeTileCollision){var p=false;if(typeof E==="undefined"&&z){p=k.routeTileCollision("x",O,z);if(p){E=z.atX}}}if(typeof E!=="undefined"){break}}if(typeof E==="undefined"){E=C}while(S!=s&&(e.length||M.length)){if(Math.abs(s-S)<1){S=s}else{S+=o}G.move(E,S);var r=undefined;for(var K=0;K<e.length;K++){r=e[K].shape.getAABB();if(this.AABBCollision(G,r)){if(this.preciseCollision(k.shape,e[K].shape)){var R=undefined;if(o>0){R=r.top-G.halfHeight}else{R=r.bottom+G.halfHeight}if(typeof tilecollisionY==="undefined"){w={atY:R,aABB:r,shape:e[K].shape}}else{if(o>0){if(R<U[0].atY){w={atY:R,aABB:r,shape:e[K].shape}}}else{if(R>w.atY){w={atY:R,aABB:r,shape:e[K].shape}}}}}}}var N=undefined;for(var J=0;J<M.length;J++){N=M[J].shape.getAABB();if(this.AABBCollision(G,N)){if(this.preciseCollision(k.shape,M[J].shape)){var R=undefined;if(o>0){R=N.top-G.halfHeight;if(w&&R>w.atY){continue}}else{R=N.bottom+G.halfHeight;if(w&&R<w.atY){continue}}if(U.length==0){U.push({atY:R,entity:M[J]})}else{if(o>0){var h=0;for(var Q=0;Q<U.length;Q++){if(R<U[Q].atY){h=Q;break}}U.splice(h,0,{atY:R,type:M[J].collisionType,aABB:N,entity:M[J]})}else{var h=0;for(var Q=0;Q<U.length;Q++){if(R>U[K].atY){h=Q;break}}U.splice(h,0,{atY:R,type:M[J].collisionType,aABB:N,entity:M[J]})}}}}}if(k.routeSolidCollision){var p=false;for(var L=0;L<U.length;L++){p=k.routeSolidCollision("y",o,U[L]);if(p){B=U[L].atY;break}}}if(k.routeTileCollision){var p=false;if(typeof B==="undefined"&&w){p=k.routeTileCollision("y",o,w);if(p){B=w.atY}}}if(typeof B!=="undefined"){break}}if(typeof B==="undefined"){B=s}k.trigger("layer:relocate",[E,B])}}};c.moveSolidFree=function(k,C,A){if(this.collisionMatrix[k.type]["solid"]){var m=k.shape.getAABB();var l=k.shape.getPrevLocation();var D=(m.getCopy()).move(l[0],l[1]);var w=Math.min(m.top,D.top);var z=Math.max(m.bottom,D.bottom);var B=z-w;var d=Math.min(m.left,D.left);var j=Math.max(m.right,D.right);var n=j-d;var g=d+(n/2);var f=w+(B/2);var L=new a.classes.aABB(g,f,n,B);var I=[];var e=this.terrain.getTiles(L);for(var E=0;E<this.solidEntities.length;E++){if(this.AABBCollision(L,this.solidEntities[E].shape.getAABB())){I.push(this.solidEntities[E])}}var K=(k.shape.getPrevX()<k.shape.getX())?1:-1;var v=k.shape.getPrevX();var x=k.shape.getX();var o=(k.shape.getPrevY()<k.shape.getY())?1:-1;var O=k.shape.getPrevY();var s=k.shape.getY();var R=[];var Q=[];while(v!=x&&(e.length||I.length)){if(Math.abs(x-v)<=1){v=x}else{v+=K}D.move(v,O);var r=undefined;for(var G=0;G<e.length;G++){r=e[G].shape.getAABB();if(this.AABBCollision(D,r)){if(this.preciseCollision(k.shape,e[G].shape)){return false}}}var J=undefined;for(var F=0;F<I.length;F++){J=I[F].shape.getAABB();if(this.AABBCollision(D,J)){if(this.preciseCollision(k.shape,I[F].shape)){var P=undefined;if(K>0){P=J.left-D.halfWidth;if(tileCollisionX&&P>tileCollisionX.atX){continue}}else{P=J.right+D.halfWidth;if(tileCollisionX&&P<tileCollisionX.atX){continue}}if(R.length==0){R.push({atX:P,entity:I[F]})}else{if(K>0){var h=0;for(var M=0;M<R.length;M++){if(P<R[M].atX){h=M;break}}R.splice(h,0,{atX:P,type:I[F].collisionType,aABB:J,entity:I[F]})}else{var h=0;for(var M=0;M<R.length;M++){if(P>R[M].atX){h=M;break}}R.splice(h,0,{atX:P,type:I[F].collisionType,aABB:J,entity:I[F]})}}}}}if(k.routeSolidCollision){var p=false;for(var H=0;H<R.length;H++){p=k.routeSolidCollision("x",K,R[H]);if(p){finalX=R[H].atX;break}}}if(k.routeTileCollision){var p=false;if(typeof finalX==="undefined"&&tileCollisionX){p=k.routeTileCollision("x",K,tileCollisionX);if(p){finalX=tileCollisionX.atX}}}if(typeof finalX!=="undefined"){break}}while(O!=s&&(e.length||I.length)){if(Math.abs(s-O)<1){O=s}else{O+=o}D.move(finalX,O);var r=undefined;for(var G=0;G<e.length;G++){r=e[G].shape.getAABB();if(this.AABBCollision(D,r)){if(this.preciseCollision(k.shape,e[G].shape)){return false}}}var J=undefined;for(var F=0;F<I.length;F++){J=I[F].shape.getAABB();if(this.AABBCollision(D,J)){if(this.preciseCollision(k.shape,I[F].shape)){var N=undefined;if(o>0){N=J.top-D.halfHeight;if(tileCollisionY&&N>tileCollisionY.atY){continue}}else{N=J.bottom+D.halfHeight;if(tileCollisionY&&N<tileCollisionY.atY){continue}}if(Q.length==0){Q.push({atY:N,entity:I[F]})}else{if(o>0){var h=0;for(var M=0;M<Q.length;M++){if(N<Q[M].atY){h=M;break}}Q.splice(h,0,{atY:N,type:I[F].collisionType,aABB:J,entity:I[F]})}else{var h=0;for(var M=0;M<Q.length;M++){if(N>Q[G].atY){h=M;break}}Q.splice(h,0,{atY:N,type:I[F].collisionType,aABB:J,entity:I[F]})}}}}}if(k.routeSolidCollision){var p=false;for(var H=0;H<Q.length;H++){p=k.routeSolidCollision("y",o,Q[H]);if(p){finalY=Q[H].atY;break}}}if(k.routeTileCollision){var p=false;if(typeof finalY==="undefined"&&tileCollisionY){p=k.routeTileCollision("y",o,tileCollisionY);if(p){finalY=tileCollisionY.atY}}}if(typeof finalY!=="undefined"){break}}if(typeof finalY==="undefined"){finalY=s}k.trigger("layer:relocate",[finalX,finalY])}};c.checkCollision=function(){var e=[];for(var d=0;d<this.entities.length-1;d++){for(var f=d+1;f<this.entities.length;f++){if(this.collisionMatrix[this.entities[d].type][this.entities[f].collisionType]||this.collisionMatrix[this.entities[f].type][this.entities[d].collisionType]){if(this.AABBCollision(this.entities[d].shape.getAABB(),this.entities[f].shape.getAABB())){if(this.preciseCollision(this.entities[d].shape,this.entities[f].shape)){if(this.collisionMatrix[this.entities[d].type][this.entities[f].collisionType]){e.push({entity:this.entities[d],message:{entity:this.entities[f],type:this.entities[f].collisionType,shape:this.entities[f].shape}})}if(this.collisionMatrix[this.entities[f].type][this.entities[d].collisionType]){e.push({entity:this.entities[f],message:{entity:this.entities[d],type:this.entities[d].collisionType,shape:this.entities[d].shape}})}}}}}}return e};c.AABBCollision=function(e,d){if(e.left>=d.right){return false}if(e.right<=d.left){return false}if(e.top>=d.bottom){return false}if(e.bottom<=d.top){return false}return true};c.preciseCollision=function(e,d){return true};c.resolveCollision=function(e){for(var d=0;d<e.length;d++){if(e[d].routeSoftCollision){e[d].routeSoftCollision(e[d].message)}}};c.destroy=function(){this.removeListeners(this.listeners);this.entities.length=0};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components.audio=(function(){var c={interrupt:createjs.SoundJS.INTERRUPT_ANY,delay:0,offset:0,loop:0,volume:1,pan:0,length:0},e=function(j){var h="",f=undefined;if(typeof j==="string"){h=j}else{f=j;h=j.sound}if(a.settings.assets[h].data){if(!f){f=a.settings.assets[h].data}else{for(var g in a.settings.assets[h].data){f[g]=f[g]||a.settings.assets[h].data[g]}}}if(a.settings.assets[h].assetId){h=a.settings.assets[h].assetId}return function(s){var n=undefined,k=0;s=s||f;if(s){var m=s.interrupt||f.interrupt||c.interrupt,o=s.delay||f.delay||c.delay,l=s.offset||f.offset||c.offset,q=s.loop||f.loop||c.loop,p=(typeof s.volume!=="undefined")?s.volume:((typeof f.volume!=="undefined")?f.volume:c.volume),r=s.pan||f.pan||c.pan;k=s.length||f.length||c.length;n=createjs.SoundJS.play(h,m,o,l,q,p,r)}else{n=createjs.SoundJS.play(h,c.interrupt,c.delay,c.offset,c.loop,c.volume,c.pan)}if(n.playState==="playFailed"){if(this.owner.debug){console.warn('Unable to play "'+h+'".',n)}}else{if(k){this.timedAudioClips.push({length:k,progress:0,audio:n})}}}},b=function(f,h){this.owner=f;this.timedAudioClips=[],this.listeners=[];this.addListeners(["layer:render","audio-mute-toggle","audio-mute","audio-unmute"]);if(h.audioMap){for(var g in h.audioMap){this.addListener(g);this[g]=e(h.audioMap[g])}}};var d=b.prototype;d["layer:render"]=function(h){var g=0,f=undefined;newArray=undefined;if(this.timedAudioClips.length){newArray=[];for(g in this.timedAudioClips){f=this.timedAudioClips[g];f.progress+=h;if(f.progress>=f.length){f.audio.stop()}else{newArray.push(f)}}this.timedAudioClips=newArray}};d["audio-mute-toggle"]=function(f){createjs.SoundJS.setMute(!createjs.SoundJS.muted,f)};d["audio-mute"]=function(f){createjs.SoundJS.setMute(true,f)};d["audio-unmute"]=function(f){createjs.SoundJS.setMute(false,f)};d.destroy=function(){this.removeListeners(this.listeners)};d.addListeners=function(g){for(var f in g){this.addListener(g[f])}};d.removeListeners=function(g){for(var f in g){this.removeListener(f,g[f])}};d.addListener=function(g,j){var f=this,h=j||function(k){f[g](k)};this.owner.bind(g,h);this.listeners[g]=h};d.removeListener=function(f,g){this.owner.unbind(f,g)};return b})();a.components["broadcast-events"]=(function(){var c=function(f){if(typeof f==="string"){return function(g){a.game.currentScene.trigger(f,g)}}else{return function(g){for(var h in f){a.game.currentScene.trigger(f[h],g)}}}},b=function(f){if(typeof f==="string"){return function(g){this.owner.trigger(f,g)}}else{return function(g){for(var h in f){this.owner.trigger(f[h],g)}}}},d=function(f,g){this.owner=f;this.listeners=[];if(g.events){for(var h in g.events){this[h]=c(g.events[h]);this.addListener(h)}}if(g.renameEvents){for(var h in g.renameEvents){this[h]=b(g.renameEvents[h]);this.addListener(h)}}},e=d.prototype;e.destroy=function(){this.removeListeners(this.listeners)};e.addListeners=function(g){for(var f in g){this.addListener(g[f])}};e.removeListeners=function(g){for(var f in g){this.removeListener(f,g[f])}};e.addListener=function(g,j){var f=this,h=j||function(k){f[g](k)};this.owner.bind(g,h);this.listeners[g]=h};e.removeListener=function(f,g){this.owner.unbind(f,g)};return d})();a.components["change-scene"]=(function(){var b=function(d,e){this.owner=d;this.listeners=[];this.scene=e.scene;this.transition=e.transition||"instant";this.addListeners(["new-scene"])};var c=b.prototype;c["new-scene"]=function(f){var f=f||this,d=f.scene||this.scene,e=f.transition||this.transition;a.game.loadScene(d,e)};c.destroy=function(){this.removeListeners(this.listeners)};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["dom-element"]=(function(){var b=function(d,g){var f=this,e=g.element||"div",h=g.innerHTML||false;this.owner=d;this.listeners=[];this.addListeners(["layer:render","layer:render-load"]);this.element=this.owner.element=document.createElement(e);for(i in g){if((i!=="innerHTML")&&(i!=="type")&&(i!=="element")){if(i.indexOf("on")===0){this.element[i]=function(j){f.owner.trigger(g[i],j)}}else{this.element[i]=g[i]}}}if(h){this.element.innerHTML=h}};var c=b.prototype;c["layer:render-load"]=function(d){if(d.element){this.parentElement=d.element;this.parentElement.appendChild(this.element)}};c["layer:render"]=function(d){};c.destroy=function(){this.removeListeners(this.listeners);if(this.parentElement){this.parentElement.removeChild(this.element);this.parentElement=undefined}if(this.owner.element===this.element){this.owner.element=undefined}this.element=undefined};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["entity-container"]=(function(){var b=function(e,g){var f=this,d=0;this.owner=e;this.listeners=[];this.entities=[];this.definedEntities=g.entities;this.owner.entities=f.entities;this.owner.addEntity=function(h){return f.addEntity(h)};this.owner.removeEntity=function(){return f.removeEntity()};this.addListeners(["load","add-entity","remove-entity"])};var c=b.prototype;c.load=function(){var d=0,e=this.definedEntities;this.definedEntities=false;if(e){for(d=0;d<e.length;d++){this.addEntity(new a.classes.entity(a.settings.entities[e[d].type],e[d]))}}};c.addEntity=c["add-entity"]=function(d){this.entities.push(d);this.owner.trigger("entity-added",d);return d};c.removeEntity=c["remove-entity"]=function(e){for(var d=0;d<this.entities.length;d++){if(this.entities[d]===e){this.entities.splice(d,1);e.destroy();return e}}return false};c.destroy=function(){this.removeListeners(this.listeners);for(var d in this.entities){this.entities[d].destroy()}this.entities.length=0};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["entity-controller"]=(function(){var f=function(){this.current=false;this.last=false;this.state=false},h=["left-button","middle-button","right-button"],d=function(j){return function(k){j.state=false}},c=function(j){return function(k){j.current=true;j.state=true;if(k&&(typeof(k.over)!=="undefined")){j.over=k.over}}},b=function(j,l){var k="",m=undefined;this.owner=j;this.listeners=[];this.addListeners(["load","controller","controller:load","controller:tick","mousedown","mouseup","mousemove"]);if(l&&l.controlMap){this.owner.controlMap=l.controlMap;this.actions={};for(k in l.controlMap){m=this.actions[l.controlMap[k]];if(!m){m=this.actions[l.controlMap[k]]=new f()}this[k+":up"]=d(m);this[k+":down"]=c(m);this.addListener(k+":up");this.addListener(k+":down")}}},g=f.prototype,e=b.prototype;g.update=function(){this.last=this.current;this.current=this.state};g.isPressed=function(){return this.current};g.isTriggered=function(){return this.current&&!this.last};g.isReleased=function(){return !this.current&&this.last};e.load=function(){};e["mouse:move"]=function(j){if(this.actions["mouse:left-button"]&&(this.actions["mouse:left-button"].over!==j.over)){this.actions["mouse:left-button"].over=j.over}if(this.actions["mouse:middle-button"]&&(this.actions["mouse:middle-button"].over!==j.over)){this.actions["mouse:middle-button"].over=j.over}if(this.actions["mouse:right-button"]&&(this.actions["mouse:right-button"].over!==j.over)){this.actions["mouse:right-button"].over=j.over}};e.controller=function(){};e["controller:load"]=function(){};e["controller:tick"]=function(l){var k=undefined,j="";if(this.actions){for(j in this.actions){k=this.actions[j];if(k.current||k.last){this.owner.trigger(j,{pressed:k.current,released:!k.current&&k.last,triggered:k.current&&!k.last,over:k.over})}k.update()}}};e.mousedown=function(j){this.owner.trigger("mouse:"+h[j.event.button||0]+":down",j.event)};e.mouseup=function(j){this.owner.trigger("mouse:"+h[j.event.button||0]+":up",j.event)};e.mousemove=function(j){this.owner.trigger("mouse:move",j)};e.destroy=function(){this.removeListeners(this.listeners)};e.addListeners=function(k){for(var j in k){this.addListener(k[j])}};e.removeListeners=function(k){for(var j in k){this.removeListener(j,k[j])}};e.addListener=function(k,m){var j=this,l=m||function(n){j[k](n)};this.owner.bind(k,l);this.listeners[k]=l};e.removeListener=function(j,k){this.owner.unbind(j,k)};return b})();a.components["render-debug"]=(function(){var b=function(d,e){this.owner=d;if(e.acceptInput){this.hover=e.acceptInput.hover||false;this.click=e.acceptInput.click||false;this.touch=e.acceptInput.touch||false}else{this.hover=false;this.click=false;this.touch=false}this.regX=e.regX||0;this.regY=e.regY||0;this.listeners=[];this.addListeners(["layer:render","layer:render-load"])};var c=b.prototype;c["layer:render"]=function(d){this.shape.x=this.owner.x-this.regX;this.shape.y=this.owner.y-this.regY;this.txt.x=this.owner.x-this.regX+(this.owner.width/2);this.txt.y=this.owner.y-this.regY+(this.owner.height/2)};c["layer:render-load"]=function(f){var n=this,l=this.owner.x=this.owner.x||0,k=this.owner.y=this.owner.y||0,d=this.owner.width=this.owner.width||300,m=this.owner.height=this.owner.height||100,e=a.settings.entities[this.owner.type]?(a.settings.entities[this.owner.type].components||[]):[],h=[],j=false;for(var g in e){h[g]=e[g].type}this.stage=f.stage;this.txt=new createjs.Text(this.owner.type+"\n("+h.join(", ")+")");this.txt.x=l+d/2;this.txt.y=k+m/2;this.txt.textAlign="center";this.txt.textBaseline="middle";if(this.owner.shape&&this.owner.shape.type=="rectangle"){d=this.owner.shape.points[1][0]-this.owner.shape.points[0][0];m=this.owner.shape.points[1][1]-this.owner.shape.points[0][1];this.shape=new createjs.Shape((new createjs.Graphics()).beginFill("rgba(255,0,255,0.1)").setStrokeStyle(3).beginStroke("#f0f").rect(0,0,d,m));this.regX=d/2-this.owner.shape.offset[0];this.regY=m/2-this.owner.shape.offset[1]}else{this.shape=new createjs.Shape((new createjs.Graphics()).beginFill("rgba(0,0,0,0.1)").beginStroke("#880").rect(0,0,d,m))}this.stage.addChild(this.shape);this.stage.addChild(this.txt);if(this.touch&&createjs.Touch.isSupported()){createjs.Touch.enable(this.stage)}this.shape.onPress=function(o){if(this.click||this.touch){n.owner.trigger("mousedown",{event:o.nativeEvent,over:j,x:o.stageX,y:o.stageY,entity:n.owner});o.onMouseUp=function(p){n.owner.trigger("mouseup",{event:p.nativeEvent,over:j,x:p.stageX,y:p.stageY,entity:n.owner})};o.onMouseMove=function(p){n.owner.trigger("mousemove",{event:p.nativeEvent,over:j,x:p.stageX,y:p.stageY,entity:n.owner})}}if(o.nativeEvent.button==2){console.log("This Entity:",n.owner)}};if(this.click||this.touch){this.shape.onMouseOut=function(){j=false};this.shape.onMouseOver=function(){j=true}}if(this.hover){this.stage.enableMouseOver();this.shape.onMouseOut=function(o){j=false;n.owner.trigger("mouseout",{event:o.nativeEvent,over:j,x:o.stageX,y:o.stageY,entity:n.owner})};this.shape.onMouseOver=function(o){j=true;n.owner.trigger("mouseover",{event:o.nativeEvent,over:j,x:o.stageX,y:o.stageY,entity:n.owner})}}};c.destroy=function(){this.removeListeners(this.listeners)};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["render-tiles"]=(function(){var b=function(d,f){this.owner=d;this.controllerEvents=undefined;this.spriteSheet=new createjs.SpriteSheet(f.spritesheet);this.imageMap=f.imageMap||[];this.scaleX=f.scaleX||this.owner.scaleX||1;this.scaleY=f.scaleY||this.owner.scaleY||1;this.tileWidth=f.tileWidth||(this.owner.tileWidth/this.scaleX)||10;this.tileHeight=f.tileHeight||(this.owner.tileHeight/this.scaleY)||10;var e=(f.buffer||this.tileWidth)*this.scaleX;this.camera={x:-e-1,y:-e-1,buffer:e};this.state=f.state||"tile";this.listeners=[];this.addListeners(["layer:render","layer:render-load","camera-update"])};var c=b.prototype;c["layer:render"]=function(d){};c["layer:render-load"]=function(f){var d=0,g=0,e=this.stage=f.stage;tile=undefined;this.tileList=new createjs.Container();for(d=0;d<this.imageMap.length;d++){for(g=0;g<this.imageMap[d].length;g++){tile=new createjs.BitmapAnimation(this.spriteSheet);tile.x=d*this.tileWidth;tile.y=g*this.tileHeight;this.tileList.addChild(tile);tile.gotoAndPlay(this.imageMap[d][g])}}this.tileList.scaleX=this.scaleX;this.tileList.scaleY=this.scaleY;e.addChild(this.tileList)};c["camera-update"]=function(e){var d=this.camera.buffer/this.scaleX;if((Math.abs(this.camera.x-e.viewportLeft)>this.camera.buffer)||(Math.abs(this.camera.y-e.viewportTop)>this.camera.buffer)){this.camera.x=e.viewportLeft;this.camera.y=e.viewportTop;this.tileList.cache(e.viewportLeft/this.scaleX-d,e.viewportTop/this.scaleY-d,e.viewportWidth/this.scaleX+d*2,e.viewportHeight/this.scaleY+d*2)}};c.destroy=function(){this.removeListeners(this.listeners);this.tileList.removeAllChildren();this.stage.removeChild(this.tileList);this.stage=undefined;this.tileList=undefined};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["render-animation"]=(function(){var b=function(e,g){var f={images:g.spriteSheet.images.slice(),frames:g.spriteSheet.frames,animations:g.spriteSheet.animations};this.owner=e;if(g.acceptInput){this.hover=g.acceptInput.hover||false;this.click=g.acceptInput.click||false;this.touch=g.acceptInput.touch||false}else{this.hover=false;this.click=false;this.touch=false}this.listeners=[];this.addListeners(["layer:render-load","layer:render","logical-state"]);this.stage=undefined;for(var d=0;d<f.images.length;d++){f.images[d]=a.assets[f.images[d]]}f=new createjs.SpriteSheet(f);this.anim=new createjs.BitmapAnimation(f);this.currentAnimation=g.state||this.owner.state||"";this.anim.scaleX=g.scaleX||this.owner.scaleX||1;this.anim.scaleY=g.scaleY||this.owner.scaleY||1;if(this.currentAnimation){this.anim.gotoAndPlay(this.currentAnimation)}};var c=b.prototype;c["layer:render-load"]=function(f){var d=this,e=false;this.stage=f.stage;this.stage.addChild(this.anim);if(this.click||this.touch){if(this.touch&&createjs.Touch.isSupported()){createjs.Touch.enable(this.stage)}this.anim.onPress=function(g){d.owner.trigger("mousedown",{event:g.nativeEvent,over:e,x:g.stageX,y:g.stageY,entity:d.owner});g.onMouseUp=function(h){d.owner.trigger("mouseup",{event:h.nativeEvent,over:e,x:h.stageX,y:h.stageY,entity:d.owner})};g.onMouseMove=function(h){d.owner.trigger("mousemove",{event:h.nativeEvent,over:e,x:h.stageX,y:h.stageY,entity:d.owner})}};this.anim.onMouseOut=function(){e=false};this.anim.onMouseOver=function(){e=true}}if(this.hover){this.stage.enableMouseOver();this.anim.onMouseOut=function(g){e=false;d.owner.trigger("mouseout",{event:g.nativeEvent,over:e,x:g.stageX,y:g.stageY,entity:d.owner})};this.anim.onMouseOver=function(g){e=true;d.owner.trigger("mouseover",{event:g.nativeEvent,over:e,x:g.stageX,y:g.stageY,entity:d.owner})}}};c["layer:render"]=function(d){this.anim.x=this.owner.x;this.anim.y=this.owner.y};c["logical-state"]=function(d){if(this.currentAnimation!=d.state){this.currentAnimation=d.state;this.anim.gotoAndPlay(d.state)}};c.destroy=function(){this.removeListeners(this.listeners)};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["render-image"]=(function(){var b=function(d,e){var g=e.image,f=e.source;this.owner=d;if(e.acceptInput){this.hover=e.acceptInput.hover||false;this.click=e.acceptInput.click||false;this.touch=e.acceptInput.touch||false}else{this.hover=false;this.click=false;this.touch=false}this.listeners=[];this.addListeners(["layer:render-load","layer:render"]);this.stage=undefined;this.image=new createjs.Bitmap(a.assets[g]);if(f){this.image.sourceRect=new createjs.Rectangle(f.x,f.y,f.width,f.height)}this.image.regX=e.regX||0;this.image.regY=e.regY||0;this.image.scaleX=e.scaleX||this.owner.scaleX||1;this.image.scaleY=e.scaleY||this.owner.scaleY||1};var c=b.prototype;c["layer:render-load"]=function(f){var d=this,e=false;this.stage=f.stage;this.stage.addChild(this.image);if(this.click||this.touch){if(this.touch&&createjs.Touch.isSupported()){createjs.Touch.enable(this.stage)}this.anim.onPress=function(g){d.owner.trigger("mousedown",{event:g.nativeEvent,over:e,x:g.stageX,y:g.stageY,entity:d.owner});g.onMouseUp=function(h){d.owner.trigger("mouseup",{event:h.nativeEvent,over:e,x:h.stageX,y:h.stageY,entity:d.owner})};g.onMouseMove=function(h){d.owner.trigger("mousemove",{event:h.nativeEvent,over:e,x:h.stageX,y:h.stageY,entity:d.owner})}};this.anim.onMouseOut=function(){e=false};this.anim.onMouseOver=function(){e=true}}if(this.hover){this.stage.enableMouseOver();this.anim.onMouseOut=function(g){e=false;d.owner.trigger("mouseout",{event:g.nativeEvent,over:e,x:g.stageX,y:g.stageY,entity:d.owner})};this.anim.onMouseOver=function(g){e=true;d.owner.trigger("mouseover",{event:g.nativeEvent,over:e,x:g.stageX,y:g.stageY,entity:d.owner})}}};c["layer:render"]=function(d){this.image.x=this.owner.x;this.image.y=this.owner.y};c.destroy=function(){this.removeListeners(this.listeners)};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["logic-button"]=(function(){var b=function(d,e){this.owner=d;this.listeners=[];this.message={state:e.state||"released"};if(e.toggle){this.toggle=true;this.addListener("mouseup")}else{this.addListeners(["mousedown","mouseup"])}this.addListeners(["layer:logic","pressed","released"])};var c=b.prototype;c.mousedown=c.pressed=function(){this.message.state="pressed"};c.mouseup=function(){if(this.toggle){this.message.state=(this.message.state==="released")?"pressed":"released"}else{this.message.state="released"}};c.released=function(){this.message.state="released"};c["layer:logic"]=function(d){this.owner.trigger("logical-state",this.message)};c.destroy=function(){this.removeListeners(this.listeners)};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["logic-directional-movement"]=(function(){var c=function(e){return function(f){if(f){if(f.pressed){this[e]=true}else{this[e]=false}}else{this[e]=true}}},b=function(e,f){this.owner=e;this.listeners=[];this.addListeners(["layer:logic","go-down","go-south","go-down-left","go-southwest","go-left","go-west","go-up-left","go-northwest","go-up","go-north","go-up-right","go-northeast","go-right","go-east","go-down-right","go-southeast","stop"]);this.owner.state="standing";this.owner.heading="right";this.speed=f.speed||0.3;this.left=false;this.right=false;this.up=false;this.down=false;this.upLeft=false;this.upRight=false;this.downLeft=false;this.downRight=false};var d=b.prototype;d["layer:logic"]=function(h){var g=0,f=0,e=this.upLeft||(this.up&&this.left),l=this.downLeft||(this.down&&this.left),j=this.downRight||(this.down&&this.right),k=this.upRight||(this.up&&this.right);if(this.up&&this.down){this.owner.state="standing"}else{if(this.left&&this.right){this.owner.state="standing"}else{if(e){g=-this.speed/1.414;f=-this.speed/1.414;this.owner.heading="up-left";this.owner.state="walking"}else{if(k){f=-this.speed/1.414;g=this.speed/1.414;this.owner.heading="up-right";this.owner.state="walking"}else{if(l){f=this.speed/1.414;g=-this.speed/1.414;this.owner.heading="down-left";this.owner.state="walking"}else{if(j){f=this.speed/1.414;g=this.speed/1.414;this.owner.heading="down-right";this.owner.state="walking"}else{if(this.left){g=-this.speed;this.owner.heading="left";this.owner.state="walking"}else{if(this.right){g=this.speed;this.owner.heading="right";this.owner.state="walking"}else{if(this.up){f=-this.speed;this.owner.heading="up";this.owner.state="walking"}else{if(this.down){f=this.speed;this.owner.heading="down";this.owner.state="walking"}else{this.owner.state="standing"}}}}}}}}}}this.owner.x+=(g*h);this.owner.y+=(f*h);this.owner.trigger("logical-state",{state:this.owner.state+"-"+this.owner.heading});this.owner.trigger(this.owner.state);if(!h){console.warn("WHAT!?!")}};d["go-down"]=d["go-south"]=c("down");d["go-down-left"]=d["go-southwest"]=c("downLeft");d["go-left"]=d["go-west"]=c("left");d["go-up-left"]=d["go-northwest"]=c("upLeft");d["go-up"]=d["go-north"]=c("up");d["go-up-right"]=d["go-northeast"]=c("upRight");d["go-right"]=d["go-east"]=c("right");d["go-down-right"]=d["go-southeast"]=c("downRight");d.stop=function(e){if(!e||e.pressed){this.down=false;this.downLeft=false;this.left=false;this.upLeft=false;this.up=false;this.upRight=false;this.right=false;this.downRight=false}};d.destroy=function(){this.removeListeners(this.listeners)};d.addListeners=function(f){for(var e in f){this.addListener(f[e])}};d.removeListeners=function(f){for(var e in f){this.removeListener(e,f[e])}};d.addListener=function(f,h){var e=this,g=h||function(j){e[f](j)};this.owner.bind(f,g);this.listeners[f]=g};d.removeListener=function(e,f){this.owner.unbind(e,f)};return b})();a.components["logic-gravity"]=(function(){var b=function(d,f){this.owner=d;var e=this;this.listeners=[];this.addListeners(["layer:logic"]);this.vX=f.velocityX||0;this.vY=f.velocityY||0;this.maxVX=f.maxVelocityX||f.maxVelocity||3;this.maxVY=f.maxVelocityY||f.maxVelocity||3;this.yGravity=f.gravity||f.yGravity||0.01;this.xGravity=f.xGravity||0;this.owner.resolveTileCollision=function(g,h){return e.resolveTileCollision(g,h)};this.owner.resolveSolidCollision=function(g,h){return e.resolveSolidCollision(g,h)};this.owner.resolveSoftCollision=function(g){return e.resolveSoftCollision(g)}};var c=b.prototype;c["layer:logic"]=function(d){this.vY+=this.yGravity*d;if(this.vY>this.maxVY){this.vY=this.maxVY}this.vX+=this.xGravity*d;if(this.vX>this.maxVX){this.vX=this.maxVX}this.owner.x+=(this.vX*d);this.owner.y+=(this.vY*d)};c.resolveSolidCollision=c.resolveTileCollision=function(d,e){if(((d=="down")&&(this.vY>0))||((d=="up")&&(this.vY<0))){this.vY=0}else{if(((d=="left")&&(this.vX<0))||((d=="right")&&(this.vX>0))){this.vX=0}}return true};c.resolveSoftCollision=function(d){return false};c.destroy=function(){this.removeListeners(this.listeners)};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["logic-hero"]=(function(){var b=function(d,f){this.owner=d;var e=this;this.listeners=[];this.addListeners(["layer:logic","key-left","key-right","key-up","key-down","key-jump"]);this.owner.state=this.owner.state||"ground";this.owner.heading=this.owner.heading||"right";this.left=false;this.right=false;this.up=false;this.down=false;this.jump=false;this.vX=0;this.vY=0;this.aX=0.25;this.fX=0.4;this.maxVX=2;this.maxVY=3;this.jumpV=4;this.aGravity=0.01;this.owner.resolveTileCollision=function(g,h){return e.resolveTileCollision(g,h)};this.owner.resolveSolidCollision=function(g,h){return e.resolveSolidCollision(g,h)};this.owner.resolveSoftCollision=function(g){return e.resolveSoftCollision(g)}};var c=b.prototype;c["layer:logic"]=function(d){if(this.left){this.vX-=this.aX*d;if(this.vX<-this.maxVX){this.vX=-this.maxVX}this.owner.heading="left"}else{if(this.right){this.vX+=this.aX*d;if(this.vX>this.maxVX){this.vX=this.maxVX}this.owner.heading="right"}else{if(this.vX>0){this.vX-=this.fX*d;if(this.vX<0){this.vX=0}}else{if(this.vX<0){this.vX+=this.fX*d;if(this.vX>0){this.vX=0}}}}}if(this.jump&&this.owner.state!="air"){this.vY=-this.jumpV;this.owner.state="air";this.owner.trigger("jumping")}if(this.owner.state=="air"){this.vY+=this.aGravity*d;if(this.vY>this.maxVY){this.vY=this.maxVY}}else{if(this.owner.state=="ground"){this.vY+=this.aGravity*d}}this.owner.x+=(this.vX*d);this.owner.y+=(this.vY*d);this.left=false;this.right=false;this.up=false;this.down=false;this.jump=false;if(this.owner.state=="ground"){if(this.vX==0){this.owner.trigger("logical-state",{state:"standing-"+this.owner.heading})}else{this.owner.trigger("logical-state",{state:"walking-"+this.owner.heading});this.owner.trigger("walking")}}else{if(this.owner.state=="air"){this.owner.trigger("logical-state",{state:"jumping-"+this.owner.heading})}}};c["key-left"]=function(d){if(d.pressed){this.left=true}};c["key-right"]=function(d){if(d.pressed){this.right=true}};c["key-up"]=function(d){if(d.pressed){this.up=true}};c["key-down"]=function(d){if(d.pressed){this.down=true}};c["key-jump"]=function(d){if(d.pressed){this.jump=true}};c.resolveTileCollision=function(d,e){switch(d){case"down":this.owner.state="ground";break;case"up":this.vY=0;break}return true};c.resolveSolidCollision=function(d,e){switch(d){case"down":if(this.owner.state=="ground"){this.vY=0}else{if(this.owner.state=="air"){this.owner.state="ground";this.vY=0}}break}return true};c.resolveSoftCollision=function(d){return false};c.destroy=function(){this.removeListeners(this.listeners)};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["collision-hero"]=(function(){var b=function(d,f){var e=this;this.owner=d;this.listeners=[];this.addListeners(["load","layer:prep-collision","layer:resolve-collision","layer:resolve-solid-collision","layer:relocate"]);this.owner.shape=new a.classes.collisionShape([this.owner.x,this.owner.y],f.shape.type,f.shape.points,f.shape.offset,f.shape.radius);this.owner.getAABB=function(){return e.getAABB()};this.owner.routeTileCollision=function(h,g,j){return e.routeTileCollision(h,g,j)};this.owner.routeSolidCollision=function(h,g,j){return e.routeSolidCollision(h,g,j)};this.owner.routeSoftCollision=function(g){return e.routeSoftCollision(g)};this.owner.collisionType=f.collisionType||"solid";this.owner.collidesWith=f.collidesWith||[]};var c=b.prototype;c.load=function(d){};c["layer:prep-collision"]=function(){this.owner.shape.update(this.owner.x,this.owner.y)};c["layer:relocate"]=function(d){this.owner.x=d[0]-this.owner.shape.getXOffset();this.owner.y=d[1]-this.owner.shape.getYOffset();this.owner.shape.setXY(d[0],d[1])};c.getAABB=function(){return this.owner.shape.getAABB()};c.routeTileCollision=function(e,d,f){if(this.owner.resolveTileCollision){if(e=="x"&&d>0){return this.owner.resolveTileCollision("right",f)}else{if(e=="x"&&d<0){return this.owner.resolveTileCollision("left",f)}else{if(e=="y"&&d>0){return this.owner.resolveTileCollision("down",f)}else{if(e=="y"&&d<0){return this.owner.resolveTileCollision("up",f)}}}}}return false};c.routeSolidCollision=function(e,d,f){if(this.owner.resolveSolidCollision){if(e=="x"&&d>0){return this.owner.resolveSolidCollision("right",f)}else{if(e=="x"&&d<0){return this.owner.resolveSolidCollision("left",f)}else{if(e=="y"&&d>0){return this.owner.resolveSolidCollision("down",f)}else{if(e=="y"&&d<0){return this.owner.resolveSolidCollision("up",f)}}}}}return false};c.routeSoftCollision=function(d){if(this.owner.resolveSoftCollision){this.owner.resolveSoftCollision(d)}};c.destroy=function(){this.removeListeners(this.listeners)};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["collision-tiles"]=(function(){var b=function(d,f){var e=this;this.owner=d;this.collisionMap=f.collisionMap||[];this.tileWidth=f.tileWidth||this.owner.tileWidth||10;this.tileHeight=f.tileHeight||this.owner.tileHeight||10;this.tileHalfWidth=this.tileWidth/2;this.tileHalfHeight=this.tileHeight/2;this.listeners=[];this.addListeners(["layer:prep-collision"]);this.owner.collisionType=f.collisionType||"solid";this.owner.collidesWith=f.collidesWith||[];this.owner.getTiles=function(g){return e.getTiles(g)};this.owner.getAABB=function(){return e.getAABB()};this.owner.isTile=function(g,h){return e.isTile(g,h)}};var c=b.prototype;c["layer:prep-collision"]=function(){};c.getAABB=function(){return{left:0,top:0,right:this.tileWidth*this.collisionMap.length,bottom:this.tileHeight*this.collisionMap.length[0]}};c.isTile=function(d,e){if(d>=0&&d<this.collisionMap.length&&e>=0&&e<this.collisionMap[0].length&&this.collisionMap[d][e]!=-1){return true}else{return false}};c.getTiles=function(e){var k=Math.max(Math.floor(e.left/this.tileWidth),0),j=Math.max(Math.floor(e.top/this.tileHeight),0),h=Math.min(Math.ceil(e.right/this.tileWidth),this.collisionMap.length),g=Math.min(Math.ceil(e.bottom/this.tileHeight),this.collisionMap[0].length),d=0,l=0,f=[];for(d=k;d<h;d++){for(l=j;l<g;l++){if(this.collisionMap[d][l]!=-1){f.push({gridX:d,gridY:l,shape:new a.classes.collisionShape([d*this.tileWidth+this.tileHalfWidth,l*this.tileHeight+this.tileHalfHeight],"rectangle",[[-this.tileHalfWidth,-this.tileHalfHeight],[this.tileHalfWidth,this.tileHalfHeight]])})}}}return f};c.destroy=function(){this.removeListeners(this.listeners)};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();(function(){var f=navigator.userAgent.toLowerCase(),n=document.createElement("audio"),q={canvas:false,touch:!!("ontouchstart" in window),iPod:(f.search("ipod")>-1),iPhone:(f.search("iphone")>-1),iPad:(f.search("ipad")>-1),safari:(f.search("safari")>-1),ie:(f.search("msie")>-1),firefox:(f.search("firefox")>-1),android:(f.search("android")>-1),silk:(f.search("silk")>-1),iOS:false,mobile:false,desktop:false,multitouch:false,ogg:true,m4a:true,mp3:true},p=a.settings.aspects,b={},m=0,l=0,h=0,d=false,g="";q.iOS=q.iPod||q.iPhone||q.iPad;q.mobile=q.iOS||q.android||q.silk;q.desktop=!q.mobile;if(q.touch){if(q.android){if(parseInt(f.slice(f.indexOf("android")+8))>2){q.multitouch=true}}else{q.multitouch=true}}if((n.canPlayType)&&!(!!n.canPlayType&&""!=n.canPlayType('audio/ogg; codecs="vorbis"'))){q.ogg=false;if(q.ie||!(!!n.canPlayType&&""!=n.canPlayType("audio/mp4"))){q.m4a=false}}var c=document.createElement("canvas");try{q.canvas=!!(c.getContext("2d"))}catch(o){q.canvas=!!(c.getContext)}delete c;a.settings.aspects=b;a.settings.aspects={};for(m in p){d=false;g="";for(l in p[m]){g+=" "+l;for(h in p[m][l]){if(f.search(p[m][l][h])>-1){a.settings.aspects[l]=true;d=true;break}}if(d){break}}if(!d){console.warn("This browser doesn't support any of the following: "+g)}}a.settings.supports=q})();this.createjs=this.createjs||{};(function(){function f(){this.init()}var c=f;c.MAX_INSTANCES=30;c.capabilities=null;c.lastId=0;c.AUDIO_READY="canplaythrough";c.AUDIO_ENDED="ended";c.AUDIO_ERROR="error";c.AUDIO_STALLED="stalled";c.fillChannels=false;c.isSupported=function(){c.generateCapabilities();var g=c.tag;if(g==null){return false}return true};c.generateCapabilities=function(){if(c.capabilities!=null){return}var g=c.tag=document.createElement("audio");if(g.canPlayType==null){return null}var h=c.capabilities={panning:false,volume:true,mp4:g.canPlayType("audio/mp4")!="no"&&g.canPlayType("audio/mp4")!="",channels:c.MAX_INSTANCES}};var e=c.prototype={capabilities:null,FT:0.001,channels:null,init:function(){this.capabilities=c.capabilities;this.channels={}},register:function(n,m){var k=b.get(n);var g;for(var j=0,h=m||1;j<h;j++){g=this.createTag(n);k.add(g)}return{tag:g}},createTag:function(h){var g=document.createElement("audio");g.preload=false;g.src=h;return g},create:function(h){var g=new d(h);g.owner=this;return g},toString:function(){return"[HTMLiOSAudioPlugin]"}};createjs.HTMLiOSAudioPlugin=f;function d(g){this.init(g)}var e=d.prototype={src:null,uniqueId:-1,playState:null,owner:null,loaded:false,lastInterrupt:createjs.SoundJS.INTERRUPT_NONE,offset:0,delay:0,volume:1,pan:0,remainingLoops:0,delayTimeout:-1,tag:null,muted:false,paused:false,onComplete:null,onLoop:null,onReady:null,onPlayFailed:null,onPlayInterrupted:null,endedHandler:null,readyHandler:null,stalledHandler:null,init:function(g){this.uniqueId=createjs.HTMLiOSAudioPlugin.lastId++;this.src=g;this.endedHandler=createjs.SoundJS.proxy(this.handleSoundComplete,this);this.readyHandler=createjs.SoundJS.proxy(this.handleSoundReady,this);this.stalledHandler=createjs.SoundJS.proxy(this.handleSoundStalled,this)},cleanUp:function(){var g=this.tag;if(g!=null){g.pause();try{g.currentTime=0}catch(h){}g.removeEventListener(createjs.HTMLiOSAudioPlugin.AUDIO_ENDED,this.endedHandler,false);g.removeEventListener(createjs.HTMLiOSAudioPlugin.AUDIO_READY,this.readyHandler,false);b.setInstance(this.src,g);this.tag=null}if(window.createjs==null){return}createjs.SoundJS.playFinished(this)},interrupt:function(){if(this.tag==null){return}this.playState=createjs.SoundJS.PLAY_INTERRUPTED;if(this.onPlayInterrupted){this.onPlayInterrupted(this)}this.cleanUp();this.paused=false},play:function(m,h,l,g,j,k){this.cleanUp();createjs.SoundJS.playInstance(this,m,h,l,g,j,k)},beginPlaying:function(l,h,j,k){if(window.createjs==null){return}var g=this.tag=b.getInstance(this.src);if(g==null){this.playFailed();return -1}g.addEventListener(createjs.HTMLiOSAudioPlugin.AUDIO_ENDED,this.endedHandler,false);this.offset=l;this.volume=j;this.updateVolume();this.remainingLoops=h;if(g.readyState!==4){g.addEventListener(createjs.HTMLiOSAudioPlugin.AUDIO_READY,this.readyHandler,false);g.addEventListener(createjs.HTMLiOSAudioPlugin.AUDIO_STALLED,this.stalledHandler,false);g.load()}else{this.handleSoundReady(null)}return 1},handleSoundStalled:function(g){if(this.onPlayFailed!=null){this.onPlayFailed(this)}this.cleanUp()},handleSoundReady:function(g){if(window.createjs==null){return}this.playState=createjs.SoundJS.PLAY_SUCCEEDED;this.paused=false;this.tag.removeEventListener(createjs.HTMLiOSAudioPlugin.AUDIO_READY,this.readyHandler,false);if(this.offset>=this.getDuration()){this.playFailed();return}else{if(this.offset>0){this.tag.currentTime=this.offset*0.001}}if(this.remainingLoops==-1){this.tag.loop=true}this.tag.play()},pause:function(){this.paused=true;if(this.tag!=null){this.tag.pause();return false}return true},resume:function(){this.paused=false;if(this.tag!=null){this.tag.play();return false}return true},stop:function(){this.pause();this.playState=createjs.SoundJS.PLAY_FINISHED;this.cleanUp();return true},setMasterVolume:function(g){this.updateVolume();return true},setVolume:function(g){this.volume=g;this.updateVolume();return true},updateVolume:function(){if(this.tag!=null){this.tag.volume=this.muted?0:this.volume*createjs.SoundJS.masterVolume;return true}else{return false}},getVolume:function(g){return this.volume},mute:function(g){this.muted=g;this.updateVolume();return true},setPan:function(g){return false},getPan:function(){return 0},getPosition:function(){if(this.tag==null){return 0}return this.tag.currentTime*1000},setPosition:function(h){if(this.tag==null){return false}try{this.tag.currentTime=h*0.001}catch(g){return false}return true},getDuration:function(){if(this.tag==null){return 0}return this.tag.duration*1000},handleSoundComplete:function(g){if(this.remainingLoops!=0){this.remainingLoops--;this.tag.play();if(this.onLoop!=null){this.onLoop(this)}return}if(window.createjs==null){return}this.playState=createjs.SoundJS.PLAY_FINISHED;if(this.onComplete!=null){this.onComplete(this)}this.cleanUp()},playFailed:function(){if(window.createjs==null){return}this.playState=createjs.SoundJS.PLAY_FAILED;if(this.onPlayFailed!=null){this.onPlayFailed(this)}this.cleanUp()},toString:function(){return"[HTMLiOSAudioPlugin SoundInstance]"}};function b(g){this.init(g)}b.channels={};b.get=function(h){var g=b.channels[h];if(g==null){g=b.channels[h]=new b(h)}return g};b.getInstance=function(h){var g=b.channels[h];if(g==null){return null}return g.get()};b.setInstance=function(j,g){var h=b.channels[j];if(h==null){return null}return h.set(g)};b.prototype={src:null,length:0,available:0,tags:null,init:function(g){this.src=g;this.tags=[]},add:function(g){this.tags.push(g);this.length++;this.available=this.tags.length},get:function(){if(this.tags.length==0){return null}this.available=this.tags.length;var g=this.tags.pop();if(!g.parentNode){document.body.appendChild(g)}return g},set:function(g){var h=this.tags.indexOf(g);if(h==-1){this.tags.push(g)}this.available=this.tags.length},toString:function(){return"[HTMLiOSAudioPlugin TagChannel]"}}}());this.createjs=this.createjs||{};(function(){function e(){throw"SoundJS cannot be instantiated"}var d=e;d.DELIMITER="|";d.AUDIO_TIMEOUT=8000;d.INTERRUPT_ANY="any";d.INTERRUPT_EARLY="early";d.INTERRUPT_LATE="late";d.INTERRUPT_NONE="none";d.PLAY_INITED="playInited";d.PLAY_SUCCEEDED="playSucceeded";d.PLAY_INTERRUPTED="playInterrupted";d.PLAY_FINISHED="playFinished";d.PLAY_FAILED="playFailed";d.activePlugin=null;d.muted=false;d.pluginsRegistered=false;d.masterVolume=1;d.instances=[];d.instanceHash={};d.idHash=null;d.defaultSoundInstance=null;d.getPreloadHandlers=function(){return{callback:d.proxy(d.initLoad,d),types:["sound"],extensions:["mp3","m4a","ogg","wav"]}};d.registerPlugins=function(j){d.pluginsRegistered=true;for(var k=0,h=j.length;k<h;k++){var m=j[k];if(m==null){continue}if(m.isSupported()){d.activePlugin=new m();return true}}return false};d.registerPlugin=function(h){d.pluginsRegistered=true;if(h==null){return false}if(h.isSupported()){d.activePlugin=new h();return true}return false};d.isReady=function(){return(d.activePlugin!=null)};d.getCapabilities=function(){if(d.activePlugin==null){return null}return d.activePlugin.capabilities};d.getCapability=function(h){if(d.activePlugin==null){return null}return d.activePlugin.capabilities[h]};d.initLoad=function(n,l,o,m){if(!d.checkPlugin(true)){return false}var k=d.parsePath(n,l,o,m);if(k==null){return false}if(o!=null){if(d.idHash==null){d.idHash={}}d.idHash[o]=k.src}var j=c.create(k.src,m);var h=d.activePlugin.register(k.src,m);if(h!=null){if(h.tag!=null){k.tag=h.tag}else{if(h.src){k.src=h.src}}if(h.completeHandler!=null){k.handler=h.completeHandler}}return k};d.parsePath=function(u,s,j,p){var m=u.split(d.DELIMITER);var q={type:s||"sound",id:j,data:p,handler:d.handleSoundReady};var w=false;var r=d.getCapabilities();for(var o=0,n=m.length;o<n;o++){var v=m[o];var t=v.lastIndexOf(".");var k=v.substr(t+1).toLowerCase();var h=v.substr(0,t).split("/").pop();switch(k){case"mp3":if(r.mp3){w=true}break;case"m4a":if(r.mp4){w=true}break;case"ogg":if(r.ogg){w=true}break;case"wav":if(r.wav){w=true}break}if(w){q.name=h;q.src=v;q.extension=k;return q}}return null};d.play=function(h,k,l,j,n,m,q){if(!d.checkPlugin(true)){return d.defaultSoundInstance}h=d.getSrcFromId(h);var r=d.activePlugin.create(h);try{r.mute(d.muted)}catch(o){}var p=d.playInstance(r,k,l,j,n,m,q);if(!p){r.playFailed()}return r};d.playInstance=function(h,p,k,o,j,m,n){p=p||d.INTERRUPT_NONE;if(k==null){k=0}if(o==null){o=0}if(j==null){j=0}if(m==null){m=1}if(n==null){n=0}if(k==0){var l=d.beginPlaying(h,p,o,j,m,n);if(!l){return false}}else{setTimeout(function(){d.beginPlaying(h,p,o,j,m,n)},k)}this.instances.push(h);this.instanceHash[h.uniqueId]=h;return true};d.beginPlaying=function(j,p,o,k,m,n){if(!c.add(j,p)){return false}var h=j.beginPlaying(o,k,m,n);if(!h){var l=this.instances.indexOf(j);if(l>-1){this.instances.splice(l,1)}delete this.instanceHash[j.uniqueId];return false}return true};d.checkPlugin=function(h){if(d.activePlugin==null){if(h&&!d.pluginsRegistered){d.registerPlugin(createjs.HTMLAudioPlugin)}if(d.activePlugin==null){return false}}return true};d.getSrcFromId=function(h){if(d.idHash==null||d.idHash[h]==null){return h}return d.idHash[h]};d.setVolume=function(h,j){if(Number(h)==null){return false}h=Math.max(0,Math.min(1,h));return d.tellAllInstances("setVolume",j,h)};d.getMasterVolume=function(){return d.masterVolume};d.setMasterVolume=function(h){d.masterVolume=h;return d.tellAllInstances("setMasterVolume",null,h)};d.setMute=function(h){this.muted=h;return d.tellAllInstances("mute",null,h)};d.pause=function(h){return d.tellAllInstances("pause",h)};d.resume=function(h){return d.tellAllInstances("resume",h)};d.stop=function(h){return d.tellAllInstances("stop",h)};d.getInstanceById=function(h){return this.instanceHash[h]};d.playFinished=function(h){c.remove(h);var j=this.instances.indexOf(h);if(j>-1){this.instances.splice(j,1)}};d.tellAllInstances=function(m,n,k){if(this.activePlugin==null){return false}var l=this.getSrcFromId(n);for(var j=this.instances.length-1;j>=0;j--){var h=this.instances[j];if(l!=null&&h.src!=l){continue}switch(m){case"pause":h.pause();break;case"resume":h.resume();break;case"setVolume":h.setVolume(k);break;case"setMasterVolume":h.setMasterVolume(k);break;case"mute":h.mute(k);break;case"stop":h.stop();break;case"setPan":h.setPan(k);break}}return true};d.proxy=function(j,h){return function(){return j.apply(h,arguments)}};createjs.SoundJS=e;function c(j,h){this.init(j,h)}c.channels={};c.create=function(k,h){var j=c.get(k);if(j==null){c.channels[k]=new c(k,h)}else{j.max+=h}};c.add=function(h,k){var j=c.get(h.src);if(j==null){return false}return j.add(h,k)};c.remove=function(h){var j=c.get(h.src);if(j==null){return false}j.remove(h);return true};c.get=function(h){return c.channels[h]};var g=c.prototype={src:null,max:null,length:0,init:function(j,h){this.src=j;this.max=h||1;this.instances=[]},get:function(h){return this.instances[h]},add:function(h,j){if(!this.getSlot(j,h)){return false}this.instances.push(h);this.length++;return true},remove:function(h){var j=this.instances.indexOf(h);if(j==-1){return false}this.instances.splice(j,1);this.length--;return true},getSlot:function(p,h){var o,m;var n=e.activePlugin.FT||0;for(var k=0,j=this.max||100;k<j;k++){o=this.get(k);if(o==null){return true}else{if(p==e.INTERRUPT_NONE){continue}}if(k==0){m=o;continue}if(o.playState==e.PLAY_FINISHED||o==e.PLAY_INTERRUPTED||o==e.PLAY_FAILED){m=o}else{if((p==e.INTERRUPT_EARLY&&o.getPosition()<m.getPosition())||(p==e.INTERRUPT_LATE&&o.getPosition()>m.getPosition())){m=o}}}if(m!=null){m.interrupt();this.remove(m);return true}return false},toString:function(){return"[SoundJS SoundChannel]"}};function f(){this.isDefault=true;this.pause=this.resume=this.play=this.beginPlaying=this.cleanUp=this.interrupt=this.stop=this.setMasterVolume=this.setVolume=this.mute=this.setPan=this.getPosition=this.setPosition=this.playFailed=function(){return false};this.getVolume=this.getPan=this.getDuration=function(){return 0};this.playState=e.PLAY_FAILED;this.toString=function(){return"[SoundJS Default Sound Instance]"}}e.defaultSoundInstance=new f();function b(){}b.init=function(){var h=navigator.userAgent;b.isFirefox=(h.indexOf("Firefox")>-1);b.isOpera=(window.opera!=null);b.isIOS=h.indexOf("iPod")>-1||h.indexOf("iPhone")>-1||h.indexOf("iPad")>-1};b.init();createjs.SoundJS.BrowserDetect=b}());window.addEventListener("load",function(){var f=function(h,k){var g=0,j=false;for(g in k){if(k[g].id===h.id){j=true;break}}if(!j){k.push(h)}},b=new createjs.PreloadJS(),e=[];b.onProgress=function(g){console.log("Progress:",g)};b.onFileLoad=function(m){var l=0,h=0,n=m.data,g=m.result,k=undefined;console.log("Load:",m);if((m.type=="image")&&n){if(n.rows&&n.columns){k=new createjs.SpriteSheet({images:[g],frames:{width:g.width/n.columns,height:g.height/n.rows}});for(h=0;h<n.rows;h++){for(l=0;l<n.columns;l++){if(n.ids&&n.ids[l]&&n.ids[l][h]){a.assets[n.ids[l][h]]=createjs.SpriteSheetUtils.extractFrame(k,+h+(l*n.rows))}else{a.assets[m.id+"-"+l+"_"+h]=createjs.SpriteSheetUtils.extractFrame(k,+h+(l*n.rows))}}}return}}a.assets[m.id]=g};b.onError=function(g){console.log("Your stuff broke!")};b.onComplete=function(g){a.game=new a.classes.game(a.settings);createjs.Ticker.setFPS(a.settings.global.fps);createjs.Ticker.addListener(a.game)};for(var d in a.settings.assets){if(typeof a.settings.assets[d].src==="string"){f(a.settings.assets[d],e)}else{for(var c in a.settings.assets[d].src){if(a.settings.aspects[c]&&a.settings.assets[d].src[c]){if(typeof a.settings.assets[d].src[c]==="string"){a.settings.assets[d].src=a.settings.assets[d].src[c];f(a.settings.assets[d],e)}else{a.settings.assets[d].data=a.settings.assets[d].src[c].data||a.settings.assets[d].data;a.settings.assets[d].assetId=a.settings.assets[d].src[c].assetId;a.settings.assets[d].src=a.settings.assets[d].src[c].src;f({id:a.settings.assets[d].assetId||a.settings.assets[d].id,src:a.settings.assets[d].src},e)}break}}if(typeof a.settings.assets[d].src!=="string"){if(a.settings.assets[d].src["default"]){if(typeof a.settings.assets[d].src["default"]==="string"){a.settings.assets[d].src=a.settings.assets[d].src["default"];f(a.settings.assets[d],e)}else{a.settings.assets[d].data=a.settings.assets[d].src["default"].data||a.settings.assets[d].data;a.settings.assets[d].assetId=a.settings.assets[d].src["default"].assetId;a.settings.assets[d].src=a.settings.assets[d].src["default"].src;f({id:a.settings.assets[d].assetId||a.settings.assets[d].id,src:a.settings.assets[d].src},e)}}else{console.warn("Asset has no valid source for this browser.",a.settings.assets[d])}}}}if(a.settings.supports.android){createjs.SoundJS.registerPlugin(createjs.HTMLiOSAudioPlugin)}else{createjs.SoundJS.registerPlugins([createjs.HTMLAudioPlugin,createjs.HTMLiOSAudioPlugin])}b.installPlugin(createjs.SoundJS);b.loadManifest(e);a.assets=[]},false)})();