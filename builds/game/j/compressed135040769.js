(function(){var a={};PBS=this.PBS||{};PBS.KIDS=this.PBS.KIDS||{};PBS.KIDS.platformer=a;a.settings={global:{initialScene:"scene-1",fps:60,rootElement:"root",aspectRatio:1.333},aspects:[{ogg:["firefox","chrome","opera"],m4a:["ipod","ipad","iphone","android"],mp3:["msie","safari"]}],assets:[{id:"powerup",src:{ogg:"a/powerup.ogg",mp3:"a/powerup.mp3",m4a:"a/powerup.mp3"}},{id:"walk",src:{ogg:"a/walk.ogg",mp3:"a/walk.mp3",m4a:"a/walk.mp3"}},{id:"jump",src:{ogg:"a/jump.ogg",mp3:"a/jump.mp3",m4a:"a/jump.mp3"}},{id:"alpha",src:"i/test.png",data:{rows:2,columns:2,ids:[["horizon","sky"],["ground","rock"]]}},{id:"buttons",src:"i/buttons.png"},{id:"mookie-walk",src:"i/mookie.png"},{id:"tilemap",src:"i/tile-map.png"},{id:"test",src:"i/test.png"},{id:"test-animation",src:"i/test-animation.png"},{id:"tiles",src:"i/tiles.png"},{id:"objects",src:"i/objects.png"}],classes:{Game:{id:"Game",src:"../src/js/game.js"},Entity:{id:"Entity",src:"../src/js/entity.js"},Layer:{id:"Layer",src:"../src/js/layer.js"},Scene:{id:"Scene",src:"../src/js/scene.js"},"Collision-Shape":{id:"Collision-Shape",src:"../src/js/collision-shape.js"},AABB:{id:"AABB",src:"../src/js/aabb.js"}},components:{"layer-controller":{id:"layer-controller",src:"../src/js/layer/layer-controller.js"},"tiled-loader":{id:"tiled-loader",src:"../src/js/layer/tiled-loader.js"},"lc-render":{id:"lc-render",src:"../src/js/layer/lc-render.js"},"lc-logic":{id:"lc-logic",src:"../src/js/layer/lc-logic.js"},"lc-camera":{id:"lc-camera",src:"../src/js/layer/lc-camera.js"},"lc-basic-collision":{id:"lc-basic-collision",src:"../src/js/layer/lc-basic-collision.js"},audio:{id:"audio",src:"../src/js/entity/audio.js"},"broadcast-events":{id:"broadcast-events",src:"../src/js/entity/broadcast-events.js"},"entity-container":{id:"entity-container",src:"../src/js/entity/entity-container.js"},"entity-controller":{id:"entity-controller",src:"../src/js/entity/entity-controller.js"},"render-debug":{id:"render-debug",src:"../src/js/entity/render-debug.js"},"render-tile":{id:"render-tile",src:"../src/js/entity/render-tile.js"},"render-tiles":{id:"render-tiles",src:"../src/js/entity/render-tiles.js"},"render-button":{id:"render-button",src:"../src/js/entity/render-button.js"},"render-animation":{id:"render-animation",src:"../src/js/entity/render-animation.js"},"logic-directional-movement":{id:"logic-directional-movement",src:"../src/js/entity/logic-directional-movement.js"},"collision-hero":{id:"collision-hero",src:"../src/js/entity/collision-hero.js"},"collision-tiles":{id:"collision-tiles",src:"../src/js/entity/collision-tiles.js"}},entities:{tile:{id:"tile",components:[{type:"render-tile",spritesheet:"import"}]},"tile-layer":{id:"tile-layer",components:[{type:"render-tiles",spritesheet:"import",imageMap:"import"},{type:"collision-tiles",collisionMap:"import"}]},"render-layer":{id:"render-layer",components:[{type:"render-tiles",spritesheet:"import",imageMap:"import"}],properties:{}},"collision-layer":{id:"collision-layer",components:[{type:"collision-tiles",collisionMap:"import"}]},"button-left":{id:"button-left",components:[{type:"entity-controller",controlMap:{"mouse:left-button":"pressed"}},{type:"broadcast-events",events:{pressed:"button-left"}},{type:"render-animation",spriteSheet:{images:["buttons"],frames:{width:46,height:46},animations:{"default":0}},state:"default",acceptInput:{click:true,touch:true}}],properties:{"debug-events":["button-left"],state:false,x:17,y:177,width:46,height:46}},"button-right":{id:"button-right",components:[{type:"entity-controller",controlMap:{"mouse:left-button":"pressed"}},{type:"broadcast-events",events:{pressed:"button-right"}},{type:"render-animation",spriteSheet:{images:["buttons"],frames:{width:46,height:46},animations:{"default":1}},state:"default",acceptInput:{click:true,touch:true}}],properties:{"debug-events":["button-right"],state:false,x:257,y:177,width:46,height:46}},hero:{id:"hero",components:[{type:"entity-controller",controlMap:{"key:w":"go-up","key:up-arrow":"go-up","key:a":"go-left","key:left-arrow":"go-left","button-left":"go-left","key:s":"go-down","key:down-arrow":"go-down","key:d":"go-right","key:right-arrow":"go-right","button-right":"go-right","key:q":"go-up-left","key:e":"go-up-right","key:z":"go-down-left","key:c":"go-down-right"}},{type:"logic-directional-movement",speed:1},{type:"collision-hero",shape:{offset:[0,-120],type:"rectangle",points:[[-80,-120],[80,120]]},collisionType:"hero",collidesWith:["solid"]},{type:"render-animation",spriteSheet:{images:["mookie-walk"],frames:{width:26,height:27,regY:26,regX:13},animations:{"standing-up":[2],"standing-up-right":[2],"standing-right":[2],"standing-down-right":[2],"standing-down":[5],"standing-down-left":[5],"standing-left":[5],"standing-up-left":[5],"walking-up":{frames:[0,1,2,3],frequency:4},"walking-up-right":{frames:[0,1,2,3],frequency:4},"walking-right":{frames:[0,1,2,3],frequency:4},"walking-down-right":{frames:[0,1,2,3],frequency:4},"walking-down":{frames:[7,6,5,4],frequency:4},"walking-down-left":{frames:[7,6,5,4],frequency:4},"walking-left":{frames:[7,6,5,4],frequency:4},"walking-up-left":{frames:[7,6,5,4],frequency:4}}}},{type:"audio",audioMap:{walking:{sound:"walk",interrupt:"none"},jumping:"jump"}}],properties:{x:100,y:100,width:160,height:240,state:"standing",heading:"left",camera:"locked"}},block:{id:"block",components:[{type:"collision-hero",shape:{offset:[0,-120],type:"rectangle",points:[[-120,-120],[120,120]]},collisionType:"solid"},{type:"render-animation",spriteSheet:{images:["tilemap"],frames:{width:24,height:24,regX:12,regY:24},animations:{tile:9}},state:"tile"}],properties:{x:50,y:50,width:240,height:240}}},includes:{EaselJS:{id:"EaselJS",src:"http://code.createjs.com/easeljs-0.5.0.min.js"},TweenJS:{id:"TweenJS",src:"http://code.createjs.com/tweenjs-0.3.0.min.js"},SoundJS:{id:"SoundJS",src:"http://code.createjs.com/soundjs-0.3.0.min.js"},PreloadJS:{id:"PreloadJS",src:"http://code.createjs.com/preloadjs-0.2.0.min.js"},Browser:{id:"Browser",src:"../src/js/browser.js"},Main:{id:"Main",src:"../src/js/main.js"},MainCSS:{id:"MainCSS",src:"../src/css/main.css"},GameCSS:{id:"GameCSS",src:"../src/css/game.css"}},scenes:{"scene-menu":{layers:[{id:"buttons",components:[{type:"lc-logic"},{type:"lc-render"},{type:"layer-controller"},{type:"entity-container",entities:[{type:"button"}]}]}],id:"scene-menu"},"scene-1":{layers:[{id:"action",components:[{type:"lc-camera",width:3200},{type:"lc-logic"},{type:"lc-basic-collision"},{type:"lc-render"},{type:"layer-controller"},{type:"entity-container"},{type:"tiled-loader",level:"level-1",unitsPerPixel:10}]},{id:"interface",components:[{type:"lc-camera",width:320},{type:"lc-logic"},{type:"lc-render"},{type:"layer-controller"},{type:"entity-container",entities:[{type:"button-left"},{type:"button-right"}]}]}],id:"scene-1"},"scene-2":{layers:[{id:"action",components:[{type:"lc-camera",width:320},{type:"lc-logic"},{type:"lc-basic-collision"},{type:"lc-render"},{type:"layer-controller"},{type:"entity-container"},{type:"tiled-loader",level:"level-2"}]},{id:"interface",components:[{type:"lc-camera",width:320},{type:"lc-logic"},{type:"lc-render"},{type:"layer-controller"},{type:"entity-container",entities:[{type:"button-left"},{type:"button-right"}]}]}],id:"scene-2"}},levels:{"level-1":{height:20,layers:[{data:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20],height:20,name:"background",opacity:1,properties:{entity:"render-layer"},type:"tilelayer",visible:true,width:20,x:0,y:0},{data:[17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,23,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,21,23,0,0,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,0,21,23,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,21,23,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,21,23,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,21,22,16,16,16,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,21,23,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,21,23,0,15,16,16,16,16,16,17,0,15,17,0,0,15,16,16,16,16,22,23,0,0,0,0,0,0,0,0,0,0,23,0,0,0,0,0,0,0,21,23,0,0,0,0,0,0,0,0,0,0,22,17,0,0,0,0,0,0,21,23,0,0,0,0,0,0,0,0,0,0,0,22,17,0,0,0,0,0,21,22,16,16,16,17,0,0,0,0,0,0,0,0,22,16,16,16,17,0,21,23,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,21,5,0,0,0,0,0,0,9,9,0,0,0,0,0,0,0,0,0,0,21,23,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,21,5,0,0,0,0,0,3,3,15,17,3,3,3,0,0,0,0,0,0,4,5,0,0,0,0,0,3,3,21,23,9,9,9,17,0,0,0,0,0,4,23,0,0,0,0,0,3,3,21,23,9,9,15,22,17,9,9,9,9,21,22,16,16,16,16,16,16,16,22,22,16,16,22,22,22,16,16,16,16,22],height:20,name:"action",opacity:1,properties:{entity:"tile-layer"},type:"tilelayer",visible:true,width:20,x:0,y:0},{height:20,name:"guys",objects:[{gid:19,height:0,name:"",properties:{},type:"hero",width:0,x:49,y:144},{gid:6,height:0,name:"",properties:{},type:"",width:0,x:257,y:156},{gid:6,height:0,name:"",properties:{},type:"",width:0,x:281,y:142},{gid:6,height:0,name:"",properties:{},type:"",width:0,x:306,y:152},{gid:6,height:0,name:"",properties:{},type:"",width:0,x:363,y:266},{gid:6,height:0,name:"",properties:{},type:"",width:0,x:47,y:272},{gid:6,height:0,name:"",properties:{},type:"",width:0,x:142,y:328},{gid:6,height:0,name:"",properties:{},type:"",width:0,x:251,y:449},{gid:6,height:0,name:"",properties:{},type:"",width:0,x:424,y:428},{gid:12,height:0,name:"",properties:{},type:"",width:0,x:167,y:192},{gid:18,height:0,name:"",properties:{},type:"",width:0,x:409,y:191},{gid:18,height:0,name:"",properties:{},type:"",width:0,x:409,y:166},{gid:24,height:0,name:"",properties:{},type:"",width:0,x:364,y:193},{gid:28,height:0,name:"",properties:{},type:"",width:0,x:144,y:384},{height:37,name:"",properties:{},type:"",width:35,x:419,y:64},{height:29,name:"",properties:{},type:"",width:46,x:73,y:402},{gid:10,height:0,name:"",properties:{},type:"",width:0,x:96,y:288},{gid:10,height:0,name:"",properties:{},type:"",width:0,x:192,y:384},{gid:10,height:0,name:"",properties:{},type:"",width:0,x:144,y:360},{gid:10,height:0,name:"",properties:{},type:"",width:0,x:216,y:360},{gid:10,height:0,name:"",properties:{},type:"",width:0,x:120,y:456},{gid:10,height:0,name:"",properties:{},type:"",width:0,x:96,y:264},{gid:10,height:0,name:"",properties:{},type:"",width:0,x:216,y:384},{gid:10,height:0,name:"",properties:{},type:"",width:0,x:120,y:432},{gid:10,height:0,name:"",properties:{},type:"",width:0,x:120,y:408},{gid:10,height:0,name:"",properties:{},type:"",width:0,x:72,y:456},{gid:10,height:0,name:"",properties:{},type:"",width:0,x:96,y:456},{gid:10,height:0,name:"",properties:{},type:"",width:0,x:240,y:384},{gid:10,height:0,name:"",properties:{},type:"",width:0,x:288,y:240},{gid:10,height:0,name:"",properties:{},type:"",width:0,x:288,y:216},{gid:10,height:0,name:"",properties:{},type:"",width:0,x:288,y:192},{gid:10,height:0,name:"",properties:{},type:"",width:0,x:96,y:144},{gid:10,height:0,name:"",properties:{},type:"",width:0,x:360,y:72}],opacity:1,type:"objectgroup",visible:true,width:20,x:0,y:0}],orientation:"orthogonal",properties:{timer:"12"},tileheight:24,tilesets:[{firstgid:1,image:"../src/images/tile-map.png",imageheight:96,imagewidth:144,margin:0,name:"tilemap",properties:{},spacing:0,tileheight:24,tileproperties:{"11":{entity:"sign"},"17":{entity:"enemy"},"18":{entity:"mookie"},"23":{entity:"flower"},"5":{entity:"gem"},"9":{entity:"block"}},tilewidth:24},{firstgid:25,image:"../src/images/test.png",imageheight:48,imagewidth:48,margin:0,name:"test",properties:{},spacing:0,tileheight:24,tileproperties:{"3":{a:"b"}},tilewidth:24}],tilewidth:24,version:1,width:20,id:"level-1"},"level-2":{height:18,layers:[{data:[0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,37,37,37,37,37,37,37,0,0,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,37,37,37,37,37,37,37,37,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,0,37,37,37,37,37,37,37,0,0,1,1,1,1,1,1,0,1,1,1,1,0,1,1,1,1,1,1,1,0,1,1,0,1,1,0,0,0,1,1,1,1,1,1,0,37,0,37,37,37,37,37,0,0,0,0,0,1,0,0,0,1,1,1,1,1,1,0,1,1,1,1,1,0,1,1,0,1,1,0,0,0,0,1,1,1,1,1,0,37,0,0,0,37,0,0,0,0,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,1,1,0,1,1,1,1,1,0,0,1,37,37,0,37,37,37,37,37,0,0,1,1,1,1,1,1,1,0,1,0,0,0,1,0,0,1,1,1,0,1,1,0,1,1,1,0,1,1,1,0,0,1,1,1,0,37,37,37,37,37,37,37,0,0,1,1,1,1,1,1,1,1,0,1,1,1,0,0,1,1,1,1,1,1,1,0,1,0,0,1,1,1,1,1,1,1,1,0,0,37,0,37,37,37,37,37,0,0,10,10,0,0,0,0,0,1,1,1,0,10,0,0,1,1,1,1,1,1,1,0,10,0,10,10,0,1,1,1,1,1,0,37,0,37,0,37,37,37,37,37,0,0,19,19,0,0,0,0,0,0,0,0,0,19,0,0,1,1,1,1,1,1,0,0,19,0,19,19,0,1,1,1,1,1,0,37,0,37,0,37,37,37,37,37,0,0,28,28,28,28,28,28,0,0,0,0,0,28,28,28,0,0,0,1,1,1,37,0,28,0,28,28,0,1,1,1,1,0,37,37,0,37,0,37,37,37,37,37,0,0,37,37,37,37,37,37,37,37,37,37,37,0,0,0,0,0,0,0,0,37,37,0,37,0,37,37,0,1,1,1,1,0,37,37,0,37,0,37,37,37,37,37,0,0,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,0,37,37,0,37,37,0,37,37,0,0,0,0,37,37,37,37,37,0,37,37,37,37,37,0,0,37,37,0,0,0,37,0,0,0,37,37,37,37,37,37,37,37,37,37,37,37,37,0,37,37,0,37,37,0,0,0,37,37,37,37,37,0,37,37,37,37,37,0,0,37,0,37,37,37,37,37,37,37,0,37,37,37,37,37,37,37,37,37,37,37,37,37,0,37,37,0,37,37,37,37,37,37,37,37,37,0,0,0,0,0,37,0,0,37,0,37,37,37,37,37,37,37,0,37,37,37,37,0,37,0,0,37,0,0,0,37,37,0,37,0,0,0,0,0,0,0,37,0,0,0,29,30,37,37,37,37,0,37,37,37,37,37,37,37,37,37,0,37,37,37,37,0,37,37,37,37,37,37,37,0,37,37,37,0,0,0,0,0,0,0,37,0,0,0,38,39,37,37,37,37,0,0,0,0,0,37,37,37,37,0,0,37,37,37,37,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],height:18,name:"background",opacity:1,type:"tilelayer",visible:true,width:44,x:0,y:0},{data:[6,21,21,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,11,13,0,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,13,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,3,0,0,0,0,0,0,0,0,13,0,0,0,0,0,0,0,11,13,0,0,0,0,0,0,5,0,0,0,0,3,0,0,0,0,0,0,0,3,0,0,12,0,0,12,3,3,0,0,0,0,0,0,13,0,3,0,0,0,0,0,11,15,3,3,3,0,3,3,18,0,0,0,0,0,0,3,0,0,0,0,0,12,0,0,12,0,0,12,12,12,3,0,0,0,0,0,12,0,12,3,3,0,3,3,3,13,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,12,0,3,0,0,0,12,0,0,0,0,0,3,3,0,0,0,12,0,0,0,0,0,12,12,0,0,0,0,0,0,0,11,0,3,3,3,0,3,3,0,0,0,3,0,0,12,0,0,0,12,0,0,0,3,3,0,0,0,11,0,0,0,0,0,0,0,12,12,0,0,0,0,0,0,0,0,3,0,0,0,3,12,0,0,0,0,0,0,0,12,0,3,3,0,0,0,0,0,0,0,0,3,16,0,12,0,0,0,0,0,12,13,0,0,32,3,32,3,32,0,0,0,12,0,12,12,0,0,0,0,0,0,0,11,0,12,0,0,5,0,0,0,0,0,3,0,12,0,12,0,0,0,0,0,12,12,0,0,33,35,36,35,34,3,3,3,12,0,12,12,0,0,0,0,0,0,3,16,0,12,0,0,12,0,0,0,0,0,12,0,12,0,12,0,0,0,0,0,12,12,0,0,0,0,0,0,20,12,12,12,12,0,0,0,3,3,3,0,0,0,0,12,0,12,0,0,12,0,0,0,0,3,0,0,12,0,12,0,0,0,0,0,12,12,0,0,0,0,0,0,0,0,0,0,0,12,12,12,12,12,12,3,12,0,0,12,0,12,0,0,12,0,0,0,0,12,0,0,12,0,11,0,0,0,0,0,12,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,12,0,0,3,0,0,12,24,26,25,0,0,0,0,0,12,0,0,0,0,0,12,12,0,0,2,3,3,0,3,3,4,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,3,0,0,23,21,23,0,0,0,0,0,12,0,0,0,0,0,12,12,0,5,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,3,0,0,0,0,0,0,0,0,0,12,3,3,3,4,0,2,12,0,11,0,0,0,0,0,0,0,13,0,0,0,0,3,0,3,3,0,3,3,3,0,0,3,0,12,32,3,32,3,32,4,0,2,3,18,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,13,0,0,0,0,12,0,0,0,0,0,0,0,3,0,0,0,12,33,35,36,35,34,13,0,11,12,13,0,0,0,0,0,0,3,3,3,3,3,0,0,0,0,3,3,0,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],height:18,name:"action",opacity:1,type:"tilelayer",visible:true,width:44,x:0,y:0},{height:18,name:"entities",objects:[{gid:55,height:0,name:"",properties:{},type:"",width:0,x:480,y:72},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:864,y:48},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:936,y:168},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:1008,y:216},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:912,y:264},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:816,y:216},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:504,y:264},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:24,y:144},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:312,y:312},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:216,y:408},{gid:47,height:0,name:"",properties:{},type:"",width:0,x:288,y:72},{gid:47,height:0,name:"",properties:{},type:"",width:0,x:264,y:192},{gid:47,height:0,name:"",properties:{},type:"",width:0,x:24,y:408},{gid:47,height:0,name:"",properties:{},type:"",width:0,x:240,y:336},{gid:47,height:0,name:"",properties:{},type:"",width:0,x:408,y:360},{gid:47,height:0,name:"",properties:{},type:"",width:0,x:672,y:72},{gid:47,height:0,name:"",properties:{},type:"",width:0,x:864,y:360},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:720,y:288},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:288,y:408},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:288,y:384},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:144,y:96},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:144,y:72},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:144,y:48},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:264,y:144},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:264,y:120},{gid:54,height:0,name:"",properties:{},type:"",width:0,x:264,y:96},{gid:62,height:0,name:"",properties:{},type:"",width:0,x:72,y:192},{gid:62,height:0,name:"",properties:{},type:"",width:0,x:120,y:192},{gid:62,height:0,name:"",properties:{},type:"",width:0,x:168,y:192},{gid:62,height:0,name:"",properties:{},type:"",width:0,x:672,y:360},{gid:62,height:0,name:"",properties:{},type:"",width:0,x:696,y:360},{gid:62,height:0,name:"",properties:{},type:"",width:0,x:720,y:360},{gid:62,height:0,name:"",properties:{},type:"",width:0,x:744,y:360},{gid:62,height:0,name:"",properties:{},type:"",width:0,x:768,y:360},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:96,y:288},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:192,y:192},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:192,y:216},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:216,y:216},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:240,y:216},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:288,y:216},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:288,y:240},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:288,y:264},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:312,y:264},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:216,y:168},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:312,y:168},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:72,y:72},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:72,y:96},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:96,y:120},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:504,y:120},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:504,y:336},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:528,y:336},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:528,y:360},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:504,y:360},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:552,y:360},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:600,y:240},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:624,y:240},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:624,y:264},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:600,y:264},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:816,y:360},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:1008,y:336},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:744,y:96},{gid:56,height:0,name:"",properties:{},type:"",width:0,x:744,y:72},{gid:56,height:0,name:"",properties:{},type:"",width:0,x:504,y:96},{gid:56,height:0,name:"",properties:{},type:"",width:0,x:816,y:336},{gid:56,height:0,name:"",properties:{},type:"",width:0,x:984,y:96},{gid:56,height:0,name:"",properties:{},type:"",width:0,x:456,y:360},{gid:56,height:0,name:"",properties:{},type:"",width:0,x:96,y:264},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:120,y:432},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:144,y:432},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:168,y:432},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:192,y:432},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:264,y:432},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:288,y:432},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:312,y:432},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:336,y:432},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:432,y:168},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:408,y:168},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:384,y:168},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:480,y:264},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:456,y:264},{gid:64,height:0,name:"",properties:{},type:"",width:0,x:840,y:48},{gid:64,height:0,name:"",properties:{},type:"",width:0,x:840,y:144},{gid:65,height:0,name:"",properties:{},type:"",width:0,x:888,y:168},{gid:70,height:0,name:"",properties:{},type:"",width:0,x:384,y:288},{gid:70,height:0,name:"",properties:{},type:"",width:0,x:360,y:168},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:360,y:192},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:360,y:216},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:576,y:24},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:576,y:48},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:576,y:48},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:576,y:72},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:576,y:96},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:576,y:120},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:384,y:312},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:384,y:336},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:384,y:360},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:768,y:24},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:768,y:48},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:768,y:72},{gid:71,height:0,name:"",properties:{},type:"",width:0,x:768,y:96},{gid:75,height:0,name:"",properties:{},type:"",width:0,x:768,y:120},{gid:66,height:0,name:"",properties:{},type:"",width:0,x:744,y:120},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:744,y:144},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:720,y:144},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:600,y:144},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:576,y:144},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:360,y:240},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:384,y:240},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:384,y:384},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:696,y:144},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:672,y:144},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:528,y:408},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:504,y:408},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:480,y:408},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:456,y:384},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:456,y:408},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:432,y:408},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:408,y:408},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:384,y:408},{gid:65,height:0,name:"",properties:{},type:"",width:0,x:528,y:408},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:504,y:408},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:456,y:384},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:456,y:408},{gid:56,height:0,name:"",properties:{},type:"",width:0,x:408,y:240},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:552,y:384},{gid:72,height:0,name:"",properties:{},type:"",width:0,x:576,y:384},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:576,y:408},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:600,y:408},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:624,y:408},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:624,y:384},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:624,y:360},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:600,y:360},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:600,y:336},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:576,y:336},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:576,y:312},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:552,y:312},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:552,y:288},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:552,y:264},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:552,y:240},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:552,y:216},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:552,y:192},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:552,y:168},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:552,y:144},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:576,y:168},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:600,y:168},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:552,y:384},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:576,y:384},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:576,y:408},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:600,y:408},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:624,y:408},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:624,y:384},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:624,y:360},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:600,y:360},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:600,y:336},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:576,y:336},{gid:48,height:0,name:"",properties:{},type:"",width:0,x:576,y:312},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:648,y:144},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:696,y:168},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:672,y:168},{gid:73,height:0,name:"",properties:{},type:"",width:0,x:648,y:168},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:648,y:168},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:672,y:168},{gid:63,height:0,name:"",properties:{},type:"",width:0,x:696,y:168},{gid:55,height:0,name:"",properties:{},type:"",width:0,x:336,y:264},{gid:46,height:0,name:"",properties:{},type:"hero",width:0,x:24,y:96}],opacity:1,type:"objectgroup",visible:true,width:44,x:0,y:0}],orientation:"orthogonal",properties:{},tileheight:24,tilesets:[{firstgid:1,image:"../src/images/tiles.png",imageheight:120,imagewidth:216,margin:0,name:"tiles",properties:{},spacing:0,tileheight:24,tilewidth:24},{firstgid:46,image:"../src/images/objects.png",imageheight:96,imagewidth:192,margin:0,name:"objects",properties:{},spacing:0,tileheight:24,tileproperties:{"0":{entity:"hero"},"10":{entity:"block"}},tilewidth:24}],tilewidth:24,version:1,width:44,id:"level-2"}}};a.classes={};a.classes.game=(function(){var d=function(e,f){return function(g){f(e,g)}},b=function(f){this.currentScene=undefined;this.settings=f;this.rootElement=document.createElement("div");this.rootElement.id=f.global.rootElement;document.getElementsByTagName("body")[0].appendChild(this.rootElement);this.loadScene(f.global.initialScene);var e=this,g=function(h,i){e.currentScene.trigger(h,i)};this.bindings=[];this.addEventListener(window,"keydown",g);this.addEventListener(window,"keyup",g);if(f.global.aspectRatio){g=function(l,m){var j=e.rootElement;var k=f.global.aspectRatio;var n=window.innerWidth;var i=window.innerHeight;var h=n/i;if(h>k){j.style.height=i+"px";n=i*k;j.style.width=n+"px"}else{j.style.width=n+"px";i=n/k;j.style.height=i+"px"}if(f.global.resizeFont){j.style.fontSize=Math.round(n/100)+"px"}j.style.marginTop="-"+Math.round(i/2)+"px";j.style.marginLeft="-"+Math.round(n/2)+"px";e.currentScene.trigger(l,m)};g("resize")}else{if(f.global.resizeFont){g=function(h,i){e.rootElement.style.fontSize=parseInt(window.innerWidth/100)+"px";e.currentScene.trigger(h,i)};g("resize")}}this.addEventListener(window,"orientationchange",g);this.addEventListener(window,"resize",g);this.prevTime=0;this.timingFunction=false;if(window.performance&&window.performance.webkitNow){this.timingFunction=function(){return window.performance.webkitNow()}}else{if(window.performance&&window.performance.now){this.timingFunction=function(){return window.performance.now()}}else{this.date=new Date();this.timingFunction=function(){return this.date.getTime()}}}this.prevTime=this.timingFunction()},c=b.prototype;c.tick=function(){var e=this.timingFunction();var f=e-this.prevTime;this.prevTime=e;if(this.currentScene){this.currentScene.tick(f)}};c.loadScene=function(e){this.currentScene=new a.classes.scene(this.settings.scenes[e],this.rootElement)};c.addEventListener=function(e,f,g){this.bindings[f]={element:e,callback:d(f,g)};e.addEventListener(f,this.bindings[f].callback,true)};c.destroy=function(){for(var e in this.bindings){element.removeEventListener(this.bindings[e].element,this.bindings[e].callback,true)}this.bindings.length=0};return b})();a.classes.entity=(function(){var b=function(g,e){var m=this,j=undefined,i=undefined,f=g||{},d=f.components||[],l=f.properties||{},k=e||{},h=k.properties||{};m.components=[];m.messages=[];m.type=f.id;for(j in l){m[j]=l[j]}for(j in h){m[j]=h[j]}for(j in d){i=d[j];if(a.components[i.type]){m.addComponent(new a.components[i.type](m,i))}else{console.warn("Component '"+i.type+"' is not defined.",i)}}m.trigger("load")};var c=b.prototype;c.addComponent=function(d){this.components.push(d);return d};c.removeComponent=function(e){for(var d in this.components){if(this.components[d]===e){this.components.splice(d,1);e.destroy();return e}}return false};c.bind=function(d,e){if(!this.messages[d]){this.messages[d]=[]}this.messages[d].push(e)};c.unbind=function(e,f){if(!this.messages[e]){this.messages[e]=[]}for(var d in this.messages[e]){if(this.messages[e][d]===f){this.messages[e].splice(d,1);break}}};c.trigger=function(d,f){var e=0;if(this.messages[d]){for(e=0;e<this.messages[d].length;e++){this.messages[d][e](f)}}if(this["debug"]){if(e){console.log('Entity "'+this.type+'": Event "'+d+'" has '+e+" subscriber"+((e>1)?"s":"")+".",f)}else{console.warn('Entity "'+this.type+'": Event "'+d+'" has no subscribers.',f)}}};c.getMessageIds=function(){var e=[];for(var d in this.messages){e.push(d)}return e};c.destroy=function(){for(var d in this.components){this.removeComponent(this.components[d])}};return b})();a.classes.layer=(function(){var b=function(f,d){var h=f.components,g=undefined;this.type=f.id||"layer";this.rootElement=d;this.components=[];this.tickMessages=[];this.messages=[];for(var e in h){g=h[e];this.addComponent(new a.components[g.type||g.id](this,g))}this.trigger("load")},c=b.prototype;c.tick=function(d){for(var e in this.tickMessages){this.trigger(this.tickMessages[e],d)}};c.addComponent=function(e){var g=false,f=0,d=0;this.components.push(e);if(e.tickMessages){for(f in e.tickMessages){g=false;for(d in this.tickMessages){if(e.tickMessages[f]===this.tickMessages[d]){g=true}}if(!g){this.tickMessages.push(e.tickMessages[f])}}}return e};c.removeComponent=function(e){for(var d in this.components){if(this.components[d]===e){this.components.splice(d,1);e.destroy();return e}}return false};c.bind=function(e,d){if(!this.messages[e]){this.messages[e]=[]}this.messages[e].push(d)};c.unbind=function(e,d){if(!this.messages[e]){this.messages[e]=[]}for(var f in this.messages[e]){if(this.messages[e][f]===d){this.messages[e].splice(f,1);break}}};c.trigger=function(d,f){var e=0;if(this.messages[d]){for(e=0;e<this.messages[d].length;e++){this.messages[d][e](f)}}if(this["debug"]){if(e){console.log('Layer "'+this.type+'": Event "'+d+'" has '+e+" subscriber"+((e>1)?"s":"")+".",f)}else{console.warn('Layer "'+this.type+'": Event "'+d+'" has no subscribers.',f)}}};return b})();a.classes.scene=(function(){var c=function(f,d){var g=f.layers;this.rootElement=d;this.layers=[];for(var e in g){this.layers.push(new a.classes.layer(g[e],this.rootElement))}};var b=c.prototype;b.tick=function(e){for(var d in this.layers){this.layers[d].tick(e)}};b.trigger=function(e,f){for(var d in this.layers){this.layers[d].trigger(e,f)}};return c})();a.classes.collisionShape=(function(){var b=function(e,h,g,i){this.offset=i||[0,0];this.x=e[0]+this.offset[0];this.y=e[1]+this.offset[1];this.prevX=this.x;this.prevY=this.y;this.type=h||"rectangle";this.subType="";this.points=g;this.aABB=undefined;var f=0;var d=0;switch(this.type){case"rectangle":case"circle":f=this.points[1][0]-this.points[0][0];d=this.points[1][1]-this.points[0][1];break;case"triangle":if(this.points[0][1]==this.points[1][1]&&this.points[0][0]==this.points[2][0]){if(this.points[0][0]<this.points[1][0]){this.subType="tl";f=this.points[1][0]-this.points[0][0];d=this.points[2][1]-this.points[0][1]}else{this.subType="br";f=this.points[0][0]-this.points[1][0];d=this.points[0][1]-this.points[2][1]}}else{if(this.points[0][1]==this.points[2][1]&&this.points[0][0]==this.points[1][0]){if(this.points[0][1]<this.points[1][1]){this.subType="tr";f=this.points[0][0]-this.points[2][0];d=this.points[1][1]-this.points[0][1]}else{this.subType="bl";f=this.points[2][0]-this.points[0][0];d=this.points[0][1]-this.points[1][1]}}}}this.aABB=new a.classes.aABB(this.x,this.y,f,d)};var c=b.prototype;c.update=function(d,e){this.prevX=this.x;this.prevY=this.y;this.x=d+this.offset[0];this.y=e+this.offset[1];this.aABB.move(this.x,this.y)};c.setXY=function(d,e){this.x=d;this.y=e};c.getXY=function(){return[this.x,this.y]};c.getX=function(){return this.x};c.getY=function(){return this.y};c.getPrevX=function(){return this.prevX};c.getPrevY=function(){return this.prevY};c.getPrevLocation=function(){return[this.prevX,this.prevY]};c.getAABB=function(){return this.aABB};c.getXOffset=function(){return this.offset[0]};c.getYOffset=function(){return this.offset[1]};return b})();a.classes.aABB=(function(){var c=function(e,g,f,d){this.x=e||0;this.y=g||0;this.width=f;this.height=d;this.halfWidth=this.width/2;this.halfHeight=this.height/2;this.left=-this.halfWidth+this.x;this.right=this.halfWidth+this.x;this.top=-this.halfHeight+this.y;this.bottom=this.halfHeight+this.y};var b=c.prototype;b.move=function(d,e){this.x=d;this.y=e;this.left=-this.halfWidth+this.x;this.right=this.halfWidth+this.x;this.top=-this.halfHeight+this.y;this.bottom=this.halfHeight+this.y;return this};b.getCopy=function(){return new a.classes.aABB(this.x,this.y,this.width,this.height)};return c})();a.components={};a.components["layer-controller"]=(function(){var e=function(g,f){return function(i){var j=i.released?":up":":down";for(var h=0;h<f.entities.length;h++){f.entities[h].trigger(g+j,i)}}},d={kc0:"unknown",kc8:"backspace",kc9:"tab",kc12:"numpad-5-shift",kc13:"enter",kc16:"shift",kc17:"ctrl",kc18:"alt",kc19:"pause",kc20:"caps-lock",kc27:"esc",kc32:"space",kc33:"page-up",kc34:"page-down",kc35:"end",kc36:"home",kc37:"left-arrow",kc38:"up-arrow",kc39:"right-arrow",kc40:"down-arrow",kc42:"numpad-multiply",kc43:"numpad-add",kc44:"print-screen",kc45:"insert",kc46:"delete",kc47:"numpad-division",kc48:"0",kc49:"1",kc50:"2",kc51:"3",kc52:"4",kc53:"5",kc54:"6",kc55:"7",kc56:"8",kc57:"9",kc59:"semicolon",kc61:"equals",kc65:"a",kc66:"b",kc67:"c",kc68:"d",kc69:"e",kc70:"f",kc71:"g",kc72:"h",kc73:"i",kc74:"j",kc75:"k",kc76:"l",kc77:"m",kc78:"n",kc79:"o",kc80:"p",kc81:"q",kc82:"r",kc83:"s",kc84:"t",kc85:"u",kc86:"v",kc87:"w",kc88:"x",kc89:"y",kc90:"z",kc91:"left-windows-start",kc92:"right-windows-start",kc93:"windows-menu",kc96:"back-quote",kc106:"numpad-multiply",kc107:"numpad-add",kc109:"numpad-minus",kc110:"numpad-period",kc111:"numpad-division",kc112:"f1",kc113:"f2",kc114:"f3",kc115:"f4",kc116:"f5",kc117:"f6",kc118:"f7",kc119:"f8",kc120:"f9",kc121:"f10",kc122:"f11",kc123:"f12",kc144:"num-lock",kc145:"scroll-lock",kc186:"semicolon",kc187:"equals",kc188:"comma",kc189:"hyphen",kc190:"period",kc191:"forward-slash",kc192:"back-quote",kc219:"open-bracket",kc220:"back-slash",kc221:"close-bracket",kc222:"quote"},b=function(f,g){this.owner=f;this.entities=[];this.listeners=[];this.tickMessages=["check-inputs"];this.addListeners(["entity-added","check-inputs","keydown","keyup","mousedown","mousemove","mouseup","touchstart","touchmove","touchend","touchcancel"])},c=b.prototype;c.keydown=function(g){for(var f=0;f<this.entities.length;f++){this.entities[f].trigger("key:"+(d["kc"+g.keyCode]||("key-code-"+g.keyCode))+":down",g)}};c.keyup=function(g){for(var f=0;f<this.entities.length;f++){this.entities[f].trigger("key:"+(d["kc"+g.keyCode]||("key-code-"+g.keyCode))+":up",g)}};c["check-inputs"]=function(g){for(var f=0;f<this.entities.length;f++){this.entities[f].trigger("controller:tick")}};c["entity-added"]=function(g){var h=g.getMessageIds();for(var f=0;f<h.length;f++){if(h[f]=="controller"){if(g.controlMap){for(var i in g.controlMap){if((i.indexOf("key:")<0)||(i.indexOf("mouse:")<0)){if(!this[i]){this.addListener(i);this[i]=e(i,this)}}}}this.entities.push(g);g.trigger("controller:load");break}}};c.destroy=function(){this.removeListeners(this.listeners);this.entities.length=0};c.addListeners=function(g){for(var f in g){this.addListener(g[f])}};c.removeListeners=function(g){for(var f in g){this.removeListener(f,g[f])}};c.addListener=function(g,i){var f=this,h=i||function(j){f[g](j)};this.owner.bind(g,h);this.listeners[g]=h};c.removeListener=function(f,g){this.owner.unbind(f,g)};return b})();a.components["tiled-loader"]=(function(){var b=function(d,e){this.owner=d;this.entities=[];this.listeners=[];this.addListeners(["load"]);this.level=a.settings.levels[e.level];this.tileEntityId=e.tileEntityId||"tile";this.unitsPerPixel=e.unitsPerPixel||1},c=b.prototype;c.load=function(){var d=0;for(;d<this.level.layers.length;d++){this.setupLayer(this.level.layers[d],this.level)}this.owner.removeComponent(this)};c.setupLayer=function(v,e){var s=v.width,r=v.height,l=[],u=e.tilesets,d=e.tilewidth,i=e.tileheight,k=0,j=0,n=0,m=undefined,t="",q=undefined,g=undefined,o=undefined,p=undefined,h=undefined,w=undefined,f=undefined;for(k=0;k<u.length;k++){if(a.assets[u[k].name]){l.push(a.assets[u[k].name])}else{l.push(u[k].image)}}if(v.type=="tilelayer"){m="tile-layer";if(v.properties&&v.properties.entity){m=v.properties.entity}else{switch(v.name){case"background":case"foreground":m="render-layer";break;case"collision":m="collision-layer";break}}o=JSON.parse(JSON.stringify(a.settings.entities[m]));p={};h=[];w=[];o.properties=o.properties||{};o.properties.width=d*s*this.unitsPerPixel;o.properties.height=i*r*this.unitsPerPixel;o.properties.columns=s;o.properties.rows=r;o.properties.tileWidth=d*this.unitsPerPixel;o.properties.tileHeight=i*this.unitsPerPixel;o.properties.scaleX=this.unitsPerPixel;o.properties.scaleY=this.unitsPerPixel;for(k=0;k<s;k++){h[k]=[];w[k]=[];for(j=0;j<r;j++){if(typeof p["tile"+(+v.data[k+j*s]-1)]=="undefined"){p["tile"+(+v.data[k+j*s]-1)]=+v.data[k+j*s]-1}h[k][j]=+v.data[k+j*s]-1;w[k][j]="tile"+(+v.data[k+j*s]-1)}}for(k=0;k<o.components.length;k++){if(o.components[k].spritesheet=="import"){o.components[k].spritesheet={images:l,frames:{width:d,height:i},animations:p}}if(o.components[k].collisionMap=="import"){o.components[k].collisionMap=h}if(o.components[k].imageMap=="import"){o.components[k].imageMap=w}}this.owner.addEntity(new a.classes.entity(o,{properties:{}}))}else{if(v.type=="objectgroup"){for(n=0;n<v.objects.length;n++){m=v.objects[n];for(k=0;k<u.length;k++){if(u[k].firstgid>m.gid){break}else{q=u[k]}}t="";if(m.type!==""){t=m.type}else{if(q.tileproperties[m.gid-q.firstgid]){if(q.tileproperties[m.gid-q.firstgid].entity){t=q.tileproperties[m.gid-q.firstgid].entity}else{if(q.tileproperties[m.gid-q.firstgid].type){t=q.tileproperties[m.gid-q.firstgid].type}}}}if(t!==""){g={};for(k in m.properties){g[k]=m.properties[k]}g.width=(m.width||d)*this.unitsPerPixel;g.height=(m.height||i)*this.unitsPerPixel;g.x=m.x*this.unitsPerPixel+(g.width/2);g.y=m.y*this.unitsPerPixel;g.scaleX=this.unitsPerPixel;g.scaleY=this.unitsPerPixel;m=this.owner.addEntity(new a.classes.entity(a.settings.entities[t],{properties:g}));if(m){if(m.camera){f={entity:m,mode:m.camera}}}}}}}this.owner.trigger("world-loaded",{width:s*d*this.unitsPerPixel,height:r*i*this.unitsPerPixel,unitsPerPixel:this.unitsPerPixel,camera:f})};c.destroy=function(){this.removeListeners(this.listeners);this.entities.length=0};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["lc-render"]=(function(){var b=function(d,e){this.owner=d;this.entities=[];this.listeners=[];this.tickMessages=["render"];this.addListeners(["entity-added","render","camera-update"]);this.canvas=document.createElement("canvas");this.owner.rootElement.appendChild(this.canvas);this.canvas.style.width="100%";this.canvas.style.height="100%";this.canvas.width=320;this.canvas.height=240;this.stage=new createjs.Stage(this.canvas)};var c=b.prototype;c["entity-added"]=function(f){var e=this,g=f.getMessageIds();for(var d=0;d<g.length;d++){if(g[d]=="layer:render"){this.entities.push(f);f.trigger("layer:render-load",{stage:this.stage,parentElement:this.owner.rootElement});break}}};c.render=function(e){for(var d=0;d<this.entities.length;d++){this.entities[d].trigger("layer:render",e)}this.stage.update()};c["camera-update"]=function(d){this.canvas.width=this.canvas.offsetWidth;this.canvas.height=this.canvas.offsetHeight;this.stage.setTransform(-d.x,-d.y,d.scaleX,d.scaleY)};c.destroy=function(){this.removeListeners(this.listeners);this.stage=undefined;this.owner.rootElement.removeChild(this.canvas);this.canvas=undefined;this.entities.length=0};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["lc-logic"]=(function(){var b=function(d,e){this.owner=d;this.entities=[];this.listeners=[];this.tickMessages=["logic"];this.addListeners(["entity-added","logic"])};var c=b.prototype;c["entity-added"]=function(f){var e=this,g=f.getMessageIds();for(var d=0;d<g.length;d++){if(g[d]=="layer:logic"){this.entities.push(f);break}}};c.logic=function(e){for(var d=0;d<this.entities.length;d++){this.entities[d].trigger("layer:logic",e)}};c.destroy=function(){this.removeListeners(this.listeners)};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["lc-camera"]=(function(){var b=function(d,e){this.owner=d;this.entities=[];this.stretch=e.stretch||false;this.listeners=[];this.tickMessages=["camera"];this.addListeners(["resize","orientationchange","camera","load","world-loaded"]);this.windowViewportTop=this.owner.rootElement.innerTop;this.windowViewportLeft=this.owner.rootElement.innerLeft;this.windowViewportWidth=this.owner.rootElement.offsetWidth;this.windowViewportHeight=this.owner.rootElement.offsetHeight;this.worldViewportWidth=e.width||0;this.worldViewportHeight=e.height||0;this.worldViewportLeft=e.left||0;this.worldViewportTop=e.top||0;this.aspectRatio=e.aspectRatio||0;if(this.worldViewportWidth&&this.worldViewportHeight){this.aspectRatio=this.aspectRatio||(this.worldViewportHeight/this.worldViewportWidth)}else{this.aspectRatio=this.aspectRatio||(this.windowViewportHeight/this.windowViewportWidth);if(this.worldViewportWidth||this.worldViewportHeight){this.worldViewportWidth=this.worldViewportWidth||(this.worldViewportHeight/this.aspectRatio);this.worldViewportHeight=this.worldViewportHeight||(this.aspectRatio/this.worldViewportWidth)}else{this.worldViewportWidth=this.windowViewportWidth;this.worldViewportHeight=this.aspectRatio*this.worldViewportWidth}}this.scaleWidth=e.scaleWidth||0;this.resize();this.worldWidth=0;this.worldHeight=0;this.following=undefined;this.state="static";this.boundingBoxLeft=100;this.boundingBoxTop=100;this.boundingBoxWidth=this.worldViewportWidth-(2*this.boundingBoxLeft);this.boundingBoxHeight=this.worldViewportHeight-(2*this.boundingBoxTop);this.direction=true};var c=b.prototype;c.load=function(){};c["world-loaded"]=function(d){this.worldWidth=this.owner.worldWidth=d.width;this.worldHeight=this.owner.worldHeight=d.height;if(d.camera){this.follow(d.camera)}};c.camera=function(d){switch(this.state){case"following":this.followingFunction(this.following);break;case"roaming":var e=0.3*d;if(this.direction){this.move(this.worldViewportLeft+e,this.worldViewportTop);if(this.worldWidth&&(this.worldViewportLeft==this.worldWidth-this.worldViewportWidth)){this.direction=!this.direction}}else{this.move(this.worldViewportLeft-e,this.worldViewportTop);if(this.worldWidth&&(this.worldViewportLeft==0)){this.direction=!this.direction}}break;case"static":default:break}this.owner.trigger("camera-update",{x:this.worldViewportLeft*this.windowPerWorldUnitWidth,y:this.worldViewportTop*this.windowPerWorldUnitHeight,scaleX:this.windowPerWorldUnitWidth,scaleY:this.windowPerWorldUnitHeight})};c.resize=c.orientationchange=function(){this.windowViewportTop=this.owner.rootElement.innerTop;this.windowViewportLeft=this.owner.rootElement.innerLeft;this.windowViewportWidth=this.owner.rootElement.offsetWidth;this.windowViewportHeight=this.owner.rootElement.offsetHeight;if(this.scaleWidth){this.worldViewportWidth=this.windowViewportWidth/Math.ceil(this.windowViewportWidth/this.scaleWidth)}if(!this.stretch||this.scaleWidth){this.worldViewportHeight=this.windowViewportHeight*this.worldViewportWidth/this.windowViewportWidth}this.worldPerWindowUnitWidth=this.worldViewportWidth/this.windowViewportWidth;this.worldPerWindowUnitHeight=this.worldViewportHeight/this.windowViewportHeight;this.windowPerWorldUnitWidth=this.windowViewportWidth/this.worldViewportWidth;this.windowPerWorldUnitHeight=this.windowViewportHeight/this.worldViewportHeight};c.follow=function(d){switch(d.mode){case"locked":this.state="following";this.following=d.entity;this.followingFunction=this.lockedFollow;break;case"bounding":this.state="following";this.following=d.entity;this.setBoundingArea(d.top,d.left,d.width,d.height);this.followingFunction=this.boundingFollow;break;case"custom":this.state="following";this.following=d.entity;this.followingFunction=d.followingFunction;break;case"static":default:this.state="static";this.following=undefined;this.followingFunction=undefined;break}};c.move=function(e,d){if(this.worldWidth<this.worldViewportWidth){this.worldViewportLeft=(this.worldWidth-this.worldViewportWidth)/2}else{if(this.worldWidth&&(e+this.worldViewportWidth>this.worldWidth)){this.worldViewportLeft=this.worldWidth-this.worldViewportWidth}else{if(this.worldWidth&&(e<0)){this.worldViewportLeft=0}else{this.worldViewportLeft=e}}}if(this.worldHeight<this.worldViewportHeight){this.worldViewportTop=(this.worldHeight-this.worldViewportHeight)/2}else{if(this.worldHeight&&(d+this.worldViewportHeight>this.worldHeight)){this.worldViewportTop=this.worldHeight-this.worldViewportHeight}else{if(this.worldHeight&&(d<0)){this.worldViewportTop=0}else{this.worldViewportTop=d}}}};c.lockedFollow=function(d){this.move(d.x-(this.worldViewportWidth/2),d.y-(this.worldViewportHeight/2))};c.setBoundingArea=function(g,f,e,d){this.boundingBoxTop=g||100;this.boundingBoxLeft=f||100;this.boundingBoxWidth=e||this.worldViewportWidth-(2*this.boundingBoxLeft);this.boundingBoxHeight=d||this.worldViewportHeight-(2*this.boundingBoxTop)};c.boundingFollow=function(e){var f=0;var d=0;if(e.x>this.x+this.boundingBoxLeft+this.BoundingBoxWidth){f=e.x-(this.boundingBoxLeft+this.BoundingBoxWidth)}else{if(e.x<this.x+this.boundingBoxLeft){f=e.x-this.boundingBoxLeft}}if(e.y>this.y+this.boundingBoxTop+this.BoundingBoxHeight){d=e.y-this.boundingBoxTop+this.BoundingBoxHeight}else{if(e.y<this.y+this.boundingBoxTop){d=e.y-this.boundingBoxTop}}this.move(f,d)};c.windowToWorld=function(d){var e=[];e[0]=Math.round((d[0]-this.windowViewportLeft)*this.worldPerWindowUnitWidth);e[1]=Math.round((d[1]-this.windowViewportTop)*this.worldPerWindowUnitHeight);return e};c.worldToWindow=function(e){var d=[];d[0]=Math.round((e[0]*this.windowPerWorldUnitWidth)+this.windowViewportLeft);d[1]=Math.round((e[1]*this.windowPerWorldUnitHeight)+this.windowViewportTop);return d};c.destroy=function(){this.removeListeners(this.listeners);this.entities.length=0};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["lc-basic-collision"]=(function(){var b=function(d,e){this.owner=d;this.listeners=[];this.tickMessages=["collision"];this.addListeners(["load","entity-added","collision"]);this.entities=[];this.solidEntities=[];this.terrain=undefined;this.collisionMatrix={}};var c=b.prototype;c["entity-added"]=function(f){var e=this;var g=f.getMessageIds();if(f.type=="tile-layer"){this.terrain=f}else{for(var d=0;d<g.length;d++){if(g[d]=="layer:resolve-collision"){this.entities.push(f);if(!this.collisionMatrix[f.type]){this.collisionMatrix[f.type]={};for(var d=0;d<f.collidesWith.length;d++){this.collisionMatrix[f.type][f.collidesWith[d]]=true}}break}}}};c.load=function(){};c.collision=function(e){var d=[];this.prepareCollision();this.checkStupidCollision();d=this.checkCollision();this.resolveCollision(d)};c.prepareCollision=function(){for(var d=0;d<this.entities.length;d++){this.entities[d].trigger("layer:prep-collision")}};c.checkStupidCollision=function(){for(var p=0;p<this.entities.length-1;p++){var H=this.entities[p];var K=H.shape.getAABB();var h=H.shape.getPrevLocation();var o=(K.getCopy()).move(h[0],h[1]);var r=Math.min(K.top,o.top);var i=Math.max(K.bottom,o.bottom);var v=i-r;var C=Math.min(K.left,o.left);var A=Math.max(K.right,o.right);var l=A-C;var E=C+(l/2);var D=r+(v/2);var I=new a.classes.aABB(E,D,l,v);var z=[];var j=[];if(this.collisionMatrix[H.type]["solid"]){z=this.terrain.getTiles(I)}for(var n=p+1;n<this.entities.length;n++){if(this.collisionMatrix[H.type][this.entities[n].collisionType]&&this.AABBCollision(I,this.entities[n].shape.getAABB())){j.push(this.entities[n])}}var G=(H.shape.getPrevX()<H.shape.getX())?1:-1;var q=H.shape.getPrevX();var F=H.shape.getX();var J=(H.shape.getPrevY()<H.shape.getY())?1:-1;var B=H.shape.getPrevY();var k=H.shape.getY();var d=undefined;var e=undefined;while(q!=F&&(z.length||j.length)){if(Math.abs(F-q)<=1){q=F}else{q+=G}o.move(q,B);var m=undefined;for(var w=0;w<z.length;w++){m=z[w].shape.getAABB();if(this.AABBCollision(o,m)){var g=undefined;if(G>0){g=m.left-o.halfWidth}else{g=m.right+o.halfWidth}if(typeof e==="undefined"){e=g}else{if(G>0){if(g<e){e=g}}else{if(g<e){e=g}}}}}var L=undefined;for(var s=0;s<j.length;s++){L=j[s].shape.getAABB();if(this.AABBCollision(o,L)){var g=undefined;if(G>0){g=L.left-o.halfWidth}else{g=L.right+o.halfWidth}if(typeof e==="undefined"){e=g}else{if(G>0){if(g<e){e=g}}else{if(g<e){e=g}}}}}if(typeof e!=="undefined"){break}}if(typeof e==="undefined"){e=F}while(B!=k&&(z.length||j.length)){if(Math.abs(k-B)<1){B=k}else{B+=J}o.move(e,B);var m=undefined;for(var w=0;w<z.length;w++){m=z[w].shape.getAABB();if(this.AABBCollision(o,m)){var f=undefined;if(J>0){f=m.top-o.halfHeight}else{f=m.bottom+o.halfHeight}if(typeof d==="undefined"){d=f}else{if(J>0){if(f<d){d=f}}else{if(f<d){d=f}}}}}var L=undefined;for(var s=0;s<j.length;s++){L=j[s].shape.getAABB();if(this.AABBCollision(o,L)){var f=undefined;if(J>0){f=L.top-o.halfHeight}else{f=L.bottom+o.halfHeight}if(typeof d==="undefined"){d=f}else{if(J>0){if(f<d){d=f}}else{if(f<d){d=f}}}}}if(typeof d!=="undefined"){break}}if(typeof d==="undefined"){d=k}H.trigger("layer:relocate",[e,d])}};c.checkSolidCollision=function(){var f=[];for(var d=0;d<this.entities.length-1;d++){var e=[];var g=[];if(this.collisionMatrix[this.entities[d].type]["solid"]){if(this.terrain){e=this.terrain.getTiles(this.entities[d].getAABB())}for(var h=d+1;h<this.solidEntities.length;h++){if(this.AABBCollision(this.entities[d].shape.getAABB(),this.entities[h].shape.getAABB())){if(this.preciseCollision(this.entities[d].shape,this.solidEntities[h].shape)){g.push({entity:this.solidEntities[h],shape:this.solidEntities[h].shape})}}}}f.push({entity:this.entities[d],tileCollisions:e,otherCollisions:g})}return f};c.checkCollision=function(){var e=[];for(var d=0;d<this.entities.length-1;d++){for(var f=d+1;f<this.entities.length;f++){if(this.collisionMatrix[this.entities[d].type][this.entities[f].collisionType]||this.collisionMatrix[this.entities[f].type][this.entities[d].collisionType]){if(this.AABBCollision(this.entities[d].shape.getAABB(),this.entities[f].shape.getAABB())){if(this.preciseCollision(this.entities[d].shape,this.entities[f].shape)){if(this.collisionMatrix[this.entities[d].type][this.entities[f].collisionType]){e.push({entity:this.entities[d],message:{entity:this.entities[f],type:this.entities[f].collisionType,shape:this.entities[f].shape}})}if(this.collisionMatrix[this.entities[f].type][this.entities[d].collisionType]){e.push({entity:this.entities[f],message:{entity:this.entities[d],type:this.entities[d].collisionType,shape:this.entities[d].shape}})}}}}}}return e};c.AABBCollision=function(e,d){if(e.left>=d.right){return false}if(e.right<=d.left){return false}if(e.top>=d.bottom){return false}if(e.bottom<=d.top){return false}return true};c.preciseCollision=function(e,d){return true};c.resolveSolidCollision=function(e){for(var d=0;d<e.length;d++){e[d].entity.trigger("layer:resolve-solid-collision",{terrain:this.terrain,tileCollisions:e[d].tileCollisions,otherCollisions:e[d].otherCollisions})}};c.resolveCollision=function(e){for(var d=0;d<e.length;d++){e[d].entity.trigger("layer:resolve-collision",e[d].message)}};c.destroy=function(){this.removeListeners(this.listeners);this.entities.length=0};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components.audio=(function(){var c={interrupt:createjs.SoundJS.INTERRUPT_ANY,delay:0,offset:0,loop:0,volume:1,pan:0,length:0},e=function(h){var g="",f=undefined;if(typeof h==="string"){g=h}else{f=h;g=h.sound}return function(q){var l=undefined,i=0;q=q||f;if(q){var k=q.interrupt||f.interrupt||c.interrupt,m=q.delay||f.delay||c.delay,j=q.offset||f.offset||c.offset,o=q.loop||f.loop||c.loop,n=(typeof q.volume!=="undefined")?q.volume:((typeof f.volume!=="undefined")?f.volume:c.volume),p=q.pan||f.pan||c.pan;i=q.length||f.length||c.length;l=createjs.SoundJS.play(g,k,m,j,o,n,p)}else{l=createjs.SoundJS.play(g,c.interrupt,c.delay,c.offset,c.loop,c.volume,c.pan)}if(l.playState==="playFailed"){if(this.owner.debug){console.warn('Unable to play "'+g+'".',l)}}else{if(i){this.timedAudioClips.push({length:i,progress:0,audio:l})}}}},b=function(f,h){this.owner=f;this.timedAudioClips=[],this.listeners=[];this.addListener("layer:render");if(h.audioMap){for(var g in h.audioMap){this.addListener(g);this[g]=e(h.audioMap[g])}}};var d=b.prototype;d["layer:render"]=function(h){var g=0,f=undefined;newArray=undefined;if(this.timedAudioClips.length){newArray=[];for(g in this.timedAudioClips){f=this.timedAudioClips[g];f.progress+=h;if(f.progress>=f.length){f.audio.stop()}else{newArray.push(f)}}this.timedAudioClips=newArray}};d.destroy=function(){this.removeListeners(this.listeners)};d.addListeners=function(g){for(var f in g){this.addListener(g[f])}};d.removeListeners=function(g){for(var f in g){this.removeListener(f,g[f])}};d.addListener=function(g,i){var f=this,h=i||function(j){f[g](j)};this.owner.bind(g,h);this.listeners[g]=h};d.removeListener=function(f,g){this.owner.unbind(f,g)};return b})();a.components["broadcast-events"]=(function(){var c=function(e){return function(f){a.game.currentScene.trigger(e,f)}},b=function(e,f){this.owner=e;this.listeners=[];if(f.events){for(var g in f.events){this[g]=c(f.events[g]);this.addListener(g)}}},d=b.prototype;d.destroy=function(){this.removeListeners(this.listeners)};d.addListeners=function(f){for(var e in f){this.addListener(f[e])}};d.removeListeners=function(f){for(var e in f){this.removeListener(e,f[e])}};d.addListener=function(f,h){var e=this,g=h||function(i){e[f](i)};this.owner.bind(f,g);this.listeners[f]=g};d.removeListener=function(e,f){this.owner.unbind(e,f)};return b})();a.components["entity-container"]=(function(){var b=function(e,g){var f=this,d=0;this.owner=e;this.listeners=[];this.entities=[];this.definedEntities=g.entities;this.owner.entities=f.entities;this.owner.addEntity=function(h){return f.addEntity(h)};this.owner.removeEntity=function(){return f.removeEntity()};this.addListeners(["load","add-entity","remove-entity"])};var c=b.prototype;c.load=function(){var d=0,e=this.definedEntities;this.definedEntities=false;if(e){for(d=0;d<e.length;d++){this.addEntity(new a.classes.entity(a.settings.entities[e[d].type],e[d]))}}};c.addEntity=c["add-entity"]=function(d){this.entities.push(d);this.owner.trigger("entity-added",d);return d};c.removeEntity=c["remove-entity"]=function(e){for(var d=0;d<this.entities.length;d++){if(this.entities[d]===e){this.entities.splice(d,1);e.destroy();return e}}return false};c.destroy=function(){this.removeListeners(this.listeners);for(var d in this.entities){entity.destroy()}this.entities.length=0};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["entity-controller"]=(function(){var f=function(){this.current=false;this.last=false;this.state=false},h=["left-button","middle-button","right-button"],d=function(i){return function(j){i.state=false}},c=function(i){return function(j){i.current=true;i.state=true;if(j&&(typeof(j.over)!=="undefined")){i.over=j.over}}},b=function(i,k){var j="",l=undefined;this.owner=i;this.listeners=[];this.addListeners(["load","controller","controller:load","controller:tick","mousedown","mouseup","mousemove"]);if(k&&k.controlMap){this.owner.controlMap=k.controlMap;this.actions={};for(j in k.controlMap){l=this.actions[k.controlMap[j]];if(!l){l=this.actions[k.controlMap[j]]=new f()}this[j+":up"]=d(l);this[j+":down"]=c(l);this.addListener(j+":up");this.addListener(j+":down")}}},g=f.prototype,e=b.prototype;g.update=function(){this.last=this.current;this.current=this.state};g.isPressed=function(){return this.current};g.isTriggered=function(){return this.current&&!this.last};g.isReleased=function(){return !this.current&&this.last};e.load=function(){};e["mouse:move"]=function(i){if(this.actions["mouse:left-button"]&&(this.actions["mouse:left-button"].over!==i.over)){this.actions["mouse:left-button"].over=i.over}if(this.actions["mouse:middle-button"]&&(this.actions["mouse:middle-button"].over!==i.over)){this.actions["mouse:middle-button"].over=i.over}if(this.actions["mouse:right-button"]&&(this.actions["mouse:right-button"].over!==i.over)){this.actions["mouse:right-button"].over=i.over}};e.controller=function(){};e["controller:load"]=function(){};e["controller:tick"]=function(k){var j=undefined,i="";if(this.actions){for(i in this.actions){j=this.actions[i];if(j.current||j.last){this.owner.trigger(i,{pressed:j.current,released:!j.current&&j.last,triggered:j.current&&!j.last,over:j.over})}j.update()}}};e.mousedown=function(i){this.owner.trigger("mouse:"+h[i.event.button||0]+":down",i.event)};e.mouseup=function(i){this.owner.trigger("mouse:"+h[i.event.button||0]+":up",i.event)};e.mousemove=function(i){this.owner.trigger("mouse:move",i)};e.destroy=function(){this.removeListeners(this.listeners)};e.addListeners=function(j){for(var i in j){this.addListener(j[i])}};e.removeListeners=function(j){for(var i in j){this.removeListener(i,j[i])}};e.addListener=function(j,l){var i=this,k=l||function(m){i[j](m)};this.owner.bind(j,k);this.listeners[j]=k};e.removeListener=function(i,j){this.owner.unbind(i,j)};return b})();a.components["render-debug"]=(function(){var b=function(d,e){this.owner=d;if(e.acceptInput){this.hover=e.acceptInput.hover||false;this.click=e.acceptInput.click||false;this.touch=e.acceptInput.touch||false}else{this.hover=false;this.click=false;this.touch=false}this.regX=e.regX||0;this.regY=e.regY||0;this.listeners=[];this.addListeners(["layer:render","layer:render-load"])};var c=b.prototype;c["layer:render"]=function(d){this.shape.x=this.owner.x-this.regX;this.shape.y=this.owner.y-this.regY;this.txt.x=this.owner.x-this.regX+(this.owner.width/2);this.txt.y=this.owner.y-this.regY+(this.owner.height/2)};c["layer:render-load"]=function(f){var n=this,l=this.owner.x=this.owner.x||0,k=this.owner.y=this.owner.y||0,d=this.owner.width=this.owner.width||300,m=this.owner.height=this.owner.height||100,e=a.settings.entities[this.owner.type]?(a.settings.entities[this.owner.type].components||[]):[],h=[],j=false;for(var g in e){h[g]=e[g].type}this.stage=f.stage;this.txt=new createjs.Text(this.owner.type+"\n("+h.join(", ")+")");this.txt.x=l+d/2;this.txt.y=k+m/2;this.txt.textAlign="center";this.txt.textBaseline="middle";this.shape=new createjs.Shape((new createjs.Graphics()).beginFill("rgba(0,0,0,0.1)").beginStroke("#880").rect(0,0,d,m));this.stage.addChild(this.shape);this.stage.addChild(this.txt);if(this.touch&&createjs.Touch.isSupported()){createjs.Touch.enable(this.stage)}this.shape.onPress=function(i){if(this.click||this.touch){n.owner.trigger("mousedown",{event:i.nativeEvent,over:j,x:i.stageX,y:i.stageY,entity:n.owner});i.onMouseUp=function(o){n.owner.trigger("mouseup",{event:o.nativeEvent,over:j,x:o.stageX,y:o.stageY,entity:n.owner})};i.onMouseMove=function(o){n.owner.trigger("mousemove",{event:o.nativeEvent,over:j,x:o.stageX,y:o.stageY,entity:n.owner})}}if(i.nativeEvent.button==2){console.log("This Entity:",n.owner)}};if(this.click||this.touch){this.shape.onMouseOut=function(){j=false};this.shape.onMouseOver=function(){j=true}}if(this.hover){this.stage.enableMouseOver();this.shape.onMouseOut=function(i){j=false;n.owner.trigger("mouseout",{event:i.nativeEvent,over:j,x:i.stageX,y:i.stageY,entity:n.owner})};this.shape.onMouseOver=function(i){j=true;n.owner.trigger("mouseover",{event:i.nativeEvent,over:j,x:i.stageX,y:i.stageY,entity:n.owner})}}};c.destroy=function(){this.removeListeners(this.listeners)};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["render-tile"]=(function(){var b=function(d,e){this.owner=d;this.spriteSheet=new createjs.SpriteSheet(e.spritesheet);this.state=e.state||"tile";this.listeners=[];this.addListeners(["layer:render","layer:render-load"])};var c=b.prototype;c["layer:render"]=function(d){this.shape.x=this.owner.x;this.shape.y=this.owner.y};c["layer:render-load"]=function(d){this.stage=d.stage;this.shape=new createjs.BitmapAnimation(this.spriteSheet);this.stage.addChild(this.shape);this.shape.gotoAndPlay(this.state)};c.destroy=function(){this.removeListeners(this.listeners)};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["render-tiles"]=(function(){var b=function(d,e){this.owner=d;this.controllerEvents=undefined;this.spriteSheet=new createjs.SpriteSheet(e.spritesheet);this.imageMap=e.imageMap||[];this.tileWidth=e.tileWidth||this.owner.tileWidth||10;this.tileHeight=e.tileHeight||this.owner.tileHeight||10;this.scaleX=e.scaleX||this.owner.scaleX||1;this.scaleY=e.scaleY||this.owner.scaleY||1;this.state=e.state||"tile";this.listeners=[];this.addListeners(["layer:render","layer:render-load"])};var c=b.prototype;c["layer:render"]=function(d){};c["layer:render-load"]=function(f){var d=0,g=0,e=this.stage=f.stage;tile=undefined;for(d=0;d<this.imageMap.length;d++){for(g=0;g<this.imageMap[d].length;g++){tile=new createjs.BitmapAnimation(this.spriteSheet);tile.scaleX=this.scaleX;tile.scaleY=this.scaleY;tile.x=d*this.tileWidth;tile.y=g*this.tileHeight;e.addChild(tile);tile.gotoAndPlay(this.imageMap[d][g])}}};c.destroy=function(){this.removeListeners(this.listeners)};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["render-button"]=(function(){var b=function(d,e){this.owner=d;this.listeners=[];this.addListeners(["layer:render-load","layer:render","controller:input"]);this.stage=undefined;this.upBitmap=new createjs.Bitmap(a.assets[e.upImg]);this.downBitmap=new createjs.Bitmap(a.assets[e.downImg])};var c=b.prototype;c["controller:input-handler"]=function(d){};c["layer:render-load"]=function(d){this.stage=d.stage;this.stage.addChild(this.upBitmap);this.stage.addChild(this.downBitmap);this.upBitmap.x=this.owner.x;this.downBitmap.x=this.owner.x;this.upBitmap.y=this.owner.y;this.downBitmap.y=this.owner.y};c["layer:render"]=function(){this.upBitmap.x=this.owner.x;this.downBitmap.x=this.owner.x;if(this.owner.state){this.downBitmap.alpha=0}else{this.downBitmap.alpha=1}};c.destroy=function(){this.removeListeners(this.listeners);this.stage.removeChild(this.shape)};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["render-animation"]=(function(){var b=function(e,g){var f={images:g.spriteSheet.images.slice(),frames:g.spriteSheet.frames,animations:g.spriteSheet.animations};this.owner=e;if(g.acceptInput){this.hover=g.acceptInput.hover||false;this.click=g.acceptInput.click||false;this.touch=g.acceptInput.touch||false}else{this.hover=false;this.click=false;this.touch=false}this.listeners=[];this.addListeners(["layer:render-load","layer:render","logical-state"]);this.stage=undefined;for(var d=0;d<f.images.length;d++){f.images[d]=a.assets[f.images[d]]}f=new createjs.SpriteSheet(f);this.anim=new createjs.BitmapAnimation(f);this.currentAnimation=g.state||this.owner.state||"";this.anim.scaleX=this.scaleX||this.owner.scaleX||1;this.anim.scaleY=this.scaleY||this.owner.scaleY||1;if(this.currentAnimation){this.anim.gotoAndPlay(this.currentAnimation)}};var c=b.prototype;c["layer:render-load"]=function(f){var d=this,e=false;this.stage=f.stage;this.stage.addChild(this.anim);if(this.click||this.touch){if(this.touch&&createjs.Touch.isSupported()){createjs.Touch.enable(this.stage)}this.anim.onPress=function(g){d.owner.trigger("mousedown",{event:g.nativeEvent,over:e,x:g.stageX,y:g.stageY,entity:d.owner});g.onMouseUp=function(h){d.owner.trigger("mouseup",{event:h.nativeEvent,over:e,x:h.stageX,y:h.stageY,entity:d.owner})};g.onMouseMove=function(h){d.owner.trigger("mousemove",{event:h.nativeEvent,over:e,x:h.stageX,y:h.stageY,entity:d.owner})}};this.anim.onMouseOut=function(){e=false};this.anim.onMouseOver=function(){e=true}}if(this.hover){this.stage.enableMouseOver();this.anim.onMouseOut=function(g){e=false;d.owner.trigger("mouseout",{event:g.nativeEvent,over:e,x:g.stageX,y:g.stageY,entity:d.owner})};this.anim.onMouseOver=function(g){e=true;d.owner.trigger("mouseover",{event:g.nativeEvent,over:e,x:g.stageX,y:g.stageY,entity:d.owner})}}};c["layer:render"]=function(d){this.anim.x=this.owner.x;this.anim.y=this.owner.y};c["logical-state"]=function(d){if(this.currentAnimation!=d.state){this.currentAnimation=d.state;this.anim.gotoAndPlay(d.state)}};c.destroy=function(){this.removeListeners(this.listeners)};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["logic-directional-movement"]=(function(){var c=function(e){return function(f){if(f){if(f.pressed){this[e]=true}else{this[e]=false}}else{this[e]=true}}},b=function(e,f){this.owner=e;this.listeners=[];this.addListeners(["layer:logic","go-down","go-south","go-down-left","go-southwest","go-left","go-west","go-up-left","go-northwest","go-up","go-north","go-up-right","go-northeast","go-right","go-east","go-down-right","go-southeast","stop"]);this.owner.state="standing";this.owner.heading="right";this.speed=f.speed||0.3;this.left=false;this.right=false;this.up=false;this.down=false;this.upLeft=false;this.upRight=false;this.downLeft=false;this.downRight=false};var d=b.prototype;d["layer:logic"]=function(h){var g=0,f=0,e=this.upLeft||(this.up&&this.left),k=this.downLeft||(this.down&&this.left),i=this.downRight||(this.down&&this.right),j=this.upRight||(this.up&&this.right);if(e){g=-this.speed/1.414;f=-this.speed/1.414;this.owner.heading="up-left";this.owner.state="walking"}else{if(j){f=-this.speed/1.414;g=this.speed/1.414;this.owner.heading="up-right";this.owner.state="walking"}else{if(k){f=this.speed/1.414;g=-this.speed/1.414;this.owner.heading="down-left";this.owner.state="walking"}else{if(i){f=this.speed/1.414;g=this.speed/1.414;this.owner.heading="down-right";this.owner.state="walking"}else{if(this.left){g=-this.speed;this.owner.heading="left";this.owner.state="walking"}else{if(this.right){g=this.speed;this.owner.heading="right";this.owner.state="walking"}else{if(this.up){f=-this.speed;this.owner.heading="up";this.owner.state="walking"}else{if(this.down){f=this.speed;this.owner.heading="down";this.owner.state="walking"}else{this.owner.state="standing"}}}}}}}}this.owner.x+=(g*h);this.owner.y+=(f*h);this.owner.trigger("logical-state",{state:this.owner.state+"-"+this.owner.heading});this.owner.trigger(this.owner.state)};d["go-down"]=d["go-south"]=c("down");d["go-down-left"]=d["go-southwest"]=c("downLeft");d["go-left"]=d["go-west"]=c("left");d["go-up-left"]=d["go-northwest"]=c("upLeft");d["go-up"]=d["go-north"]=c("up");d["go-up-right"]=d["go-northeast"]=c("upRight");d["go-right"]=d["go-east"]=c("right");d["go-down-right"]=d["go-southeast"]=c("downRight");d.stop=function(e){if(!e||e.pressed){this.down=false;this.downLeft=false;this.left=false;this.upLeft=false;this.up=false;this.upRight=false;this.right=false;this.downRight=false}};d.destroy=function(){this.removeListeners(this.listeners)};d.addListeners=function(f){for(var e in f){this.addListener(f[e])}};d.removeListeners=function(f){for(var e in f){this.removeListener(e,f[e])}};d.addListener=function(f,h){var e=this,g=h||function(i){e[f](i)};this.owner.bind(f,g);this.listeners[f]=g};d.removeListener=function(e,f){this.owner.unbind(e,f)};return b})();a.components["collision-hero"]=(function(){var b=function(d,f){var e=this;this.owner=d;this.listeners=[];this.addListeners(["load","layer:prep-collision","layer:resolve-collision","layer:resolve-solid-collision","layer:relocate"]);this.owner.shape=new a.classes.collisionShape([this.owner.x,this.owner.y],f.shape.type,f.shape.points,f.shape.offset,f.shape.radius);this.owner.getAABB=function(){return e.getAABB()};this.owner.collisionType=f.collisionType||"solid";this.owner.collidesWith=f.collidesWith||[]};var c=b.prototype;c.load=function(d){};c["layer:prep-collision"]=function(){this.owner.shape.update(this.owner.x,this.owner.y)};c["layer:relocate"]=function(d){this.owner.x=d[0]-this.owner.shape.getXOffset();this.owner.y=d[1]-this.owner.shape.getYOffset();this.owner.shape.setXY(d[0],d[1])};c["layer:resolve-solid-collision"]=function(k){var h=k.terrain;var r=k.tileCollisions;var s=k.otherCollisions;var p=this.owner.shape.x;var n=this.owner.shape.y;var i=this.owner.shape.prevX;var g=this.owner.shape.prevY;var G=p-i;var F=n-g;var A=F/G;var E=n-p*A;var e=undefined;var d=undefined;for(var C=0;C<r.length;C++){var I=r[C];var t=I.shape.x;var o=I.shape.y;var w=undefined;var u=undefined;var j=undefined;var B=undefined;var f=this.owner.shape.aABB;var l=I.shape.aABB;var q=t-l.halfWidth-f.halfWidth;var v=t+l.halfWidth+f.halfWidth;var D=o-l.halfHeight-f.halfHeight;var z=o+l.halfHeight+f.halfHeight;if(A!==Infinity&&A!==-Infinity){if(i<=q){w=q}else{if(i>=v){w=v}}}if(g<=D){u=D}else{if(g>=z){u=z}}if(typeof w!=="undefined"){j=A*w+E}if(typeof u!=="undefined"){if(A===Infinity||A===-Infinity){B=p}else{B=(u-E)/A}}if(w&&j>=D&&j<=z){if(G>0){if(!h.isTile(I.gridX-1,I.gridY)){var H=w-p;if(typeof e==="undefined"||H<e){e=H}}}else{if(G<0){if(!h.isTile(I.gridX+1,I.gridY)){var H=w-p;if(typeof e==="undefined"||H>e){e=H}}}}}else{if(u&&B>=q&&B<=v){if(F>0){if(!h.isTile(I.gridX,I.gridY-1)){var H=u-n;if(typeof d==="undefined"||H<d){d=H}}}else{if(F<0){if(!h.isTile(I.gridX,I.gridY+1)){var H=u-n;if(typeof d==="undefined"||H>d){d=H}}}}}}}if(typeof e!=="undefined"){this.owner.x=p+e-this.owner.shape.getXOffset();this.owner.shape.x=p+e}if(typeof d!=="undefined"){this.owner.y=n+d-this.owner.shape.getYOffset();this.owner.shape.y=n+d}};c["layer:resolve-collision"]=function(e){var d=this.owner.shape.x;var j=this.owner.shape.y;var g=this.owner.shape.prevX;var f=this.owner.shape.prevY;var i=e.shape.x;var h=e.shape.y;switch(e.type){}};c.getAABB=function(){return this.owner.shape.getAABB()};c.destroy=function(){this.removeListeners(this.listeners)};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();a.components["collision-tiles"]=(function(){var b=function(d,f){var e=this;this.owner=d;this.collisionMap=f.collisionMap||[];this.tileWidth=f.tileWidth||this.owner.tileWidth||10;this.tileHeight=f.tileHeight||this.owner.tileHeight||10;this.tileHalfWidth=this.tileWidth/2;this.tileHalfHeight=this.tileHeight/2;this.listeners=[];this.addListeners(["layer:prep-collision"]);this.owner.collisionType=f.collisionType||"solid";this.owner.collidesWith=f.collidesWith||[];this.owner.getTiles=function(g){return e.getTiles(g)};this.owner.getAABB=function(){return e.getAABB()};this.owner.isTile=function(g,h){return e.isTile(g,h)}};var c=b.prototype;c["layer:prep-collision"]=function(){};c.getAABB=function(){return{left:0,top:0,right:this.tileWidth*this.collisionMap.length,bottom:this.tileHeight*this.collisionMap.length[0]}};c.isTile=function(d,e){if(d>=0&&d<this.collisionMap.length&&e>=0&&e<this.collisionMap[0].length&&this.collisionMap[d][e]!=-1){return true}else{return false}};c.getTiles=function(e){var j=Math.max(Math.floor(e.left/this.tileWidth),0),i=Math.max(Math.floor(e.top/this.tileHeight),0),h=Math.min(Math.ceil(e.right/this.tileWidth),this.collisionMap.length),g=Math.min(Math.ceil(e.bottom/this.tileHeight),this.collisionMap[0].length),d=0,k=0,f=[];for(d=j;d<h;d++){for(k=i;k<g;k++){if(this.collisionMap[d][k]!=-1){f.push({gridX:d,gridY:k,shape:new a.classes.collisionShape([d*this.tileWidth+this.tileHalfWidth,k*this.tileHeight+this.tileHalfHeight],"rectangle",[[-this.tileHalfWidth,-this.tileHalfHeight],[this.tileHalfWidth,this.tileHalfHeight]])})}}}return f};c.destroy=function(){this.removeListeners(this.listeners)};c.addListeners=function(e){for(var d in e){this.addListener(e[d])}};c.removeListeners=function(e){for(var d in e){this.removeListener(d,e[d])}};c.addListener=function(e,g){var d=this,f=g||function(h){d[e](h)};this.owner.bind(e,f);this.listeners[e]=f};c.removeListener=function(d,e){this.owner.unbind(d,e)};return b})();(function(){var f=navigator.userAgent.toLowerCase(),n=document.createElement("audio"),q={canvas:false,touch:TouchEvent in window,iPod:(f.search("ipod")>-1),iPhone:(f.search("iphone")>-1),iPad:(f.search("ipad")>-1),safari:(f.search("safari")>-1),ie:(f.search("msie")>-1),firefox:(f.search("firefox")>-1),android:(f.search("android")>-1),silk:(f.search("silk")>-1),iOS:false,mobile:false,desktop:false,ogg:true,m4a:true,mp3:true},p=a.settings.aspects,b={},m=0,l=0,h=0,d=false,g="";q.iOS=q.iPod||q.iPhone||q.iPad;q.mobile=q.iOS||q.android||q.silk;q.desktop=!q.mobile;if((n.canPlayType)&&!(!!n.canPlayType&&""!=n.canPlayType('audio/ogg; codecs="vorbis"'))){q.ogg=false;if(q.ie||!(!!n.canPlayType&&""!=n.canPlayType("audio/mp4"))){q.m4a=false}}var c=document.createElement("canvas");try{q.canvas=!!(c.getContext("2d"))}catch(o){q.canvas=!!(c.getContext)}delete c;a.settings.aspects=b;a.settings.aspects={};for(m in p){d=false;g="";for(l in p[m]){g+=" "+l;for(h in p[m][l]){if(f.search(p[m][l][h])>-1){a.settings.aspects[l]=true;d=true;break}}if(d){break}}if(!d){console.warn("This browser doesn't support any of the following: "+g)}}})();window.addEventListener("load",function(){var b=new createjs.PreloadJS();b.onProgress=function(e){console.log("Progress:",e)};b.onFileLoad=function(k){var h=0,f=0,l=k.data,e=k.result,g=undefined;console.log("Load:",k);if((k.type=="image")&&l){if(l.rows&&l.columns){g=new createjs.SpriteSheet({images:[e],frames:{width:e.width/l.columns,height:e.height/l.rows}});for(f=0;f<l.rows;f++){for(h=0;h<l.columns;h++){if(l.ids&&l.ids[h]&&l.ids[h][f]){a.assets[l.ids[h][f]]=createjs.SpriteSheetUtils.extractFrame(g,+f+(h*l.rows))}else{a.assets[k.id+"-"+h+"_"+f]=createjs.SpriteSheetUtils.extractFrame(g,+f+(h*l.rows))}}}return}}a.assets[k.id]=e};b.onError=function(e){console.log("Your stuff broke!")};b.onComplete=function(e){a.game=new a.classes.game(a.settings);createjs.Ticker.setFPS(a.settings.global.fps);createjs.Ticker.addListener(a.game)};for(var d in a.settings.assets){if(typeof a.settings.assets[d].src!=="string"){for(var c in a.settings.assets[d].src){if(a.settings.aspects[c]&&a.settings.assets[d].src[c]){a.settings.assets[d].src=a.settings.assets[d].src[c];break}}if(typeof a.settings.assets[d].src!=="string"){if(a.settings.assets[d].src["default"]){a.settings.assets[d].src=a.settings.assets[d].src["default"]}else{console.warn("Asset has no valid source for this browser.",a.settings.assets[d])}}}}b.installPlugin(createjs.SoundJS);b.loadManifest(a.settings.assets);a.assets=[]},false)})();